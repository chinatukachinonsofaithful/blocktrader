var ia=Object.defineProperty;var ra=(t,e,i)=>e in t?ia(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var $=(t,e,i)=>(ra(t,typeof e!="symbol"?e+"":e,i),i);import{l as Wt,a as na}from"./axios-84e606a5.js";import{M as sa}from"./bootstrap.esm-60e45f05.js";import"./_commonjsHelpers-725317a4.js";class aa{constructor(e,i,r){this.eventTarget=e,this.eventName=i,this.eventOptions=r,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const i=oa(e);for(const r of this.bindings){if(i.immediatePropagationStopped)break;r.handleEvent(i)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,i)=>{const r=e.index,n=i.index;return r<n?-1:r>n?1:0})}}function oa(t){if("immediatePropagationStopped"in t)return t;{const{stopImmediatePropagation:e}=t;return Object.assign(t,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}class la{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,i)=>e.concat(Array.from(i.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,i=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),i&&this.clearEventListenersForBinding(e)}handleError(e,i,r={}){this.application.handleError(e,`Error ${i}`,r)}clearEventListenersForBinding(e){const i=this.fetchEventListenerForBinding(e);i.hasBindings()||(i.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:i,eventName:r,eventOptions:n}=e,s=this.fetchEventListenerMapForEventTarget(i),a=this.cacheKey(r,n);s.delete(a),s.size==0&&this.eventListenerMaps.delete(i)}fetchEventListenerForBinding(e){const{eventTarget:i,eventName:r,eventOptions:n}=e;return this.fetchEventListener(i,r,n)}fetchEventListener(e,i,r){const n=this.fetchEventListenerMapForEventTarget(e),s=this.cacheKey(i,r);let a=n.get(s);return a||(a=this.createEventListener(e,i,r),n.set(s,a)),a}createEventListener(e,i,r){const n=new aa(e,i,r);return this.started&&n.connect(),n}fetchEventListenerMapForEventTarget(e){let i=this.eventListenerMaps.get(e);return i||(i=new Map,this.eventListenerMaps.set(e,i)),i}cacheKey(e,i){const r=[e];return Object.keys(i).sort().forEach(n=>{r.push(`${i[n]?"":"!"}${n}`)}),r.join(":")}}const ca={stop({event:t,value:e}){return e&&t.stopPropagation(),!0},prevent({event:t,value:e}){return e&&t.preventDefault(),!0},self({event:t,value:e,element:i}){return e?i===t.target:!0}},da=/^(?:(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function ua(t){const i=t.trim().match(da)||[];let r=i[1],n=i[2];return n&&!["keydown","keyup","keypress"].includes(r)&&(r+=`.${n}`,n=""),{eventTarget:ha(i[3]),eventName:r,eventOptions:i[6]?fa(i[6]):{},identifier:i[4],methodName:i[5],keyFilter:n}}function ha(t){if(t=="window")return window;if(t=="document")return document}function fa(t){return t.split(":").reduce((e,i)=>Object.assign(e,{[i.replace(/^!/,"")]:!/^!/.test(i)}),{})}function pa(t){if(t==window)return"window";if(t==document)return"document"}function $i(t){return t.replace(/(?:[_-])([a-z0-9])/g,(e,i)=>i.toUpperCase())}function gi(t){return $i(t.replace(/--/g,"-").replace(/__/g,"_"))}function Rt(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Ln(t){return t.replace(/([A-Z])/g,(e,i)=>`-${i.toLowerCase()}`)}function ga(t){return t.match(/[^\s]+/g)||[]}class ma{constructor(e,i,r,n){this.element=e,this.index=i,this.eventTarget=r.eventTarget||e,this.eventName=r.eventName||Ea(e)||Dt("missing event name"),this.eventOptions=r.eventOptions||{},this.identifier=r.identifier||Dt("missing identifier"),this.methodName=r.methodName||Dt("missing method name"),this.keyFilter=r.keyFilter||"",this.schema=n}static forToken(e,i){return new this(e.element,e.index,ua(e.content),i)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",i=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${i}->${this.identifier}#${this.methodName}`}isFilterTarget(e){if(!this.keyFilter)return!1;const i=this.keyFilter.split("+"),r=["meta","ctrl","alt","shift"],[n,s,a,o]=r.map(d=>i.includes(d));if(e.metaKey!==n||e.ctrlKey!==s||e.altKey!==a||e.shiftKey!==o)return!0;const l=i.filter(d=>!r.includes(d))[0];return l?(Object.prototype.hasOwnProperty.call(this.keyMappings,l)||Dt(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[l].toLowerCase()!==e.key.toLowerCase()):!1}get params(){const e={},i=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:r,value:n}of Array.from(this.element.attributes)){const s=r.match(i),a=s&&s[1];a&&(e[$i(a)]=Ta(n))}return e}get eventTargetName(){return pa(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}}const ur={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:t=>t.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function Ea(t){const e=t.tagName.toLowerCase();if(e in ur)return ur[e](t)}function Dt(t){throw new Error(t)}function Ta(t){try{return JSON.parse(t)}catch{return t}}class Ia{constructor(e,i){this.context=e,this.action=i}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){this.willBeInvokedByEvent(e)&&this.applyEventModifiers(e)&&this.invokeWithEvent(e)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:i}=this.action,{actionDescriptorFilters:r}=this.context.application;let n=!0;for(const[s,a]of Object.entries(this.eventOptions))if(s in r){const o=r[s];n=n&&o({name:s,value:a,event:e,element:i})}else continue;return n}invokeWithEvent(e){const{target:i,currentTarget:r}=e;try{const{params:n}=this.action,s=Object.assign(e,{params:n});this.method.call(this.controller,s),this.context.logDebugActivity(this.methodName,{event:e,target:i,currentTarget:r,action:this.methodName})}catch(n){const{identifier:s,controller:a,element:o,index:l}=this,d={identifier:s,controller:a,element:o,index:l,event:e};this.context.handleError(n,`invoking action "${this.action}"`,d)}}willBeInvokedByEvent(e){const i=e.target;return e instanceof KeyboardEvent&&this.action.isFilterTarget(e)?!1:this.element===i?!0:i instanceof Element&&this.element.contains(i)?this.scope.containsElement(i):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class Pn{constructor(e,i){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=i,this.elements=new Set,this.mutationObserver=new MutationObserver(r=>this.processMutations(r))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const i of Array.from(this.elements))e.has(i)||this.removeElement(i);for(const i of Array.from(e))this.addElement(i)}}processMutations(e){if(this.started)for(const i of e)this.processMutation(i)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,i){const r=e;this.elements.has(r)?this.delegate.elementAttributeChanged&&this.matchElement(r)?this.delegate.elementAttributeChanged(r,i):this.removeElement(r):this.matchElement(r)&&this.addElement(r)}processRemovedNodes(e){for(const i of Array.from(e)){const r=this.elementFromNode(i);r&&this.processTree(r,this.removeElement)}}processAddedNodes(e){for(const i of Array.from(e)){const r=this.elementFromNode(i);r&&this.elementIsActive(r)&&this.processTree(r,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,i){for(const r of this.matchElementsInTree(e))i.call(this,r)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class _a{constructor(e,i,r){this.attributeName=i,this.delegate=r,this.elementObserver=new Pn(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const i=this.matchElement(e)?[e]:[],r=Array.from(e.querySelectorAll(this.selector));return i.concat(r)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,i){this.delegate.elementAttributeValueChanged&&this.attributeName==i&&this.delegate.elementAttributeValueChanged(e,i)}}function ya(t,e,i){Nn(t,e).add(i)}function va(t,e,i){Nn(t,e).delete(i),Oa(t,e)}function Nn(t,e){let i=t.get(e);return i||(i=new Set,t.set(e,i)),i}function Oa(t,e){const i=t.get(e);i!=null&&i.size==0&&t.delete(e)}class $e{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((i,r)=>i.concat(Array.from(r)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((i,r)=>i+r.size,0)}add(e,i){ya(this.valuesByKey,e,i)}delete(e,i){va(this.valuesByKey,e,i)}has(e,i){const r=this.valuesByKey.get(e);return r!=null&&r.has(i)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(r=>r.has(e))}getValuesForKey(e){const i=this.valuesByKey.get(e);return i?Array.from(i):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([i,r])=>r.has(e)).map(([i,r])=>i)}}class Ra{constructor(e,i,r,n={}){this.selector=i,this.details=n,this.elementObserver=new Pn(e,this),this.delegate=r,this.matchesByElement=new $e}get started(){return this.elementObserver.started}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const i=e.matches(this.selector);return this.delegate.selectorMatchElement?i&&this.delegate.selectorMatchElement(e,this.details):i}matchElementsInTree(e){const i=this.matchElement(e)?[e]:[],r=Array.from(e.querySelectorAll(this.selector)).filter(n=>this.matchElement(n));return i.concat(r)}elementMatched(e){this.selectorMatched(e)}elementUnmatched(e){this.selectorUnmatched(e)}elementAttributeChanged(e,i){const r=this.matchElement(e),n=this.matchesByElement.has(this.selector,e);!r&&n&&this.selectorUnmatched(e)}selectorMatched(e){this.delegate.selectorMatched&&(this.delegate.selectorMatched(e,this.selector,this.details),this.matchesByElement.add(this.selector,e))}selectorUnmatched(e){this.delegate.selectorUnmatched(e,this.selector,this.details),this.matchesByElement.delete(this.selector,e)}}class ba{constructor(e,i){this.element=e,this.delegate=i,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(r=>this.processMutations(r))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const i of e)this.processMutation(i)}processMutation(e){const i=e.attributeName;i&&this.refreshAttribute(i,e.oldValue)}refreshAttribute(e,i){const r=this.delegate.getStringMapKeyForAttribute(e);if(r!=null){this.stringMap.has(e)||this.stringMapKeyAdded(r,e);const n=this.element.getAttribute(e);if(this.stringMap.get(e)!=n&&this.stringMapValueChanged(n,r,i),n==null){const s=this.stringMap.get(e);this.stringMap.delete(e),s&&this.stringMapKeyRemoved(r,e,s)}else this.stringMap.set(e,n)}}stringMapKeyAdded(e,i){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,i)}stringMapValueChanged(e,i,r){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,i,r)}stringMapKeyRemoved(e,i,r){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,i,r)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class xn{constructor(e,i,r){this.attributeObserver=new _a(e,i,this),this.delegate=r,this.tokensByElement=new $e}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[i,r]=this.refreshTokensForElement(e);this.tokensUnmatched(i),this.tokensMatched(r)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(i=>this.tokenMatched(i))}tokensUnmatched(e){e.forEach(i=>this.tokenUnmatched(i))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const i=this.tokensByElement.getValuesForKey(e),r=this.readTokensForElement(e),n=Aa(i,r).findIndex(([s,a])=>!Da(s,a));return n==-1?[[],[]]:[i.slice(n),r.slice(n)]}readTokensForElement(e){const i=this.attributeName,r=e.getAttribute(i)||"";return wa(r,e,i)}}function wa(t,e,i){return t.trim().split(/\s+/).filter(r=>r.length).map((r,n)=>({element:e,attributeName:i,content:r,index:n}))}function Aa(t,e){const i=Math.max(t.length,e.length);return Array.from({length:i},(r,n)=>[t[n],e[n]])}function Da(t,e){return t&&e&&t.index==e.index&&t.content==e.content}class Fn{constructor(e,i,r){this.tokenListObserver=new xn(e,i,this),this.delegate=r,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:i}=e,{value:r}=this.fetchParseResultForToken(e);r&&(this.fetchValuesByTokenForElement(i).set(e,r),this.delegate.elementMatchedValue(i,r))}tokenUnmatched(e){const{element:i}=e,{value:r}=this.fetchParseResultForToken(e);r&&(this.fetchValuesByTokenForElement(i).delete(e),this.delegate.elementUnmatchedValue(i,r))}fetchParseResultForToken(e){let i=this.parseResultsByToken.get(e);return i||(i=this.parseToken(e),this.parseResultsByToken.set(e,i)),i}fetchValuesByTokenForElement(e){let i=this.valuesByTokenByElement.get(e);return i||(i=new Map,this.valuesByTokenByElement.set(e,i)),i}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(i){return{error:i}}}}class Sa{constructor(e,i){this.context=e,this.delegate=i,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new Fn(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const i=new Ia(this.context,e);this.bindingsByAction.set(e,i),this.delegate.bindingConnected(i)}disconnectAction(e){const i=this.bindingsByAction.get(e);i&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(i))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){const i=ma.forToken(e,this.schema);if(i.identifier==this.identifier)return i}elementMatchedValue(e,i){this.connectAction(i)}elementUnmatchedValue(e,i){this.disconnectAction(i)}}class Ma{constructor(e,i){this.context=e,this.receiver=i,this.stringMapObserver=new ba(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,i){const r=this.valueDescriptorMap[i];this.hasValue(e)||this.invokeChangedCallback(e,r.writer(this.receiver[e]),r.writer(r.defaultValue))}stringMapValueChanged(e,i,r){const n=this.valueDescriptorNameMap[i];e!==null&&(r===null&&(r=n.writer(n.defaultValue)),this.invokeChangedCallback(i,e,r))}stringMapKeyRemoved(e,i,r){const n=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,n.writer(this.receiver[e]),r):this.invokeChangedCallback(e,n.writer(n.defaultValue),r)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:i,defaultValue:r,writer:n}of this.valueDescriptors)r!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(i,n(r),void 0)}invokeChangedCallback(e,i,r){const n=`${e}Changed`,s=this.receiver[n];if(typeof s=="function"){const a=this.valueDescriptorNameMap[e];try{const o=a.reader(i);let l=r;r&&(l=a.reader(r)),s.call(this.receiver,o,l)}catch(o){throw o instanceof TypeError&&(o.message=`Stimulus Value "${this.context.identifier}.${a.name}" - ${o.message}`),o}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map(i=>e[i])}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach(i=>{const r=this.valueDescriptorMap[i];e[r.name]=r}),e}hasValue(e){const i=this.valueDescriptorNameMap[e],r=`has${Rt(i.name)}`;return this.receiver[r]}}class Ca{constructor(e,i){this.context=e,this.delegate=i,this.targetsByName=new $e}start(){this.tokenListObserver||(this.tokenListObserver=new xn(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:i}){this.scope.containsElement(e)&&this.connectTarget(e,i)}tokenUnmatched({element:e,content:i}){this.disconnectTarget(e,i)}connectTarget(e,i){var r;this.targetsByName.has(i,e)||(this.targetsByName.add(i,e),(r=this.tokenListObserver)===null||r===void 0||r.pause(()=>this.delegate.targetConnected(e,i)))}disconnectTarget(e,i){var r;this.targetsByName.has(i,e)&&(this.targetsByName.delete(i,e),(r=this.tokenListObserver)===null||r===void 0||r.pause(()=>this.delegate.targetDisconnected(e,i)))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const i of this.targetsByName.getValuesForKey(e))this.disconnectTarget(i,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function bt(t,e){const i=Bn(t);return Array.from(i.reduce((r,n)=>(Pa(n,e).forEach(s=>r.add(s)),r),new Set))}function La(t,e){return Bn(t).reduce((r,n)=>(r.push(...Na(n,e)),r),[])}function Bn(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}function Pa(t,e){const i=t[e];return Array.isArray(i)?i:[]}function Na(t,e){const i=t[e];return i?Object.keys(i).map(r=>[r,i[r]]):[]}class xa{constructor(e,i){this.context=e,this.delegate=i,this.outletsByName=new $e,this.outletElementsByName=new $e,this.selectorObserverMap=new Map}start(){this.selectorObserverMap.size===0&&(this.outletDefinitions.forEach(e=>{const i=this.selector(e),r={outletName:e};i&&this.selectorObserverMap.set(e,new Ra(document.body,i,this,r))}),this.selectorObserverMap.forEach(e=>e.start())),this.dependentContexts.forEach(e=>e.refresh())}stop(){this.selectorObserverMap.size>0&&(this.disconnectAllOutlets(),this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}refresh(){this.selectorObserverMap.forEach(e=>e.refresh())}selectorMatched(e,i,{outletName:r}){const n=this.getOutlet(e,r);n&&this.connectOutlet(n,e,r)}selectorUnmatched(e,i,{outletName:r}){const n=this.getOutletFromMap(e,r);n&&this.disconnectOutlet(n,e,r)}selectorMatchElement(e,{outletName:i}){return this.hasOutlet(e,i)&&e.matches(`[${this.context.application.schema.controllerAttribute}~=${i}]`)}connectOutlet(e,i,r){var n;this.outletElementsByName.has(r,i)||(this.outletsByName.add(r,e),this.outletElementsByName.add(r,i),(n=this.selectorObserverMap.get(r))===null||n===void 0||n.pause(()=>this.delegate.outletConnected(e,i,r)))}disconnectOutlet(e,i,r){var n;this.outletElementsByName.has(r,i)&&(this.outletsByName.delete(r,e),this.outletElementsByName.delete(r,i),(n=this.selectorObserverMap.get(r))===null||n===void 0||n.pause(()=>this.delegate.outletDisconnected(e,i,r)))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const i of this.outletElementsByName.getValuesForKey(e))for(const r of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(r,i,e)}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}get outletDependencies(){const e=new $e;return this.router.modules.forEach(i=>{const r=i.definition.controllerConstructor;bt(r,"outlets").forEach(s=>e.add(s,i.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter(i=>e.includes(i.identifier))}hasOutlet(e,i){return!!this.getOutlet(e,i)||!!this.getOutletFromMap(e,i)}getOutlet(e,i){return this.application.getControllerForElementAndIdentifier(e,i)}getOutletFromMap(e,i){return this.outletsByName.getValuesForKey(i).find(r=>r.element===e)}get scope(){return this.context.scope}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class Fa{constructor(e,i){this.logDebugActivity=(r,n={})=>{const{identifier:s,controller:a,element:o}=this;n=Object.assign({identifier:s,controller:a,element:o},n),this.application.logDebugActivity(this.identifier,r,n)},this.module=e,this.scope=i,this.controller=new e.controllerConstructor(this),this.bindingObserver=new Sa(this,this.dispatcher),this.valueObserver=new Ma(this,this.controller),this.targetObserver=new Ca(this,this),this.outletObserver=new xa(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(r){this.handleError(r,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,i,r={}){const{identifier:n,controller:s,element:a}=this;r=Object.assign({identifier:n,controller:s,element:a},r),this.application.handleError(e,`Error ${i}`,r)}targetConnected(e,i){this.invokeControllerMethod(`${i}TargetConnected`,e)}targetDisconnected(e,i){this.invokeControllerMethod(`${i}TargetDisconnected`,e)}outletConnected(e,i,r){this.invokeControllerMethod(`${gi(r)}OutletConnected`,e,i)}outletDisconnected(e,i,r){this.invokeControllerMethod(`${gi(r)}OutletDisconnected`,e,i)}invokeControllerMethod(e,...i){const r=this.controller;typeof r[e]=="function"&&r[e](...i)}}function Ba(t){return Ga(t,Va(t))}function Ga(t,e){const i=Ha(t),r=Ua(t.prototype,e);return Object.defineProperties(i.prototype,r),i}function Va(t){return bt(t,"blessings").reduce((i,r)=>{const n=r(t);for(const s in n){const a=i[s]||{};i[s]=Object.assign(a,n[s])}return i},{})}function Ua(t,e){return $a(e).reduce((i,r)=>{const n=ka(t,e,r);return n&&Object.assign(i,{[r]:n}),i},{})}function ka(t,e,i){const r=Object.getOwnPropertyDescriptor(t,i);if(!(r&&"value"in r)){const s=Object.getOwnPropertyDescriptor(e,i).value;return r&&(s.get=r.get||s.get,s.set=r.set||s.set),s}}const $a=(()=>typeof Object.getOwnPropertySymbols=="function"?t=>[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)]:Object.getOwnPropertyNames)(),Ha=(()=>{function t(i){function r(){return Reflect.construct(i,arguments,new.target)}return r.prototype=Object.create(i.prototype,{constructor:{value:r}}),Reflect.setPrototypeOf(r,i),r}function e(){const r=t(function(){this.a.call(this)});return r.prototype.a=function(){},new r}try{return e(),t}catch{return r=>class extends r{}}})();function Wa(t){return{identifier:t.identifier,controllerConstructor:Ba(t.controllerConstructor)}}class Ya{constructor(e,i){this.application=e,this.definition=Wa(i),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const i=this.fetchContextForScope(e);this.connectedContexts.add(i),i.connect()}disconnectContextForScope(e){const i=this.contextsByScope.get(e);i&&(this.connectedContexts.delete(i),i.disconnect())}fetchContextForScope(e){let i=this.contextsByScope.get(e);return i||(i=new Fa(this,e),this.contextsByScope.set(e,i)),i}}class za{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){const i=this.data.get(this.getDataKey(e))||"";return ga(i)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class qa{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const i=this.getAttributeNameForKey(e);return this.element.getAttribute(i)}set(e,i){const r=this.getAttributeNameForKey(e);return this.element.setAttribute(r,i),this.get(e)}has(e){const i=this.getAttributeNameForKey(e);return this.element.hasAttribute(i)}delete(e){if(this.has(e)){const i=this.getAttributeNameForKey(e);return this.element.removeAttribute(i),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${Ln(e)}`}}class Xa{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,i,r){let n=this.warnedKeysByObject.get(e);n||(n=new Set,this.warnedKeysByObject.set(e,n)),n.has(i)||(n.add(i),this.logger.warn(r,e))}}function mi(t,e){return`[${t}~="${e}"]`}class ja{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((i,r)=>i||this.findTarget(r)||this.findLegacyTarget(r),void 0)}findAll(...e){return e.reduce((i,r)=>[...i,...this.findAllTargets(r),...this.findAllLegacyTargets(r)],[])}findTarget(e){const i=this.getSelectorForTargetName(e);return this.scope.findElement(i)}findAllTargets(e){const i=this.getSelectorForTargetName(e);return this.scope.findAllElements(i)}getSelectorForTargetName(e){const i=this.schema.targetAttributeForScope(this.identifier);return mi(i,e)}findLegacyTarget(e){const i=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(i),e)}findAllLegacyTargets(e){const i=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(i).map(r=>this.deprecate(r,e))}getLegacySelectorForTargetName(e){const i=`${this.identifier}.${e}`;return mi(this.schema.targetAttribute,i)}deprecate(e,i){if(e){const{identifier:r}=this,n=this.schema.targetAttribute,s=this.schema.targetAttributeForScope(r);this.guide.warn(e,`target:${i}`,`Please replace ${n}="${r}.${i}" with ${s}="${i}". The ${n} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class Ka{constructor(e,i){this.scope=e,this.controllerElement=i}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((i,r)=>i||this.findOutlet(r),void 0)}findAll(...e){return e.reduce((i,r)=>[...i,...this.findAllOutlets(r)],[])}getSelectorForOutletName(e){const i=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(i)}findOutlet(e){const i=this.getSelectorForOutletName(e);if(i)return this.findElement(i,e)}findAllOutlets(e){const i=this.getSelectorForOutletName(e);return i?this.findAllElements(i,e):[]}findElement(e,i){return this.scope.queryElements(e).filter(n=>this.matchesElement(n,e,i))[0]}findAllElements(e,i){return this.scope.queryElements(e).filter(n=>this.matchesElement(n,e,i))}matchesElement(e,i,r){const n=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(i)&&n.split(" ").includes(r)}}class Hi{constructor(e,i,r,n){this.targets=new ja(this),this.classes=new za(this),this.data=new qa(this),this.containsElement=s=>s.closest(this.controllerSelector)===this.element,this.schema=e,this.element=i,this.identifier=r,this.guide=new Xa(n),this.outlets=new Ka(this.documentScope,i)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return mi(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new Hi(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class Za{constructor(e,i,r){this.element=e,this.schema=i,this.delegate=r,this.valueListObserver=new Fn(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:i,content:r}=e,n=this.fetchScopesByIdentifierForElement(i);let s=n.get(r);return s||(s=this.delegate.createScopeForElementAndIdentifier(i,r),n.set(r,s)),s}elementMatchedValue(e,i){const r=(this.scopeReferenceCounts.get(i)||0)+1;this.scopeReferenceCounts.set(i,r),r==1&&this.delegate.scopeConnected(i)}elementUnmatchedValue(e,i){const r=this.scopeReferenceCounts.get(i);r&&(this.scopeReferenceCounts.set(i,r-1),r==1&&this.delegate.scopeDisconnected(i))}fetchScopesByIdentifierForElement(e){let i=this.scopesByIdentifierByElement.get(e);return i||(i=new Map,this.scopesByIdentifierByElement.set(e,i)),i}}class Qa{constructor(e){this.application=e,this.scopeObserver=new Za(this.element,this.schema,this),this.scopesByIdentifier=new $e,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,i)=>e.concat(i.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const i=new Ya(this.application,e);this.connectModule(i);const r=e.controllerConstructor.afterLoad;r&&r(e.identifier,this.application)}unloadIdentifier(e){const i=this.modulesByIdentifier.get(e);i&&this.disconnectModule(i)}getContextForElementAndIdentifier(e,i){const r=this.modulesByIdentifier.get(i);if(r)return r.contexts.find(n=>n.element==e)}handleError(e,i,r){this.application.handleError(e,i,r)}createScopeForElementAndIdentifier(e,i){return new Hi(this.schema,e,i,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const i=this.modulesByIdentifier.get(e.identifier);i&&i.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const i=this.modulesByIdentifier.get(e.identifier);i&&i.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(r=>e.connectContextForScope(r))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(r=>e.disconnectContextForScope(r))}}const Ja={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:t=>`data-${t}-target`,outletAttributeForScope:(t,e)=>`data-${t}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End"},hr("abcdefghijklmnopqrstuvwxyz".split("").map(t=>[t,t]))),hr("0123456789".split("").map(t=>[t,t])))};function hr(t){return t.reduce((e,[i,r])=>Object.assign(Object.assign({},e),{[i]:r}),{})}class eo{constructor(e=document.documentElement,i=Ja){this.logger=console,this.debug=!1,this.logDebugActivity=(r,n,s={})=>{this.debug&&this.logFormattedMessage(r,n,s)},this.element=e,this.schema=i,this.dispatcher=new la(this),this.router=new Qa(this),this.actionDescriptorFilters=Object.assign({},ca)}static start(e,i){const r=new this(e,i);return r.start(),r}async start(){await to(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,i){this.load({identifier:e,controllerConstructor:i})}registerActionOption(e,i){this.actionDescriptorFilters[e]=i}load(e,...i){(Array.isArray(e)?e:[e,...i]).forEach(n=>{n.controllerConstructor.shouldLoad&&this.router.loadDefinition(n)})}unload(e,...i){(Array.isArray(e)?e:[e,...i]).forEach(n=>this.router.unloadIdentifier(n))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,i){const r=this.router.getContextForElementAndIdentifier(e,i);return r?r.controller:null}handleError(e,i,r){var n;this.logger.error(`%s

%o

%o`,i,e,r),(n=window.onerror)===null||n===void 0||n.call(window,i,"",0,0,e)}logFormattedMessage(e,i,r={}){r=Object.assign({application:this},r),this.logger.groupCollapsed(`${e} #${i}`),this.logger.log("details:",Object.assign({},r)),this.logger.groupEnd()}}function to(){return new Promise(t=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>t()):t()})}function io(t){return bt(t,"classes").reduce((i,r)=>Object.assign(i,ro(r)),{})}function ro(t){return{[`${t}Class`]:{get(){const{classes:e}=this;if(e.has(t))return e.get(t);{const i=e.getAttributeName(t);throw new Error(`Missing attribute "${i}"`)}}},[`${t}Classes`]:{get(){return this.classes.getAll(t)}},[`has${Rt(t)}Class`]:{get(){return this.classes.has(t)}}}}function no(t){return bt(t,"outlets").reduce((i,r)=>Object.assign(i,so(r)),{})}function so(t){const e=gi(t);return{[`${e}Outlet`]:{get(){const i=this.outlets.find(t);if(i){const r=this.application.getControllerForElementAndIdentifier(i,t);if(r)return r;throw new Error(`Missing "data-controller=${t}" attribute on outlet element for "${this.identifier}" controller`)}throw new Error(`Missing outlet element "${t}" for "${this.identifier}" controller`)}},[`${e}Outlets`]:{get(){const i=this.outlets.findAll(t);return i.length>0?i.map(r=>{const n=this.application.getControllerForElementAndIdentifier(r,t);if(n)return n;console.warn(`The provided outlet element is missing the outlet controller "${t}" for "${this.identifier}"`,r)}).filter(r=>r):[]}},[`${e}OutletElement`]:{get(){const i=this.outlets.find(t);if(i)return i;throw new Error(`Missing outlet element "${t}" for "${this.identifier}" controller`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(t)}},[`has${Rt(e)}Outlet`]:{get(){return this.outlets.has(t)}}}}function ao(t){return bt(t,"targets").reduce((i,r)=>Object.assign(i,oo(r)),{})}function oo(t){return{[`${t}Target`]:{get(){const e=this.targets.find(t);if(e)return e;throw new Error(`Missing target element "${t}" for "${this.identifier}" controller`)}},[`${t}Targets`]:{get(){return this.targets.findAll(t)}},[`has${Rt(t)}Target`]:{get(){return this.targets.has(t)}}}}function lo(t){const e=La(t,"values"),i={valueDescriptorMap:{get(){return e.reduce((r,n)=>{const s=Gn(n,this.identifier),a=this.data.getAttributeNameForKey(s.key);return Object.assign(r,{[a]:s})},{})}}};return e.reduce((r,n)=>Object.assign(r,co(n)),i)}function co(t,e){const i=Gn(t,e),{key:r,name:n,reader:s,writer:a}=i;return{[n]:{get(){const o=this.data.get(r);return o!==null?s(o):i.defaultValue},set(o){o===void 0?this.data.delete(r):this.data.set(r,a(o))}},[`has${Rt(n)}`]:{get(){return this.data.has(r)||i.hasCustomDefaultValue}}}}function Gn([t,e],i){return po({controller:i,token:t,typeDefinition:e})}function Wi(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function _t(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(t))return"array";if(Object.prototype.toString.call(t)==="[object Object]")return"object"}function uo(t){const e=Wi(t.typeObject.type);if(!e)return;const i=_t(t.typeObject.default);if(e!==i){const r=t.controller?`${t.controller}.${t.token}`:t.token;throw new Error(`The specified default value for the Stimulus Value "${r}" must match the defined type "${e}". The provided default value of "${t.typeObject.default}" is of type "${i}".`)}return e}function ho(t){const e=uo({controller:t.controller,token:t.token,typeObject:t.typeDefinition}),i=_t(t.typeDefinition),r=Wi(t.typeDefinition),n=e||i||r;if(n)return n;const s=t.controller?`${t.controller}.${t.typeDefinition}`:t.token;throw new Error(`Unknown value type "${s}" for "${t.token}" value`)}function fo(t){const e=Wi(t);if(e)return go[e];const i=t.default;return i!==void 0?i:t}function po(t){const e=`${Ln(t.token)}-value`,i=ho(t);return{type:i,key:e,name:$i(e),get defaultValue(){return fo(t.typeDefinition)},get hasCustomDefaultValue(){return _t(t.typeDefinition)!==void 0},reader:mo[i],writer:fr[i]||fr.default}}const go={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},mo={array(t){const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${t}" of type "${_t(e)}"`);return e},boolean(t){return!(t=="0"||String(t).toLowerCase()=="false")},number(t){return Number(t)},object(t){const e=JSON.parse(t);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${t}" of type "${_t(e)}"`);return e},string(t){return t}},fr={default:Eo,array:pr,object:pr};function pr(t){return JSON.stringify(t)}function Eo(t){return`${t}`}class ce{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,i){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:i=this.element,detail:r={},prefix:n=this.identifier,bubbles:s=!0,cancelable:a=!0}={}){const o=n?`${n}:${e}`:e,l=new CustomEvent(o,{detail:r,bubbles:s,cancelable:a});return i.dispatchEvent(l),l}}ce.blessings=[io,ao,lo,no];ce.targets=[];ce.outlets=[];ce.values={};const Te=eo.start();Te.debug=!1;window.Stimulus=Te;function To(t){return t.split("-").filter(r=>r!=="").map((r,n)=>n===0?r:r.charAt(0).toUpperCase()+r.slice(1)).join("-")}function Vn(t,e,i,r){t.forEach(n=>{const s=To(r);n.dataset[`${s}Model`].split(" ").forEach(o=>{const[l,d]=o.split(":");let c=Io(e,l);if(c!==void 0&&(l.includes(i)||i===void 0)){if(typeof c=="function"){c(n);return}(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement||n instanceof HTMLSelectElement)&&d===void 0?n.value=c:d===void 0?n.innerHTML=c:n.setAttribute(d,c)}})})}function Io(t,e){const i=Array.isArray(e)?e:e.split(".");let r=t;for(const n of i)if(r&&typeof r=="object"&&n in r)r=r[n];else return;return r}function Un(t={state:{}},e="",i=!1){let r=new WeakMap,n={get(s,a,o){let l=Reflect.get(s,a,o);if(l&&typeof l=="object"){if(r.has(l))return r.get(l);const d=new Proxy(l,n);return r.set(l,d),d}return i&&console.log(`Getting property ${a}: `,l),l},set(s,a,o,l){return Reflect.set(s,a,o,l),i&&console.log(`Setting timeout property ${a}: `,o),Vn(document.querySelectorAll(`[data-${e}-model*="${a}"]`),t,a,e),!0},ownKeys(s){const a=Reflect.ownKeys(s),o=_o(s);return[...a,...o]},getOwnPropertyDescriptor(s,a){const o=Reflect.getOwnPropertyDescriptor(s,a);if(o)return o;const l=yo(s,a);if(l)return{value:l,writable:!1,enumerable:!0,configurable:!0}}};return vo(t,e),new Proxy(t,n)}function _o(t){return Object.keys(t).filter(e=>typeof t[e]=="function")}function yo(t,e){if(typeof t[e]=="function")return t[e]()}function vo(t,e){Object.keys(t.state).forEach(i=>{Vn(document.querySelectorAll(`[data-${e}-model*="${i}"]`),t,i,e)})}function Yi(t){return t==null||t===""?!0:Array.isArray(t)&&t.length===0}function Oo(t){return!Yi(t)}function Ei(t,e,i,r){let n=Array.isArray(t)?[...t]:{...t},s=[...Array.isArray(e)?e:e.split(".")],a=s.shift();if(a==="*"){if(s.length>0)for(let o in n)n[o]=Ei(n[o],s,i,r);else if(r)for(let o in n)n[o]=i}else s.length>0?n[a]=Ei(n[a],s,i,r):(r||n[a]===null||typeof n[a]>"u")&&(n[a]=i);return n}function zi(t,e=""){let i={};for(let r in t)t[r]!==null&&typeof t[r]=="object"?i={...i,...zi(t[r],e+r+".")}:i[e+r]=t[r];return i}function me(t,e,i=null){if(e[t])return e[t];for(let r in e)if(r.includes("*")&&new RegExp(r.replaceAll("*","[^.]*")+"$").test(t))return e[r];return i||t}function Ro(t){return t.replace(/_/g," ")}class bo{constructor(e,i,r={}){$(this,"_errors");this.messages=r,this.data=So(e,i),this.rules=Ao(this.data,i)}passes(){this._errors={};for(let e in this.rules)for(let i in this.rules[e]){let r=this.rules[e][i]({value:this.data[e],data:this.data,attribute:e,messages:this.messages});if(!r.passes()){let n=this.overwrittenMessage(e,i);this._errors[e]=Mo(Ro(r.message(n)));break}}return Object.keys(this._errors).length===0}fails(){return!this.passes()}overwrittenMessage(e,i){let r=this.messages[`${Co(e)}.${this.rules[e][i].name}`];return r||(r=this.messages[this.rules[e][i].name]),r}errors(){return typeof this._errors>"u"&&this.passes(),this._errors}}class wo{constructor(e={}){this.messages=e}validate(e,i,r={}){return new bo(e,i,zi({...this.messages,...r}))}}function kn(t){return t/1024**2}function Ao(t,e){e={...e};for(let i in e)i.includes("*")&&(e={...e,...Do(t,i,e[i])},delete e[i]);return e}function Do(t,e,i){let r={},n=new RegExp(e.replaceAll("*","[^.]*")+"$");for(let s in t)n.test(s)&&i.forEach(a=>{r[s]=r[s]||[],r[s].push(a)});return r}function So(t,e){let i={};for(let r in e)i={...i,...xo(r,t)};return i}function Mo(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Co(t){return t.replaceAll(/\d+/g,"*")}function Lo(t,e){let i=e.split(".").reverse();for(;i.length&&(t=t[i.pop()])!==void 0&&t!==null;);return t}function Po(t,e,i){let r={...t},n=new RegExp(i.replaceAll("*","[^.]*")+"$");for(let s in e)n.test(s)&&(r[s]=Lo(t,s));return r}function No(t,e){return Ei({...e},t,null,!0)}function xo(t,e){let i=zi(No(t,e));return Po(e,i,t)}function Fo(t){return function({value:i,attribute:r,messages:n}){return{passes(){var s;return Yi(i)?!0:typeof i=="string"||Array.isArray(i)?i.length<=Number(t):((s=i.constructor)==null?void 0:s.name)==="File"?kn(i.size)<=Number(t):Number(i)<=Number(t)},message(){var o;let s=`${r}.isMax`,a=me(s,n,":attribute must be at most :max.");return typeof i=="string"&&(a=me(`${s}.string`,n,":attribute must be at most :max characters long.")),Array.isArray(i)&&(a=me(`${s}.array`,n,":attribute must have at most :max items.")),((o=i.constructor)==null?void 0:o.name)==="File"&&(a=me(`${s}.file`,n,":attribute must be at most :maxMB.")),a.replaceAll(":max",t).replaceAll(":value",i).replaceAll(":attribute",me(r,n))}}}}function $n(t){return function({value:i,attribute:r,messages:n}){return{passes(){var s;return Yi(i)?!0:typeof i=="string"||Array.isArray(i)?i.length>=Number(t):((s=i.constructor)==null?void 0:s.name)==="File"?kn(i.size)>=Number(t):Number(i)>=Number(t)},message(){var o;let s=`${r}.isMin`,a=me(s,n,":attribute must be at least :min.");return typeof i=="string"&&(a=me(`${s}.string`,n,":attribute must be at least :min characters long.")),Array.isArray(i)&&(a=me(`${s}.array`,n,":attribute must have at least :min items.")),((o=i.constructor)==null?void 0:o.name)==="File"&&(a=me(`${s}.file`,n,":attribute must be at least :minMB.")),a.replaceAll(":min",t).replaceAll(":value",i).replaceAll(":attribute",me(r,n))}}}}function Hn(){return function({value:e,attribute:i,messages:r}){return{passes(){return Oo(e)},message(n=":attribute is required."){return n.replaceAll(":value",me(e,r)).replaceAll(":attribute",me(i,r))}}}}const Wn=new wo;Wn.messages={};function Bo(t,e){let i=t;Array.isArray(e)&&e.length&&(i=Object.fromEntries(Object.entries(t).filter(([s])=>e.includes(s))));const r={},n={};for(let s in i)r[s]=i[s].input,n[s]=i[s].rules||[];return{fields:r,rules:n}}function Go(t,e){Object.keys(e).forEach(r=>{document.querySelectorAll(`.is-${r}-invalid`).forEach(s=>{r in t.errors()?s.textContent=t.errors()[r]:s.textContent=""})})}function st(t,e,i){const{fields:r,rules:n}=Bo(t,e),s=Wn.validate(r,n,i);return Go(s,r),{passes:s.passes(),errors:s.errors()}}class Ti extends ce{connect(){let e=this;this.deposit=Un({state:{amount:"",paymentOptionValue:this.paymentOptionTarget.value.toUpperCase(),paymentOptionName:this.paymentOptionTarget.textContent},get amountCurrencyRate(){return e.getCurrencyRate(this.state.paymentOptionValue)},get amountCurrencyTotalRate(){return Wt.round(this.state.amount*e.getCurrencyRate(this.state.paymentOptionValue),6)}},this.identifier)}updateOption({target:e}){this.deposit.state.paymentOptionValue=e.value.toUpperCase(),this.deposit.state.paymentOptionName=e.textContent,this.deposit.state.amount=this.deposit.state.amount}validateField({target:e}){this.deposit.state[e.name]=e.value,st(this.getFormData(),[e.name])}validateForm(e){e.preventDefault(),this.dispatch("validated",{detail:{validation:st(this.getFormData())}})}getFormData(){return{amount:{input:Number(this.deposit.state.amount),rules:[Hn(),$n(this.minimumValue/100)]}}}getCurrencyRate(e){return this.exchangeRatesValue[e.toLowerCase()]}getCurrencyTotalRate(e,i){return Wt.round(e*this.getCurrencyRate(i),6)}}$(Ti,"targets",["amount","paymentOption"]),$(Ti,"values",{exchangeRates:Object,minimum:Number});class Vt extends ce{copy(e){if(e.preventDefault(),!("clipboard"in navigator)){this.toggleErrorState();return}navigator.clipboard.writeText(this.sourceTarget.innerHTML||this.sourceTarget.value).then(()=>this.copied())}copied(){this.toggleSuccessState(),setTimeout(()=>{this.toggleCopyState()},2500)}toggleErrorState(){this.buttonTarget.classList.remove(this.copyClass),this.buttonTarget.classList.add(...this.errorClasses),this.toggleTooltip(this.defaultValue)}toggleSuccessState(){this.toggleTooltip(this.successValue),this.buttonTarget.classList.remove(this.copyClass),this.buttonTarget.classList.add(...this.successClasses)}toggleCopyState(){this.buttonTarget.classList.remove(...this.successClasses),this.buttonTarget.classList.add(this.copyClass),this.toggleTooltip(this.defaultValue)}toggleTooltip(e){let i=this.popoverTarget;i.setAttribute("data-bs-original-title",e),Tooltip.getInstance(i).show()}}$(Vt,"targets",["source","button","popover"]),$(Vt,"classes",["copy","error","success"]),$(Vt,"values",{default:String,success:String});function gr(t){t.forEach(e=>{e.targets.forEach(i=>{i.textContent=e.values})})}function mr({targets:t,classes:e},i){t.forEach(r=>{r.classList[i](...e)})}function Er(t){t.forEach(e=>{e.targets.forEach(i=>{i.setAttribute(...e.nameAndValues)})})}function Vo(t){t.forEach(e=>{e.targets.forEach(i=>{i.removeAttribute(...e.nameAndValues)})})}class Ii extends ce{constructor(){super(...arguments);$(this,"startsAt",Math.trunc(Date.parse(new Date().toUTCString())/1e3));$(this,"endsAt",new Date(`${this.expiresAtValue}Z`).toUTCString());$(this,"expired",!1)}connect(){this.timeRemaining=this.targetTime-this.startsAt;const i=()=>{if(!this.expired&&this.timeRemaining<=0)this.expired=!0,this.countDownTarget.style.setProperty("display","none","important"),gr([{targets:[this.expiredTarget],values:this.expiredTextValue}]),clearTimeout(i);else{const r=Math.trunc(this.timeRemaining/60/60/24),n=Math.trunc(this.timeRemaining/60/60)%24,s=Math.trunc(this.timeRemaining/60)%60,a=this.timeRemaining%60,o=r.toString().padStart(2,"0"),l=n.toString().padStart(2,"0"),d=s.toString().padStart(2,"0"),c=a.toString().padStart(2,"0"),u=[{targets:this.daysTargets,values:`${r||o}:`},{targets:this.hoursTargets,values:`${n||l}:`},{targets:this.minutesTargets,values:`${s||d}:`},{targets:this.secondsTargets,values:`${a||c}`}];gr(u),this.timeRemaining--,setTimeout(i,1e3)}};i()}get targetTime(){return Math.trunc(Date.parse(this.endsAt)/1e3)}}$(Ii,"targets",["countDown","days","hours","minutes","seconds","expired"]),$(Ii,"values",{expiresAt:String,expiredText:String});/*!
 * Cropper.js v1.5.13
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2022-11-20T05:30:46.114Z
 */function Tr(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),i.push.apply(i,r)}return i}function Yn(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Tr(Object(i),!0).forEach(function(r){$o(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Tr(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function _i(t){return _i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(t)}function Uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ir(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ko(t,e,i){return e&&Ir(t.prototype,e),i&&Ir(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function $o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function zn(t){return Ho(t)||Wo(t)||Yo(t)||zo()}function Ho(t){if(Array.isArray(t))return yi(t)}function Wo(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Yo(t,e){if(t){if(typeof t=="string")return yi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return yi(t,e)}}function yi(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function zo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zt=typeof window<"u"&&typeof window.document<"u",we=Zt?window:{},qi=Zt&&we.document.documentElement?"ontouchstart"in we.document.documentElement:!1,Xi=Zt?"PointerEvent"in we:!1,H="cropper",ji="all",qn="crop",Xn="move",jn="zoom",Be="e",Ge="w",Ke="s",Ce="n",dt="ne",ut="nw",ht="se",ft="sw",vi="".concat(H,"-crop"),_r="".concat(H,"-disabled"),le="".concat(H,"-hidden"),yr="".concat(H,"-hide"),qo="".concat(H,"-invisible"),Yt="".concat(H,"-modal"),Oi="".concat(H,"-move"),yt="".concat(H,"Action"),St="".concat(H,"Preview"),Ki="crop",Kn="move",Zn="none",Ri="crop",bi="cropend",wi="cropmove",Ai="cropstart",vr="dblclick",Xo=qi?"touchstart":"mousedown",jo=qi?"touchmove":"mousemove",Ko=qi?"touchend touchcancel":"mouseup",Or=Xi?"pointerdown":Xo,Rr=Xi?"pointermove":jo,br=Xi?"pointerup pointercancel":Ko,wr="ready",Ar="resize",Dr="wheel",Di="zoom",Sr="image/jpeg",Zo=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Qo=/^data:/,Jo=/^data:image\/jpeg;base64,/,el=/^img|canvas$/i,Qn=200,Jn=100,Mr={viewMode:0,dragMode:Ki,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Qn,minContainerHeight:Jn,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},tl='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',il=Number.isNaN||we.isNaN;function V(t){return typeof t=="number"&&!il(t)}var Cr=function(e){return e>0&&e<1/0};function si(t){return typeof t>"u"}function ze(t){return _i(t)==="object"&&t!==null}var rl=Object.prototype.hasOwnProperty;function Ze(t){if(!ze(t))return!1;try{var e=t.constructor,i=e.prototype;return e&&i&&rl.call(i,"isPrototypeOf")}catch{return!1}}function se(t){return typeof t=="function"}var nl=Array.prototype.slice;function es(t){return Array.from?Array.from(t):nl.call(t)}function X(t,e){return t&&se(e)&&(Array.isArray(t)||V(t.length)?es(t).forEach(function(i,r){e.call(t,i,r,t)}):ze(t)&&Object.keys(t).forEach(function(i){e.call(t,t[i],i,t)})),t}var W=Object.assign||function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return ze(e)&&r.length>0&&r.forEach(function(s){ze(s)&&Object.keys(s).forEach(function(a){e[a]=s[a]})}),e},sl=/\.\d*(?:0|9){12}\d*$/;function it(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return sl.test(t)?Math.round(t*e)/e:t}var al=/^width|height|left|top|marginLeft|marginTop$/;function Pe(t,e){var i=t.style;X(e,function(r,n){al.test(n)&&V(r)&&(r="".concat(r,"px")),i[n]=r})}function ol(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}function Q(t,e){if(e){if(V(t.length)){X(t,function(r){Q(r,e)});return}if(t.classList){t.classList.add(e);return}var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function be(t,e){if(e){if(V(t.length)){X(t,function(i){be(i,e)});return}if(t.classList){t.classList.remove(e);return}t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,""))}}function Qe(t,e,i){if(e){if(V(t.length)){X(t,function(r){Qe(r,e,i)});return}i?Q(t,e):be(t,e)}}var ll=/([a-z\d])([A-Z])/g;function Zi(t){return t.replace(ll,"$1-$2").toLowerCase()}function Si(t,e){return ze(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(Zi(e)))}function vt(t,e,i){ze(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(Zi(e)),i)}function cl(t,e){if(ze(t[e]))try{delete t[e]}catch{t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch{t.dataset[e]=void 0}else t.removeAttribute("data-".concat(Zi(e)))}var ts=/\s\s*/,is=function(){var t=!1;if(Zt){var e=!1,i=function(){},r=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(s){e=s}});we.addEventListener("test",i,r),we.removeEventListener("test",i,r)}return t}();function Ie(t,e,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=i;e.trim().split(ts).forEach(function(s){if(!is){var a=t.listeners;a&&a[s]&&a[s][i]&&(n=a[s][i],delete a[s][i],Object.keys(a[s]).length===0&&delete a[s],Object.keys(a).length===0&&delete t.listeners)}t.removeEventListener(s,n,r)})}function ge(t,e,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=i;e.trim().split(ts).forEach(function(s){if(r.once&&!is){var a=t.listeners,o=a===void 0?{}:a;n=function(){delete o[s][i],t.removeEventListener(s,n,r);for(var d=arguments.length,c=new Array(d),u=0;u<d;u++)c[u]=arguments[u];i.apply(t,c)},o[s]||(o[s]={}),o[s][i]&&t.removeEventListener(s,o[s][i],r),o[s][i]=n,t.listeners=o}t.addEventListener(s,n,r)})}function rt(t,e,i){var r;return se(Event)&&se(CustomEvent)?r=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!0,!0,i)),t.dispatchEvent(r)}function rs(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var ai=we.location,dl=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Lr(t){var e=t.match(dl);return e!==null&&(e[1]!==ai.protocol||e[2]!==ai.hostname||e[3]!==ai.port)}function Pr(t){var e="timestamp=".concat(new Date().getTime());return t+(t.indexOf("?")===-1?"?":"&")+e}function Et(t){var e=t.rotate,i=t.scaleX,r=t.scaleY,n=t.translateX,s=t.translateY,a=[];V(n)&&n!==0&&a.push("translateX(".concat(n,"px)")),V(s)&&s!==0&&a.push("translateY(".concat(s,"px)")),V(e)&&e!==0&&a.push("rotate(".concat(e,"deg)")),V(i)&&i!==1&&a.push("scaleX(".concat(i,")")),V(r)&&r!==1&&a.push("scaleY(".concat(r,")"));var o=a.length?a.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function ul(t){var e=Yn({},t),i=0;return X(t,function(r,n){delete e[n],X(e,function(s){var a=Math.abs(r.startX-s.startX),o=Math.abs(r.startY-s.startY),l=Math.abs(r.endX-s.endX),d=Math.abs(r.endY-s.endY),c=Math.sqrt(a*a+o*o),u=Math.sqrt(l*l+d*d),h=(u-c)/c;Math.abs(h)>Math.abs(i)&&(i=h)})}),i}function Mt(t,e){var i=t.pageX,r=t.pageY,n={endX:i,endY:r};return e?n:Yn({startX:i,startY:r},n)}function hl(t){var e=0,i=0,r=0;return X(t,function(n){var s=n.startX,a=n.startY;e+=s,i+=a,r+=1}),e/=r,i/=r,{pageX:e,pageY:i}}function Ne(t){var e=t.aspectRatio,i=t.height,r=t.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",s=Cr(r),a=Cr(i);if(s&&a){var o=i*e;n==="contain"&&o>r||n==="cover"&&o<r?i=r/e:r=i*e}else s?i=r/e:a&&(r=i*e);return{width:r,height:i}}function fl(t){var e=t.width,i=t.height,r=t.degree;if(r=Math.abs(r)%180,r===90)return{width:i,height:e};var n=r%90*Math.PI/180,s=Math.sin(n),a=Math.cos(n),o=e*a+i*s,l=e*s+i*a;return r>90?{width:l,height:o}:{width:o,height:l}}function pl(t,e,i,r){var n=e.aspectRatio,s=e.naturalWidth,a=e.naturalHeight,o=e.rotate,l=o===void 0?0:o,d=e.scaleX,c=d===void 0?1:d,u=e.scaleY,h=u===void 0?1:u,g=i.aspectRatio,f=i.naturalWidth,m=i.naturalHeight,I=r.fillColor,_=I===void 0?"transparent":I,p=r.imageSmoothingEnabled,T=p===void 0?!0:p,y=r.imageSmoothingQuality,v=y===void 0?"low":y,E=r.maxWidth,D=E===void 0?1/0:E,R=r.maxHeight,S=R===void 0?1/0:R,N=r.minWidth,M=N===void 0?0:N,C=r.minHeight,B=C===void 0?0:C,w=document.createElement("canvas"),x=w.getContext("2d"),O=Ne({aspectRatio:g,width:D,height:S}),A=Ne({aspectRatio:g,width:M,height:B},"cover"),L=Math.min(O.width,Math.max(A.width,f)),P=Math.min(O.height,Math.max(A.height,m)),G=Ne({aspectRatio:n,width:D,height:S}),k=Ne({aspectRatio:n,width:M,height:B},"cover"),Ae=Math.min(G.width,Math.max(k.width,s)),Fe=Math.min(G.height,Math.max(k.height,a)),de=[-Ae/2,-Fe/2,Ae,Fe];return w.width=it(L),w.height=it(P),x.fillStyle=_,x.fillRect(0,0,L,P),x.save(),x.translate(L/2,P/2),x.rotate(l*Math.PI/180),x.scale(c,h),x.imageSmoothingEnabled=T,x.imageSmoothingQuality=v,x.drawImage.apply(x,[t].concat(zn(de.map(function(ct){return Math.floor(it(ct))})))),x.restore(),w}var ns=String.fromCharCode;function gl(t,e,i){var r="";i+=e;for(var n=e;n<i;n+=1)r+=ns(t.getUint8(n));return r}var ml=/^data:.*,/;function El(t){var e=t.replace(ml,""),i=atob(e),r=new ArrayBuffer(i.length),n=new Uint8Array(r);return X(n,function(s,a){n[a]=i.charCodeAt(a)}),r}function Tl(t,e){for(var i=[],r=8192,n=new Uint8Array(t);n.length>0;)i.push(ns.apply(null,es(n.subarray(0,r)))),n=n.subarray(r);return"data:".concat(e,";base64,").concat(btoa(i.join("")))}function Il(t){var e=new DataView(t),i;try{var r,n,s;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var a=e.byteLength,o=2;o+1<a;){if(e.getUint8(o)===255&&e.getUint8(o+1)===225){n=o;break}o+=1}if(n){var l=n+4,d=n+10;if(gl(e,l,4)==="Exif"){var c=e.getUint16(d);if(r=c===18761,(r||c===19789)&&e.getUint16(d+2,r)===42){var u=e.getUint32(d+4,r);u>=8&&(s=d+u)}}}if(s){var h=e.getUint16(s,r),g,f;for(f=0;f<h;f+=1)if(g=s+f*12+2,e.getUint16(g,r)===274){g+=8,i=e.getUint16(g,r),e.setUint16(g,1,r);break}}}catch{i=1}return i}function _l(t){var e=0,i=1,r=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:i,scaleY:r}}var yl={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,i=this.options,r=this.container,n=this.cropper,s=Number(i.minContainerWidth),a=Number(i.minContainerHeight);Q(n,le),be(e,le);var o={width:Math.max(r.offsetWidth,s>=0?s:Qn),height:Math.max(r.offsetHeight,a>=0?a:Jn)};this.containerData=o,Pe(n,{width:o.width,height:o.height}),Q(e,le),be(n,le)},initCanvas:function(){var e=this.containerData,i=this.imageData,r=this.options.viewMode,n=Math.abs(i.rotate)%180===90,s=n?i.naturalHeight:i.naturalWidth,a=n?i.naturalWidth:i.naturalHeight,o=s/a,l=e.width,d=e.height;e.height*o>e.width?r===3?l=e.height*o:d=e.width/o:r===3?d=e.width/o:l=e.height*o;var c={aspectRatio:o,naturalWidth:s,naturalHeight:a,width:l,height:d};this.canvasData=c,this.limited=r===1||r===2,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=W({},c)},limitCanvas:function(e,i){var r=this.options,n=this.containerData,s=this.canvasData,a=this.cropBoxData,o=r.viewMode,l=s.aspectRatio,d=this.cropped&&a;if(e){var c=Number(r.minCanvasWidth)||0,u=Number(r.minCanvasHeight)||0;o>1?(c=Math.max(c,n.width),u=Math.max(u,n.height),o===3&&(u*l>c?c=u*l:u=c/l)):o>0&&(c?c=Math.max(c,d?a.width:0):u?u=Math.max(u,d?a.height:0):d&&(c=a.width,u=a.height,u*l>c?c=u*l:u=c/l));var h=Ne({aspectRatio:l,width:c,height:u});c=h.width,u=h.height,s.minWidth=c,s.minHeight=u,s.maxWidth=1/0,s.maxHeight=1/0}if(i)if(o>(d?0:1)){var g=n.width-s.width,f=n.height-s.height;s.minLeft=Math.min(0,g),s.minTop=Math.min(0,f),s.maxLeft=Math.max(0,g),s.maxTop=Math.max(0,f),d&&this.limited&&(s.minLeft=Math.min(a.left,a.left+(a.width-s.width)),s.minTop=Math.min(a.top,a.top+(a.height-s.height)),s.maxLeft=a.left,s.maxTop=a.top,o===2&&(s.width>=n.width&&(s.minLeft=Math.min(0,g),s.maxLeft=Math.max(0,g)),s.height>=n.height&&(s.minTop=Math.min(0,f),s.maxTop=Math.max(0,f))))}else s.minLeft=-s.width,s.minTop=-s.height,s.maxLeft=n.width,s.maxTop=n.height},renderCanvas:function(e,i){var r=this.canvasData,n=this.imageData;if(i){var s=fl({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),a=s.width,o=s.height,l=r.width*(a/r.naturalWidth),d=r.height*(o/r.naturalHeight);r.left-=(l-r.width)/2,r.top-=(d-r.height)/2,r.width=l,r.height=d,r.aspectRatio=a/o,r.naturalWidth=a,r.naturalHeight=o,this.limitCanvas(!0,!1)}(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCanvas(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,Pe(this.canvas,W({width:r.width,height:r.height},Et({translateX:r.left,translateY:r.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var i=this.canvasData,r=this.imageData,n=r.naturalWidth*(i.width/i.naturalWidth),s=r.naturalHeight*(i.height/i.naturalHeight);W(r,{width:n,height:s,left:(i.width-n)/2,top:(i.height-s)/2}),Pe(this.image,W({width:r.width,height:r.height},Et(W({translateX:r.left,translateY:r.top},r)))),e&&this.output()},initCropBox:function(){var e=this.options,i=this.canvasData,r=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,s={width:i.width,height:i.height};r&&(i.height*r>i.width?s.height=s.width/r:s.width=s.height*r),this.cropBoxData=s,this.limitCropBox(!0,!0),s.width=Math.min(Math.max(s.width,s.minWidth),s.maxWidth),s.height=Math.min(Math.max(s.height,s.minHeight),s.maxHeight),s.width=Math.max(s.minWidth,s.width*n),s.height=Math.max(s.minHeight,s.height*n),s.left=i.left+(i.width-s.width)/2,s.top=i.top+(i.height-s.height)/2,s.oldLeft=s.left,s.oldTop=s.top,this.initialCropBoxData=W({},s)},limitCropBox:function(e,i){var r=this.options,n=this.containerData,s=this.canvasData,a=this.cropBoxData,o=this.limited,l=r.aspectRatio;if(e){var d=Number(r.minCropBoxWidth)||0,c=Number(r.minCropBoxHeight)||0,u=o?Math.min(n.width,s.width,s.width+s.left,n.width-s.left):n.width,h=o?Math.min(n.height,s.height,s.height+s.top,n.height-s.top):n.height;d=Math.min(d,n.width),c=Math.min(c,n.height),l&&(d&&c?c*l>d?c=d/l:d=c*l:d?c=d/l:c&&(d=c*l),h*l>u?h=u/l:u=h*l),a.minWidth=Math.min(d,u),a.minHeight=Math.min(c,h),a.maxWidth=u,a.maxHeight=h}i&&(o?(a.minLeft=Math.max(0,s.left),a.minTop=Math.max(0,s.top),a.maxLeft=Math.min(n.width,s.left+s.width)-a.width,a.maxTop=Math.min(n.height,s.top+s.height)-a.height):(a.minLeft=0,a.minTop=0,a.maxLeft=n.width-a.width,a.maxTop=n.height-a.height))},renderCropBox:function(){var e=this.options,i=this.containerData,r=this.cropBoxData;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,e.movable&&e.cropBoxMovable&&vt(this.face,yt,r.width>=i.width&&r.height>=i.height?Xn:ji),Pe(this.cropBox,W({width:r.width,height:r.height},Et({translateX:r.left,translateY:r.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),rt(this.element,Ri,this.getData())}},vl={initPreview:function(){var e=this.element,i=this.crossOrigin,r=this.options.preview,n=i?this.crossOriginUrl:this.url,s=e.alt||"The image to preview",a=document.createElement("img");if(i&&(a.crossOrigin=i),a.src=n,a.alt=s,this.viewBox.appendChild(a),this.viewBoxImage=a,!!r){var o=r;typeof r=="string"?o=e.ownerDocument.querySelectorAll(r):r.querySelector&&(o=[r]),this.previews=o,X(o,function(l){var d=document.createElement("img");vt(l,St,{width:l.offsetWidth,height:l.offsetHeight,html:l.innerHTML}),i&&(d.crossOrigin=i),d.src=n,d.alt=s,d.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',l.innerHTML="",l.appendChild(d)})}},resetPreview:function(){X(this.previews,function(e){var i=Si(e,St);Pe(e,{width:i.width,height:i.height}),e.innerHTML=i.html,cl(e,St)})},preview:function(){var e=this.imageData,i=this.canvasData,r=this.cropBoxData,n=r.width,s=r.height,a=e.width,o=e.height,l=r.left-i.left-e.left,d=r.top-i.top-e.top;!this.cropped||this.disabled||(Pe(this.viewBoxImage,W({width:a,height:o},Et(W({translateX:-l,translateY:-d},e)))),X(this.previews,function(c){var u=Si(c,St),h=u.width,g=u.height,f=h,m=g,I=1;n&&(I=h/n,m=s*I),s&&m>g&&(I=g/s,f=n*I,m=g),Pe(c,{width:f,height:m}),Pe(c.getElementsByTagName("img")[0],W({width:a*I,height:o*I},Et(W({translateX:-l*I,translateY:-d*I},e))))}))}},Ol={bind:function(){var e=this.element,i=this.options,r=this.cropper;se(i.cropstart)&&ge(e,Ai,i.cropstart),se(i.cropmove)&&ge(e,wi,i.cropmove),se(i.cropend)&&ge(e,bi,i.cropend),se(i.crop)&&ge(e,Ri,i.crop),se(i.zoom)&&ge(e,Di,i.zoom),ge(r,Or,this.onCropStart=this.cropStart.bind(this)),i.zoomable&&i.zoomOnWheel&&ge(r,Dr,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),i.toggleDragModeOnDblclick&&ge(r,vr,this.onDblclick=this.dblclick.bind(this)),ge(e.ownerDocument,Rr,this.onCropMove=this.cropMove.bind(this)),ge(e.ownerDocument,br,this.onCropEnd=this.cropEnd.bind(this)),i.responsive&&ge(window,Ar,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,i=this.options,r=this.cropper;se(i.cropstart)&&Ie(e,Ai,i.cropstart),se(i.cropmove)&&Ie(e,wi,i.cropmove),se(i.cropend)&&Ie(e,bi,i.cropend),se(i.crop)&&Ie(e,Ri,i.crop),se(i.zoom)&&Ie(e,Di,i.zoom),Ie(r,Or,this.onCropStart),i.zoomable&&i.zoomOnWheel&&Ie(r,Dr,this.onWheel,{passive:!1,capture:!0}),i.toggleDragModeOnDblclick&&Ie(r,vr,this.onDblclick),Ie(e.ownerDocument,Rr,this.onCropMove),Ie(e.ownerDocument,br,this.onCropEnd),i.responsive&&Ie(window,Ar,this.onResize)}},Rl={resize:function(){if(!this.disabled){var e=this.options,i=this.container,r=this.containerData,n=i.offsetWidth/r.width,s=i.offsetHeight/r.height,a=Math.abs(n-1)>Math.abs(s-1)?n:s;if(a!==1){var o,l;e.restore&&(o=this.getCanvasData(),l=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(X(o,function(d,c){o[c]=d*a})),this.setCropBoxData(X(l,function(d,c){l[c]=d*a})))}}},dblclick:function(){this.disabled||this.options.dragMode===Zn||this.setDragMode(ol(this.dragBox,vi)?Kn:Ki)},wheel:function(e){var i=this,r=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){i.wheeling=!1},50),e.deltaY?n=e.deltaY>0?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=e.detail>0?1:-1),this.zoom(-n*r,e)))},cropStart:function(e){var i=e.buttons,r=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(V(i)&&i!==1||V(r)&&r!==0||e.ctrlKey))){var n=this.options,s=this.pointers,a;e.changedTouches?X(e.changedTouches,function(o){s[o.identifier]=Mt(o)}):s[e.pointerId||0]=Mt(e),Object.keys(s).length>1&&n.zoomable&&n.zoomOnTouch?a=jn:a=Si(e.target,yt),Zo.test(a)&&rt(this.element,Ai,{originalEvent:e,action:a})!==!1&&(e.preventDefault(),this.action=a,this.cropping=!1,a===qn&&(this.cropping=!0,Q(this.dragBox,Yt)))}},cropMove:function(e){var i=this.action;if(!(this.disabled||!i)){var r=this.pointers;e.preventDefault(),rt(this.element,wi,{originalEvent:e,action:i})!==!1&&(e.changedTouches?X(e.changedTouches,function(n){W(r[n.identifier]||{},Mt(n,!0))}):W(r[e.pointerId||0]||{},Mt(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var i=this.action,r=this.pointers;e.changedTouches?X(e.changedTouches,function(n){delete r[n.identifier]}):delete r[e.pointerId||0],i&&(e.preventDefault(),Object.keys(r).length||(this.action=""),this.cropping&&(this.cropping=!1,Qe(this.dragBox,Yt,this.cropped&&this.options.modal)),rt(this.element,bi,{originalEvent:e,action:i}))}}},bl={change:function(e){var i=this.options,r=this.canvasData,n=this.containerData,s=this.cropBoxData,a=this.pointers,o=this.action,l=i.aspectRatio,d=s.left,c=s.top,u=s.width,h=s.height,g=d+u,f=c+h,m=0,I=0,_=n.width,p=n.height,T=!0,y;!l&&e.shiftKey&&(l=u&&h?u/h:1),this.limited&&(m=s.minLeft,I=s.minTop,_=m+Math.min(n.width,r.width,r.left+r.width),p=I+Math.min(n.height,r.height,r.top+r.height));var v=a[Object.keys(a)[0]],E={x:v.endX-v.startX,y:v.endY-v.startY},D=function(S){switch(S){case Be:g+E.x>_&&(E.x=_-g);break;case Ge:d+E.x<m&&(E.x=m-d);break;case Ce:c+E.y<I&&(E.y=I-c);break;case Ke:f+E.y>p&&(E.y=p-f);break}};switch(o){case ji:d+=E.x,c+=E.y;break;case Be:if(E.x>=0&&(g>=_||l&&(c<=I||f>=p))){T=!1;break}D(Be),u+=E.x,u<0&&(o=Ge,u=-u,d-=u),l&&(h=u/l,c+=(s.height-h)/2);break;case Ce:if(E.y<=0&&(c<=I||l&&(d<=m||g>=_))){T=!1;break}D(Ce),h-=E.y,c+=E.y,h<0&&(o=Ke,h=-h,c-=h),l&&(u=h*l,d+=(s.width-u)/2);break;case Ge:if(E.x<=0&&(d<=m||l&&(c<=I||f>=p))){T=!1;break}D(Ge),u-=E.x,d+=E.x,u<0&&(o=Be,u=-u,d-=u),l&&(h=u/l,c+=(s.height-h)/2);break;case Ke:if(E.y>=0&&(f>=p||l&&(d<=m||g>=_))){T=!1;break}D(Ke),h+=E.y,h<0&&(o=Ce,h=-h,c-=h),l&&(u=h*l,d+=(s.width-u)/2);break;case dt:if(l){if(E.y<=0&&(c<=I||g>=_)){T=!1;break}D(Ce),h-=E.y,c+=E.y,u=h*l}else D(Ce),D(Be),E.x>=0?g<_?u+=E.x:E.y<=0&&c<=I&&(T=!1):u+=E.x,E.y<=0?c>I&&(h-=E.y,c+=E.y):(h-=E.y,c+=E.y);u<0&&h<0?(o=ft,h=-h,u=-u,c-=h,d-=u):u<0?(o=ut,u=-u,d-=u):h<0&&(o=ht,h=-h,c-=h);break;case ut:if(l){if(E.y<=0&&(c<=I||d<=m)){T=!1;break}D(Ce),h-=E.y,c+=E.y,u=h*l,d+=s.width-u}else D(Ce),D(Ge),E.x<=0?d>m?(u-=E.x,d+=E.x):E.y<=0&&c<=I&&(T=!1):(u-=E.x,d+=E.x),E.y<=0?c>I&&(h-=E.y,c+=E.y):(h-=E.y,c+=E.y);u<0&&h<0?(o=ht,h=-h,u=-u,c-=h,d-=u):u<0?(o=dt,u=-u,d-=u):h<0&&(o=ft,h=-h,c-=h);break;case ft:if(l){if(E.x<=0&&(d<=m||f>=p)){T=!1;break}D(Ge),u-=E.x,d+=E.x,h=u/l}else D(Ke),D(Ge),E.x<=0?d>m?(u-=E.x,d+=E.x):E.y>=0&&f>=p&&(T=!1):(u-=E.x,d+=E.x),E.y>=0?f<p&&(h+=E.y):h+=E.y;u<0&&h<0?(o=dt,h=-h,u=-u,c-=h,d-=u):u<0?(o=ht,u=-u,d-=u):h<0&&(o=ut,h=-h,c-=h);break;case ht:if(l){if(E.x>=0&&(g>=_||f>=p)){T=!1;break}D(Be),u+=E.x,h=u/l}else D(Ke),D(Be),E.x>=0?g<_?u+=E.x:E.y>=0&&f>=p&&(T=!1):u+=E.x,E.y>=0?f<p&&(h+=E.y):h+=E.y;u<0&&h<0?(o=ut,h=-h,u=-u,c-=h,d-=u):u<0?(o=ft,u=-u,d-=u):h<0&&(o=dt,h=-h,c-=h);break;case Xn:this.move(E.x,E.y),T=!1;break;case jn:this.zoom(ul(a),e),T=!1;break;case qn:if(!E.x||!E.y){T=!1;break}y=rs(this.cropper),d=v.startX-y.left,c=v.startY-y.top,u=s.minWidth,h=s.minHeight,E.x>0?o=E.y>0?ht:dt:E.x<0&&(d-=u,o=E.y>0?ft:ut),E.y<0&&(c-=h),this.cropped||(be(this.cropBox,le),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}T&&(s.width=u,s.height=h,s.left=d,s.top=c,this.action=o,this.renderCropBox()),X(a,function(R){R.startX=R.endX,R.startY=R.endY})}},wl={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Q(this.dragBox,Yt),be(this.cropBox,le),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=W({},this.initialImageData),this.canvasData=W({},this.initialCanvasData),this.cropBoxData=W({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(W(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),be(this.dragBox,Yt),Q(this.cropBox,le)),this},replace:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),i?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,X(this.previews,function(r){r.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,be(this.cropper,_r)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Q(this.cropper,_r)),this},destroy:function(){var e=this.element;return e[H]?(e[H]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.canvasData,n=r.left,s=r.top;return this.moveTo(si(e)?e:n+Number(e),si(i)?i:s+Number(i))},moveTo:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.canvasData,n=!1;return e=Number(e),i=Number(i),this.ready&&!this.disabled&&this.options.movable&&(V(e)&&(r.left=e,n=!0),V(i)&&(r.top=i,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(e,i){var r=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(r.width*e/r.naturalWidth,null,i)},zoomTo:function(e,i,r){var n=this.options,s=this.canvasData,a=s.width,o=s.height,l=s.naturalWidth,d=s.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&n.zoomable){var c=l*e,u=d*e;if(rt(this.element,Di,{ratio:e,oldRatio:a/l,originalEvent:r})===!1)return this;if(r){var h=this.pointers,g=rs(this.cropper),f=h&&Object.keys(h).length?hl(h):{pageX:r.pageX,pageY:r.pageY};s.left-=(c-a)*((f.pageX-g.left-s.left)/a),s.top-=(u-o)*((f.pageY-g.top-s.top)/o)}else Ze(i)&&V(i.x)&&V(i.y)?(s.left-=(c-a)*((i.x-s.left)/a),s.top-=(u-o)*((i.y-s.top)/o)):(s.left-=(c-a)/2,s.top-=(u-o)/2);s.width=c,s.height=u,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),V(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var i=this.imageData.scaleY;return this.scale(e,V(i)?i:1)},scaleY:function(e){var i=this.imageData.scaleX;return this.scale(V(i)?i:1,e)},scale:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.imageData,n=!1;return e=Number(e),i=Number(i),this.ready&&!this.disabled&&this.options.scalable&&(V(e)&&(r.scaleX=e,n=!0),V(i)&&(r.scaleY=i,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=this.options,r=this.imageData,n=this.canvasData,s=this.cropBoxData,a;if(this.ready&&this.cropped){a={x:s.left-n.left,y:s.top-n.top,width:s.width,height:s.height};var o=r.width/r.naturalWidth;if(X(a,function(c,u){a[u]=c/o}),e){var l=Math.round(a.y+a.height),d=Math.round(a.x+a.width);a.x=Math.round(a.x),a.y=Math.round(a.y),a.width=d-a.x,a.height=l-a.y}}else a={x:0,y:0,width:0,height:0};return i.rotatable&&(a.rotate=r.rotate||0),i.scalable&&(a.scaleX=r.scaleX||1,a.scaleY=r.scaleY||1),a},setData:function(e){var i=this.options,r=this.imageData,n=this.canvasData,s={};if(this.ready&&!this.disabled&&Ze(e)){var a=!1;i.rotatable&&V(e.rotate)&&e.rotate!==r.rotate&&(r.rotate=e.rotate,a=!0),i.scalable&&(V(e.scaleX)&&e.scaleX!==r.scaleX&&(r.scaleX=e.scaleX,a=!0),V(e.scaleY)&&e.scaleY!==r.scaleY&&(r.scaleY=e.scaleY,a=!0)),a&&this.renderCanvas(!0,!0);var o=r.width/r.naturalWidth;V(e.x)&&(s.left=e.x*o+n.left),V(e.y)&&(s.top=e.y*o+n.top),V(e.width)&&(s.width=e.width*o),V(e.height)&&(s.height=e.height*o),this.setCropBoxData(s)}return this},getContainerData:function(){return this.ready?W({},this.containerData):{}},getImageData:function(){return this.sized?W({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,i={};return this.ready&&X(["left","top","width","height","naturalWidth","naturalHeight"],function(r){i[r]=e[r]}),i},setCanvasData:function(e){var i=this.canvasData,r=i.aspectRatio;return this.ready&&!this.disabled&&Ze(e)&&(V(e.left)&&(i.left=e.left),V(e.top)&&(i.top=e.top),V(e.width)?(i.width=e.width,i.height=e.width/r):V(e.height)&&(i.height=e.height,i.width=e.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,i;return this.ready&&this.cropped&&(i={left:e.left,top:e.top,width:e.width,height:e.height}),i||{}},setCropBoxData:function(e){var i=this.cropBoxData,r=this.options.aspectRatio,n,s;return this.ready&&this.cropped&&!this.disabled&&Ze(e)&&(V(e.left)&&(i.left=e.left),V(e.top)&&(i.top=e.top),V(e.width)&&e.width!==i.width&&(n=!0,i.width=e.width),V(e.height)&&e.height!==i.height&&(s=!0,i.height=e.height),r&&(n?i.height=i.width/r:s&&(i.width=i.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var i=this.canvasData,r=pl(this.image,this.imageData,i,e);if(!this.cropped)return r;var n=this.getData(),s=n.x,a=n.y,o=n.width,l=n.height,d=r.width/Math.floor(i.naturalWidth);d!==1&&(s*=d,a*=d,o*=d,l*=d);var c=o/l,u=Ne({aspectRatio:c,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),h=Ne({aspectRatio:c,width:e.minWidth||0,height:e.minHeight||0},"cover"),g=Ne({aspectRatio:c,width:e.width||(d!==1?r.width:o),height:e.height||(d!==1?r.height:l)}),f=g.width,m=g.height;f=Math.min(u.width,Math.max(h.width,f)),m=Math.min(u.height,Math.max(h.height,m));var I=document.createElement("canvas"),_=I.getContext("2d");I.width=it(f),I.height=it(m),_.fillStyle=e.fillColor||"transparent",_.fillRect(0,0,f,m);var p=e.imageSmoothingEnabled,T=p===void 0?!0:p,y=e.imageSmoothingQuality;_.imageSmoothingEnabled=T,y&&(_.imageSmoothingQuality=y);var v=r.width,E=r.height,D=s,R=a,S,N,M,C,B,w;D<=-o||D>v?(D=0,S=0,M=0,B=0):D<=0?(M=-D,D=0,S=Math.min(v,o+D),B=S):D<=v&&(M=0,S=Math.min(o,v-D),B=S),S<=0||R<=-l||R>E?(R=0,N=0,C=0,w=0):R<=0?(C=-R,R=0,N=Math.min(E,l+R),w=N):R<=E&&(C=0,N=Math.min(l,E-R),w=N);var x=[D,R,S,N];if(B>0&&w>0){var O=f/o;x.push(M*O,C*O,B*O,w*O)}return _.drawImage.apply(_,[r].concat(zn(x.map(function(A){return Math.floor(it(A))})))),I},setAspectRatio:function(e){var i=this.options;return!this.disabled&&!si(e)&&(i.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var i=this.options,r=this.dragBox,n=this.face;if(this.ready&&!this.disabled){var s=e===Ki,a=i.movable&&e===Kn;e=s||a?e:Zn,i.dragMode=e,vt(r,yt,e),Qe(r,vi,s),Qe(r,Oi,a),i.cropBoxMovable||(vt(n,yt,e),Qe(n,vi,s),Qe(n,Oi,a))}return this}},Al=we.Cropper,ss=function(){function t(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Uo(this,t),!e||!el.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=W({},Mr,Ze(i)&&i),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return ko(t,[{key:"init",value:function(){var i=this.element,r=i.tagName.toLowerCase(),n;if(!i[H]){if(i[H]=this,r==="img"){if(this.isImg=!0,n=i.getAttribute("src")||"",this.originalUrl=n,!n)return;n=i.src}else r==="canvas"&&window.HTMLCanvasElement&&(n=i.toDataURL());this.load(n)}}},{key:"load",value:function(i){var r=this;if(i){this.url=i,this.imageData={};var n=this.element,s=this.options;if(!s.rotatable&&!s.scalable&&(s.checkOrientation=!1),!s.checkOrientation||!window.ArrayBuffer){this.clone();return}if(Qo.test(i)){Jo.test(i)?this.read(El(i)):this.clone();return}var a=new XMLHttpRequest,o=this.clone.bind(this);this.reloading=!0,this.xhr=a,a.onabort=o,a.onerror=o,a.ontimeout=o,a.onprogress=function(){a.getResponseHeader("content-type")!==Sr&&a.abort()},a.onload=function(){r.read(a.response)},a.onloadend=function(){r.reloading=!1,r.xhr=null},s.checkCrossOrigin&&Lr(i)&&n.crossOrigin&&(i=Pr(i)),a.open("GET",i,!0),a.responseType="arraybuffer",a.withCredentials=n.crossOrigin==="use-credentials",a.send()}}},{key:"read",value:function(i){var r=this.options,n=this.imageData,s=Il(i),a=0,o=1,l=1;if(s>1){this.url=Tl(i,Sr);var d=_l(s);a=d.rotate,o=d.scaleX,l=d.scaleY}r.rotatable&&(n.rotate=a),r.scalable&&(n.scaleX=o,n.scaleY=l),this.clone()}},{key:"clone",value:function(){var i=this.element,r=this.url,n=i.crossOrigin,s=r;this.options.checkCrossOrigin&&Lr(r)&&(n||(n="anonymous"),s=Pr(r)),this.crossOrigin=n,this.crossOriginUrl=s;var a=document.createElement("img");n&&(a.crossOrigin=n),a.src=s||r,a.alt=i.alt||"The image to crop",this.image=a,a.onload=this.start.bind(this),a.onerror=this.stop.bind(this),Q(a,yr),i.parentNode.insertBefore(a,i.nextSibling)}},{key:"start",value:function(){var i=this,r=this.image;r.onload=null,r.onerror=null,this.sizing=!0;var n=we.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(we.navigator.userAgent),s=function(d,c){W(i.imageData,{naturalWidth:d,naturalHeight:c,aspectRatio:d/c}),i.initialImageData=W({},i.imageData),i.sizing=!1,i.sized=!0,i.build()};if(r.naturalWidth&&!n){s(r.naturalWidth,r.naturalHeight);return}var a=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=a,a.onload=function(){s(a.width,a.height),n||o.removeChild(a)},a.src=r.src,n||(a.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(a))}},{key:"stop",value:function(){var i=this.image;i.onload=null,i.onerror=null,i.parentNode.removeChild(i),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var i=this.element,r=this.options,n=this.image,s=i.parentNode,a=document.createElement("div");a.innerHTML=tl;var o=a.querySelector(".".concat(H,"-container")),l=o.querySelector(".".concat(H,"-canvas")),d=o.querySelector(".".concat(H,"-drag-box")),c=o.querySelector(".".concat(H,"-crop-box")),u=c.querySelector(".".concat(H,"-face"));this.container=s,this.cropper=o,this.canvas=l,this.dragBox=d,this.cropBox=c,this.viewBox=o.querySelector(".".concat(H,"-view-box")),this.face=u,l.appendChild(n),Q(i,le),s.insertBefore(o,i.nextSibling),be(n,yr),this.initPreview(),this.bind(),r.initialAspectRatio=Math.max(0,r.initialAspectRatio)||NaN,r.aspectRatio=Math.max(0,r.aspectRatio)||NaN,r.viewMode=Math.max(0,Math.min(3,Math.round(r.viewMode)))||0,Q(c,le),r.guides||Q(c.getElementsByClassName("".concat(H,"-dashed")),le),r.center||Q(c.getElementsByClassName("".concat(H,"-center")),le),r.background&&Q(o,"".concat(H,"-bg")),r.highlight||Q(u,qo),r.cropBoxMovable&&(Q(u,Oi),vt(u,yt,ji)),r.cropBoxResizable||(Q(c.getElementsByClassName("".concat(H,"-line")),le),Q(c.getElementsByClassName("".concat(H,"-point")),le)),this.render(),this.ready=!0,this.setDragMode(r.dragMode),r.autoCrop&&this.crop(),this.setData(r.data),se(r.ready)&&ge(i,wr,r.ready,{once:!0}),rt(i,wr)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var i=this.cropper.parentNode;i&&i.removeChild(this.cropper),be(this.element,le)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Al,t}},{key:"setDefaults",value:function(i){W(Mr,Ze(i)&&i)}}]),t}();W(ss.prototype,yl,vl,Ol,Rl,bl,wl);class as extends ce{connect(){this.cropper="",this.modal=""}show({detail:{image:e}}){this.modal=new sa(this.modalTarget),this.modal.show(),this.modalTarget.addEventListener("shown.bs.modal",()=>{this.cropper=new ss(this.imageTarget,{dragMode:"move",aspectRatio:1,autoCropArea:1,viewMode:3,restore:!1,guides:!1,center:!1,highlight:!1,cropBoxMovable:!0,cropBoxResizable:!0,checkCrossOrigin:!0,toggleDragModeOnDblclick:!1,ready:function(){}})}),this.modalTarget.addEventListener("hidden.bs.modal",()=>{this.cropper.destroy(),this.cropper=null})}crop(){this.modal.hide();let e;this.cropper&&(e=this.getRoundedCanvas(this.cropper.getCroppedCanvas({width:700,height:700})),this.dispatch("upload",{detail:{canvas:e}}))}getRoundedCanvas(e){const i=document.createElement("canvas"),r=i.getContext("2d"),n=e.width,s=e.height;return i.width=n,i.height=s,r.imageSmoothingEnabled=!0,r.drawImage(e,0,0,n,s),r.globalCompositeOperation="destination-in",r.beginPath(),r.arc(n/2,s/2,Math.min(n,s)/2,0,2*Math.PI,!0),r.fill(),i}}$(as,"targets",["image","modal"]);class Mi extends ce{show(){mr({targets:[this.toggleTarget,this.dropdownTarget],classes:[this.showClass]},"add");let e=[{targets:[this.toggleTarget],nameAndValues:["aria-expanded","true"]},{targets:[this.dropdownTarget],nameAndValues:["data-bs-popper","none"]}];this.dropdownTarget.focus(),Er(e)}hide(e){!this.element.contains(e.target)&&!this.dropdownTarget.classList.contains("hidden")&&(mr({targets:[this.toggleTarget,this.dropdownTarget],classes:[this.showClass]},"remove"),Er([{targets:[this.toggleTarget],nameAndValues:["aria-expanded",!0]}]),Vo([{targets:[this.dropdownTarget],nameAndValues:["data-bs-popper"]}]))}}$(Mi,"targets",["toggle","dropdown"]),$(Mi,"classes",["show"]);class Ci extends ce{clickInput(){this.inputTarget.click()}readFile(e){const i=e.target.files,r=i[0];if(i&&i.length>0){if(URL)this.imageTarget.src=URL.createObjectURL(r),this.dispatch("cropper",{detail:{image:URL.createObjectURL(r)}});else if(FileReader){const n=new FileReader;n.onload=()=>{this.dispatch("cropper",{detail:{image:n.result}})},n.readAsDataURL(r)}}}upload({detail:{canvas:e}}){let i;i=this.avatarTarget.src,this.progressTarget.style.display="block",this.alertTarget.classList.remove("alert-success","alert-warning"),e.toBlob(r=>{const n=new FormData;n.append("avatar",r,"image.jpg"),n.append("_method","PUT"),na({method:"POST",url:this.urlValue,headers:{"X-CSRF-TOKEN":this.tokenValue},data:n,onUploadProgress:s=>{let a="0",o="0%";s.event.lengthComputable&&(a=Math.round(s.loaded/s.total*100),o=a+"%",this.progressBarTarget.textContent=o,this.progressBarTarget.style.width=o,this.progressBarTarget.setAttribute("aria-valuenow",a))}}).then(s=>{this.alertTarget.style.display="block",this.alertTarget.classList.add("alert-success"),this.alertTarget.textContent=s.data.success,this.avatarTarget.src=s.data.avatarUrl}).catch(s=>{this.avatarTarget.src=i;const a=s.response.data.message||s.response.data.error;this.alertTarget.style.display="block",this.alertTarget.classList.add("alert-danger"),this.alertTarget.textContent=a}).finally(()=>{this.progressTarget.style.display="none"})})}}$(Ci,"targets",["alert","avatar","image","input","progress","progressBar"]),$(Ci,"values",{url:String,token:String});/*!
 * FilePond 4.30.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Dl=t=>t instanceof HTMLElement,Sl=(t,e=[],i=[])=>{const r={...t},n=[],s=[],a=()=>({...r}),o=()=>{const f=[...n];return n.length=0,f},l=()=>{const f=[...s];s.length=0,f.forEach(({type:m,data:I})=>{d(m,I)})},d=(f,m,I)=>{if(I&&!document.hidden){s.push({type:f,data:m});return}g[f]&&g[f](m),n.push({type:f,data:m})},c=(f,...m)=>h[f]?h[f](...m):null,u={getState:a,processActionQueue:o,processDispatchQueue:l,dispatch:d,query:c};let h={};e.forEach(f=>{h={...f(r),...h}});let g={};return i.forEach(f=>{g={...f(d,c,r),...g}}),u},Ml=(t,e,i)=>{if(typeof i=="function"){t[e]=i;return}Object.defineProperty(t,e,{...i})},Y=(t,e)=>{for(const i in t)t.hasOwnProperty(i)&&e(i,t[i])},xe=t=>{const e={};return Y(t,i=>{Ml(e,i,t[i])}),e},j=(t,e,i=null)=>{if(i===null)return t.getAttribute(e)||t.hasAttribute(e);t.setAttribute(e,i)},Cl="http://www.w3.org/2000/svg",Ll=["svg","path"],Nr=t=>Ll.includes(t),zt=(t,e,i={})=>{typeof e=="object"&&(i=e,e=null);const r=Nr(t)?document.createElementNS(Cl,t):document.createElement(t);return e&&(Nr(t)?j(r,"class",e):r.className=e),Y(i,(n,s)=>{j(r,n,s)}),r},Pl=t=>(e,i)=>{typeof i<"u"&&t.children[i]?t.insertBefore(e,t.children[i]):t.appendChild(e)},Nl=(t,e)=>(i,r)=>(typeof r<"u"?e.splice(r,0,i):e.push(i),i),xl=(t,e)=>i=>(e.splice(e.indexOf(i),1),i.element.parentNode&&t.removeChild(i.element),i),Fl=(()=>typeof window<"u"&&typeof window.document<"u")(),os=()=>Fl,Bl=os()?zt("svg"):{},Gl="children"in Bl?t=>t.children.length:t=>t.childNodes.length,ls=(t,e,i,r)=>{const n=i[0]||t.left,s=i[1]||t.top,a=n+t.width,o=s+t.height*(r[1]||1),l={element:{...t},inner:{left:t.left,top:t.top,right:t.right,bottom:t.bottom},outer:{left:n,top:s,right:a,bottom:o}};return e.filter(d=>!d.isRectIgnored()).map(d=>d.rect).forEach(d=>{xr(l.inner,{...d.inner}),xr(l.outer,{...d.outer})}),Fr(l.inner),l.outer.bottom+=l.element.marginBottom,l.outer.right+=l.element.marginRight,Fr(l.outer),l},xr=(t,e)=>{e.top+=t.top,e.right+=t.left,e.bottom+=t.top,e.left+=t.left,e.bottom>t.bottom&&(t.bottom=e.bottom),e.right>t.right&&(t.right=e.right)},Fr=t=>{t.width=t.right-t.left,t.height=t.bottom-t.top},Ve=t=>typeof t=="number",Vl=(t,e,i,r=.001)=>Math.abs(t-e)<r&&Math.abs(i)<r,Ul=({stiffness:t=.5,damping:e=.75,mass:i=10}={})=>{let r=null,n=null,s=0,a=!1;const d=xe({interpolate:(c,u)=>{if(a)return;if(!(Ve(r)&&Ve(n))){a=!0,s=0;return}const h=-(n-r)*t;s+=h/i,n+=s,s*=e,Vl(n,r,s)||u?(n=r,s=0,a=!0,d.onupdate(n),d.oncomplete(n)):d.onupdate(n)},target:{set:c=>{if(Ve(c)&&!Ve(n)&&(n=c),r===null&&(r=c,n=c),r=c,n===r||typeof r>"u"){a=!0,s=0,d.onupdate(n),d.oncomplete(n);return}a=!1},get:()=>r},resting:{get:()=>a},onupdate:c=>{},oncomplete:c=>{}});return d},kl=t=>t<.5?2*t*t:-1+(4-2*t)*t,$l=({duration:t=500,easing:e=kl,delay:i=0}={})=>{let r=null,n,s,a=!0,o=!1,l=null;const c=xe({interpolate:(u,h)=>{a||l===null||(r===null&&(r=u),!(u-r<i)&&(n=u-r-i,n>=t||h?(n=1,s=o?0:1,c.onupdate(s*l),c.oncomplete(s*l),a=!0):(s=n/t,c.onupdate((n>=0?e(o?1-s:s):0)*l))))},target:{get:()=>o?0:l,set:u=>{if(l===null){l=u,c.onupdate(u),c.oncomplete(u);return}u<l?(l=1,o=!0):(o=!1,l=u),a=!1,r=null}},resting:{get:()=>a},onupdate:u=>{},oncomplete:u=>{}});return c},Br={spring:Ul,tween:$l},Hl=(t,e,i)=>{const r=t[e]&&typeof t[e][i]=="object"?t[e][i]:t[e]||t,n=typeof r=="string"?r:r.type,s=typeof r=="object"?{...r}:{};return Br[n]?Br[n](s):null},Qi=(t,e,i,r=!1)=>{e=Array.isArray(e)?e:[e],e.forEach(n=>{t.forEach(s=>{let a=s,o=()=>i[s],l=d=>i[s]=d;typeof s=="object"&&(a=s.key,o=s.getter||o,l=s.setter||l),!(n[a]&&!r)&&(n[a]={get:o,set:l})})})},Wl=({mixinConfig:t,viewProps:e,viewInternalAPI:i,viewExternalAPI:r})=>{const n={...e},s=[];return Y(t,(a,o)=>{const l=Hl(o);if(!l)return;l.onupdate=c=>{e[a]=c},l.target=n[a],Qi([{key:a,setter:c=>{l.target!==c&&(l.target=c)},getter:()=>e[a]}],[i,r],e,!0),s.push(l)}),{write:a=>{let o=document.hidden,l=!0;return s.forEach(d=>{d.resting||(l=!1),d.interpolate(a,o)}),l},destroy:()=>{}}},Yl=t=>(e,i)=>{t.addEventListener(e,i)},zl=t=>(e,i)=>{t.removeEventListener(e,i)},ql=({mixinConfig:t,viewProps:e,viewInternalAPI:i,viewExternalAPI:r,viewState:n,view:s})=>{const a=[],o=Yl(s.element),l=zl(s.element);return r.on=(d,c)=>{a.push({type:d,fn:c}),o(d,c)},r.off=(d,c)=>{a.splice(a.findIndex(u=>u.type===d&&u.fn===c),1),l(d,c)},{write:()=>!0,destroy:()=>{a.forEach(d=>{l(d.type,d.fn)})}}},Xl=({mixinConfig:t,viewProps:e,viewExternalAPI:i})=>{Qi(t,i,e)},te=t=>t!=null,jl={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},Kl=({mixinConfig:t,viewProps:e,viewInternalAPI:i,viewExternalAPI:r,view:n})=>{const s={...e},a={};Qi(t,[i,r],e);const o=()=>[e.translateX||0,e.translateY||0],l=()=>[e.scaleX||0,e.scaleY||0],d=()=>n.rect?ls(n.rect,n.childViews,o(),l()):null;return i.rect={get:d},r.rect={get:d},t.forEach(c=>{e[c]=typeof s[c]>"u"?jl[c]:s[c]}),{write:()=>{if(Zl(a,e))return Ql(n.element,e),Object.assign(a,{...e}),!0},destroy:()=>{}}},Zl=(t,e)=>{if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in e)if(e[i]!==t[i])return!0;return!1},Ql=(t,{opacity:e,perspective:i,translateX:r,translateY:n,scaleX:s,scaleY:a,rotateX:o,rotateY:l,rotateZ:d,originX:c,originY:u,width:h,height:g})=>{let f="",m="";(te(c)||te(u))&&(m+=`transform-origin: ${c||0}px ${u||0}px;`),te(i)&&(f+=`perspective(${i}px) `),(te(r)||te(n))&&(f+=`translate3d(${r||0}px, ${n||0}px, 0) `),(te(s)||te(a))&&(f+=`scale3d(${te(s)?s:1}, ${te(a)?a:1}, 1) `),te(d)&&(f+=`rotateZ(${d}rad) `),te(o)&&(f+=`rotateX(${o}rad) `),te(l)&&(f+=`rotateY(${l}rad) `),f.length&&(m+=`transform:${f};`),te(e)&&(m+=`opacity:${e};`,e===0&&(m+="visibility:hidden;"),e<1&&(m+="pointer-events:none;")),te(g)&&(m+=`height:${g}px;`),te(h)&&(m+=`width:${h}px;`);const I=t.elementCurrentStyle||"";(m.length!==I.length||m!==I)&&(t.style.cssText=m,t.elementCurrentStyle=m)},Jl={styles:Kl,listeners:ql,animations:Wl,apis:Xl},Gr=(t={},e={},i={})=>(e.layoutCalculated||(t.paddingTop=parseInt(i.paddingTop,10)||0,t.marginTop=parseInt(i.marginTop,10)||0,t.marginRight=parseInt(i.marginRight,10)||0,t.marginBottom=parseInt(i.marginBottom,10)||0,t.marginLeft=parseInt(i.marginLeft,10)||0,e.layoutCalculated=!0),t.left=e.offsetLeft||0,t.top=e.offsetTop||0,t.width=e.offsetWidth||0,t.height=e.offsetHeight||0,t.right=t.left+t.width,t.bottom=t.top+t.height,t.scrollTop=e.scrollTop,t.hidden=e.offsetParent===null,t),K=({tag:t="div",name:e=null,attributes:i={},read:r=()=>{},write:n=()=>{},create:s=()=>{},destroy:a=()=>{},filterFrameActionsForChild:o=(g,f)=>f,didCreateView:l=()=>{},didWriteView:d=()=>{},ignoreRect:c=!1,ignoreRectUpdate:u=!1,mixins:h=[]}={})=>(g,f={})=>{const m=zt(t,`filepond--${e}`,i),I=window.getComputedStyle(m,null),_=Gr();let p=null,T=!1;const y=[],v=[],E={},D={},R=[n],S=[r],N=[a],M=()=>m,C=()=>y.concat(),B=()=>E,w=U=>(ee,De)=>ee(U,De),x=()=>p||(p=ls(_,y,[0,0],[1,1]),p),O=()=>I,A=()=>{p=null,y.forEach(De=>De._read()),!(u&&_.width&&_.height)&&Gr(_,m,I);const ee={root:de,props:f,rect:_};S.forEach(De=>De(ee))},L=(U,ee,De)=>{let je=ee.length===0;return R.forEach(ne=>{ne({props:f,root:de,actions:ee,timestamp:U,shouldOptimize:De})===!1&&(je=!1)}),v.forEach(ne=>{ne.write(U)===!1&&(je=!1)}),y.filter(ne=>!!ne.element.parentNode).forEach(ne=>{ne._write(U,o(ne,ee),De)||(je=!1)}),y.forEach((ne,At)=>{ne.element.parentNode||(de.appendChild(ne.element,At),ne._read(),ne._write(U,o(ne,ee),De),je=!1)}),T=je,d({props:f,root:de,actions:ee,timestamp:U}),je},P=()=>{v.forEach(U=>U.destroy()),N.forEach(U=>{U({root:de,props:f})}),y.forEach(U=>U._destroy())},G={element:{get:M},style:{get:O},childViews:{get:C}},k={...G,rect:{get:x},ref:{get:B},is:U=>e===U,appendChild:Pl(m),createChildView:w(g),linkView:U=>(y.push(U),U),unlinkView:U=>{y.splice(y.indexOf(U),1)},appendChildView:Nl(m,y),removeChildView:xl(m,y),registerWriter:U=>R.push(U),registerReader:U=>S.push(U),registerDestroyer:U=>N.push(U),invalidateLayout:()=>m.layoutCalculated=!1,dispatch:g.dispatch,query:g.query},Ae={element:{get:M},childViews:{get:C},rect:{get:x},resting:{get:()=>T},isRectIgnored:()=>c,_read:A,_write:L,_destroy:P},Fe={...G,rect:{get:()=>_}};Object.keys(h).sort((U,ee)=>U==="styles"?1:ee==="styles"?-1:0).forEach(U=>{const ee=Jl[U]({mixinConfig:h[U],viewProps:f,viewState:D,viewInternalAPI:k,viewExternalAPI:Ae,view:xe(Fe)});ee&&v.push(ee)});const de=xe(k);s({root:de,props:f});const ct=Gl(m);return y.forEach((U,ee)=>{de.appendChild(U.element,ct+ee)}),l(de),xe(Ae)},ec=(t,e,i=60)=>{const r="__framePainter";if(window[r]){window[r].readers.push(t),window[r].writers.push(e);return}window[r]={readers:[t],writers:[e]};const n=window[r],s=1e3/i;let a=null,o=null,l=null,d=null;const c=()=>{document.hidden?(l=()=>window.setTimeout(()=>u(performance.now()),s),d=()=>window.clearTimeout(o)):(l=()=>window.requestAnimationFrame(u),d=()=>window.cancelAnimationFrame(o))};document.addEventListener("visibilitychange",()=>{d&&d(),c(),u(performance.now())});const u=h=>{o=l(u),a||(a=h);const g=h-a;g<=s||(a=h-g%s,n.readers.forEach(f=>f()),n.writers.forEach(f=>f(h)))};return c(),u(performance.now()),{pause:()=>{d(o)}}},re=(t,e)=>({root:i,props:r,actions:n=[],timestamp:s,shouldOptimize:a})=>{n.filter(o=>t[o.type]).forEach(o=>t[o.type]({root:i,props:r,action:o.data,timestamp:s,shouldOptimize:a})),e&&e({root:i,props:r,actions:n,timestamp:s,shouldOptimize:a})},Vr=(t,e)=>e.parentNode.insertBefore(t,e),Ur=(t,e)=>e.parentNode.insertBefore(t,e.nextSibling),Qt=t=>Array.isArray(t),Se=t=>t==null,tc=t=>t.trim(),Jt=t=>""+t,ic=(t,e=",")=>Se(t)?[]:Qt(t)?t:Jt(t).split(e).map(tc).filter(i=>i.length),cs=t=>typeof t=="boolean",ds=t=>cs(t)?t:t==="true",ie=t=>typeof t=="string",us=t=>Ve(t)?t:ie(t)?Jt(t).replace(/[a-z]+/gi,""):0,Ut=t=>parseInt(us(t),10),kr=t=>parseFloat(us(t)),lt=t=>Ve(t)&&isFinite(t)&&Math.floor(t)===t,$r=(t,e=1e3)=>{if(lt(t))return t;let i=Jt(t).trim();return/MB$/i.test(i)?(i=i.replace(/MB$i/,"").trim(),Ut(i)*e*e):/KB/i.test(i)?(i=i.replace(/KB$i/,"").trim(),Ut(i)*e):Ut(i)},Ue=t=>typeof t=="function",rc=t=>{let e=self,i=t.split("."),r=null;for(;r=i.shift();)if(e=e[r],!e)return null;return e},Hr={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},nc=t=>{const e={};return e.url=ie(t)?t:t.url||"",e.timeout=t.timeout?parseInt(t.timeout,10):0,e.headers=t.headers?t.headers:{},Y(Hr,i=>{e[i]=sc(i,t[i],Hr[i],e.timeout,e.headers)}),e.process=t.process||ie(t)||t.url?e.process:null,e.remove=t.remove||null,delete e.headers,e},sc=(t,e,i,r,n)=>{if(e===null)return null;if(typeof e=="function")return e;const s={url:i==="GET"||i==="PATCH"?`?${t}=`:"",method:i,headers:n,withCredentials:!1,timeout:r,onload:null,ondata:null,onerror:null};if(ie(e))return s.url=e,s;if(Object.assign(s,e),ie(s.headers)){const a=s.headers.split(/:(.+)/);s.headers={header:a[0],value:a[1]}}return s.withCredentials=ds(s.withCredentials),s},ac=t=>nc(t),oc=t=>t===null,J=t=>typeof t=="object"&&t!==null,lc=t=>J(t)&&ie(t.url)&&J(t.process)&&J(t.revert)&&J(t.restore)&&J(t.fetch),Li=t=>Qt(t)?"array":oc(t)?"null":lt(t)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(t)?"bytes":lc(t)?"api":typeof t,cc=t=>t.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'),dc={array:ic,boolean:ds,int:t=>Li(t)==="bytes"?$r(t):Ut(t),number:kr,float:kr,bytes:$r,string:t=>Ue(t)?t:Jt(t),function:t=>rc(t),serverapi:ac,object:t=>{try{return JSON.parse(cc(t))}catch{return null}}},uc=(t,e)=>dc[e](t),hs=(t,e,i)=>{if(t===e)return t;let r=Li(t);if(r!==i){const n=uc(t,i);if(r=Li(n),n===null)throw`Trying to assign value with incorrect type to "${option}", allowed type: "${i}"`;t=n}return t},hc=(t,e)=>{let i=t;return{enumerable:!0,get:()=>i,set:r=>{i=hs(r,t,e)}}},fc=t=>{const e={};return Y(t,i=>{const r=t[i];e[i]=hc(r[0],r[1])}),xe(e)},pc=t=>({items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:fc(t)}),ei=(t,e="-")=>t.split(/(?=[A-Z])/).map(i=>i.toLowerCase()).join(e),gc=(t,e)=>{const i={};return Y(e,r=>{i[r]={get:()=>t.getState().options[r],set:n=>{t.dispatch(`SET_${ei(r,"_").toUpperCase()}`,{value:n})}}}),i},mc=t=>(e,i,r)=>{const n={};return Y(t,s=>{const a=ei(s,"_").toUpperCase();n[`SET_${a}`]=o=>{try{r.options[s]=o.value}catch{}e(`DID_SET_${a}`,{value:r.options[s]})}}),n},Ec=t=>e=>{const i={};return Y(t,r=>{i[`GET_${ei(r,"_").toUpperCase()}`]=n=>e.options[r]}),i},Ee={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},Ji=()=>Math.random().toString(36).substring(2,11),er=(t,e)=>t.splice(e,1),Tc=(t,e)=>{e?t():document.hidden?Promise.resolve(1).then(t):setTimeout(t,0)},ti=()=>{const t=[],e=(r,n)=>{er(t,t.findIndex(s=>s.event===r&&(s.cb===n||!n)))},i=(r,n,s)=>{t.filter(a=>a.event===r).map(a=>a.cb).forEach(a=>Tc(()=>a(...n),s))};return{fireSync:(r,...n)=>{i(r,n,!0)},fire:(r,...n)=>{i(r,n,!1)},on:(r,n)=>{t.push({event:r,cb:n})},onOnce:(r,n)=>{t.push({event:r,cb:(...s)=>{e(r,n),n(...s)}})},off:e}},fs=(t,e,i)=>{Object.getOwnPropertyNames(t).filter(r=>!i.includes(r)).forEach(r=>Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r)))},Ic=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],ae=t=>{const e={};return fs(t,e,Ic),e},_c=t=>{t.forEach((e,i)=>{e.released&&er(t,i)})},F={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},Z={INPUT:1,LIMBO:2,LOCAL:3},ps=t=>/[^0-9]+/.exec(t),gs=()=>ps(1.1.toLocaleString())[0],yc=()=>{const t=gs(),e=1e3.toLocaleString(),i=1e3.toString();return e!==i?ps(e)[0]:t==="."?",":"."},b={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},tr=[],_e=(t,e,i)=>new Promise((r,n)=>{const s=tr.filter(o=>o.key===t).map(o=>o.cb);if(s.length===0){r(e);return}const a=s.shift();s.reduce((o,l)=>o.then(d=>l(d,i)),a(e,i)).then(o=>r(o)).catch(o=>n(o))}),qe=(t,e,i)=>tr.filter(r=>r.key===t).map(r=>r.cb(e,i)),vc=(t,e)=>tr.push({key:t,cb:e}),Oc=t=>Object.assign(Je,t),qt=()=>({...Je}),Rc=t=>{Y(t,(e,i)=>{Je[e]&&(Je[e][0]=hs(i,Je[e][0],Je[e][1]))})},Je={id:[null,b.STRING],name:["filepond",b.STRING],disabled:[!1,b.BOOLEAN],className:[null,b.STRING],required:[!1,b.BOOLEAN],captureMethod:[null,b.STRING],allowSyncAcceptAttribute:[!0,b.BOOLEAN],allowDrop:[!0,b.BOOLEAN],allowBrowse:[!0,b.BOOLEAN],allowPaste:[!0,b.BOOLEAN],allowMultiple:[!1,b.BOOLEAN],allowReplace:[!0,b.BOOLEAN],allowRevert:[!0,b.BOOLEAN],allowRemove:[!0,b.BOOLEAN],allowProcess:[!0,b.BOOLEAN],allowReorder:[!1,b.BOOLEAN],allowDirectoriesOnly:[!1,b.BOOLEAN],storeAsFile:[!1,b.BOOLEAN],forceRevert:[!1,b.BOOLEAN],maxFiles:[null,b.INT],checkValidity:[!1,b.BOOLEAN],itemInsertLocationFreedom:[!0,b.BOOLEAN],itemInsertLocation:["before",b.STRING],itemInsertInterval:[75,b.INT],dropOnPage:[!1,b.BOOLEAN],dropOnElement:[!0,b.BOOLEAN],dropValidation:[!1,b.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],b.ARRAY],instantUpload:[!0,b.BOOLEAN],maxParallelUploads:[2,b.INT],allowMinimumUploadDuration:[!0,b.BOOLEAN],chunkUploads:[!1,b.BOOLEAN],chunkForce:[!1,b.BOOLEAN],chunkSize:[5e6,b.INT],chunkRetryDelays:[[500,1e3,3e3],b.ARRAY],server:[null,b.SERVER_API],fileSizeBase:[1e3,b.INT],labelFileSizeBytes:["bytes",b.STRING],labelFileSizeKilobytes:["KB",b.STRING],labelFileSizeMegabytes:["MB",b.STRING],labelFileSizeGigabytes:["GB",b.STRING],labelDecimalSeparator:[gs(),b.STRING],labelThousandsSeparator:[yc(),b.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',b.STRING],labelInvalidField:["Field contains invalid files",b.STRING],labelFileWaitingForSize:["Waiting for size",b.STRING],labelFileSizeNotAvailable:["Size not available",b.STRING],labelFileCountSingular:["file in list",b.STRING],labelFileCountPlural:["files in list",b.STRING],labelFileLoading:["Loading",b.STRING],labelFileAdded:["Added",b.STRING],labelFileLoadError:["Error during load",b.STRING],labelFileRemoved:["Removed",b.STRING],labelFileRemoveError:["Error during remove",b.STRING],labelFileProcessing:["Uploading",b.STRING],labelFileProcessingComplete:["Upload complete",b.STRING],labelFileProcessingAborted:["Upload cancelled",b.STRING],labelFileProcessingError:["Error during upload",b.STRING],labelFileProcessingRevertError:["Error during revert",b.STRING],labelTapToCancel:["tap to cancel",b.STRING],labelTapToRetry:["tap to retry",b.STRING],labelTapToUndo:["tap to undo",b.STRING],labelButtonRemoveItem:["Remove",b.STRING],labelButtonAbortItemLoad:["Abort",b.STRING],labelButtonRetryItemLoad:["Retry",b.STRING],labelButtonAbortItemProcessing:["Cancel",b.STRING],labelButtonUndoItemProcessing:["Undo",b.STRING],labelButtonRetryItemProcessing:["Retry",b.STRING],labelButtonProcessItem:["Upload",b.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',b.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',b.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',b.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',b.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',b.STRING],oninit:[null,b.FUNCTION],onwarning:[null,b.FUNCTION],onerror:[null,b.FUNCTION],onactivatefile:[null,b.FUNCTION],oninitfile:[null,b.FUNCTION],onaddfilestart:[null,b.FUNCTION],onaddfileprogress:[null,b.FUNCTION],onaddfile:[null,b.FUNCTION],onprocessfilestart:[null,b.FUNCTION],onprocessfileprogress:[null,b.FUNCTION],onprocessfileabort:[null,b.FUNCTION],onprocessfilerevert:[null,b.FUNCTION],onprocessfile:[null,b.FUNCTION],onprocessfiles:[null,b.FUNCTION],onremovefile:[null,b.FUNCTION],onpreparefile:[null,b.FUNCTION],onupdatefiles:[null,b.FUNCTION],onreorderfiles:[null,b.FUNCTION],beforeDropFile:[null,b.FUNCTION],beforeAddFile:[null,b.FUNCTION],beforeRemoveFile:[null,b.FUNCTION],beforePrepareFile:[null,b.FUNCTION],stylePanelLayout:[null,b.STRING],stylePanelAspectRatio:[null,b.STRING],styleItemPanelAspectRatio:[null,b.STRING],styleButtonRemoveItemPosition:["left",b.STRING],styleButtonProcessItemPosition:["right",b.STRING],styleLoadIndicatorPosition:["right",b.STRING],styleProgressIndicatorPosition:["right",b.STRING],styleButtonRemoveItemAlign:[!1,b.BOOLEAN],files:[[],b.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],b.ARRAY]},ke=(t,e)=>Se(e)?t[0]||null:lt(e)?t[e]||null:(typeof e=="object"&&(e=e.id),t.find(i=>i.id===e)||null),ms=t=>{if(Se(t))return t;if(/:/.test(t)){const e=t.split(":");return e[1]/e[0]}return parseFloat(t)},ye=t=>t.filter(e=>!e.archived),bc={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4};let Ct=null;const wc=()=>{if(Ct===null)try{const t=new DataTransfer;t.items.add(new File(["hello world"],"This_Works.txt"));const e=document.createElement("input");e.setAttribute("type","file"),e.files=t.files,Ct=e.files.length===1}catch{Ct=!1}return Ct},Ac=[F.LOAD_ERROR,F.PROCESSING_ERROR,F.PROCESSING_REVERT_ERROR],Dc=[F.LOADING,F.PROCESSING,F.PROCESSING_QUEUED,F.INIT],Sc=[F.PROCESSING_COMPLETE],Mc=t=>Ac.includes(t.status),Cc=t=>Dc.includes(t.status),Lc=t=>Sc.includes(t.status),Wr=t=>J(t.options.server)&&(J(t.options.server.process)||Ue(t.options.server.process)),Pc=t=>({GET_STATUS:()=>{const e=ye(t.items),{EMPTY:i,ERROR:r,BUSY:n,IDLE:s,READY:a}=bc;return e.length===0?i:e.some(Mc)?r:e.some(Cc)?n:e.some(Lc)?a:s},GET_ITEM:e=>ke(t.items,e),GET_ACTIVE_ITEM:e=>ke(ye(t.items),e),GET_ACTIVE_ITEMS:()=>ye(t.items),GET_ITEMS:()=>t.items,GET_ITEM_NAME:e=>{const i=ke(t.items,e);return i?i.filename:null},GET_ITEM_SIZE:e=>{const i=ke(t.items,e);return i?i.fileSize:null},GET_STYLES:()=>Object.keys(t.options).filter(e=>/^style/.test(e)).map(e=>({name:e,value:t.options[e]})),GET_PANEL_ASPECT_RATIO:()=>/circle/.test(t.options.stylePanelLayout)?1:ms(t.options.stylePanelAspectRatio),GET_ITEM_PANEL_ASPECT_RATIO:()=>t.options.styleItemPanelAspectRatio,GET_ITEMS_BY_STATUS:e=>ye(t.items).filter(i=>i.status===e),GET_TOTAL_ITEMS:()=>ye(t.items).length,SHOULD_UPDATE_FILE_INPUT:()=>t.options.storeAsFile&&wc()&&!Wr(t),IS_ASYNC:()=>Wr(t),GET_FILE_SIZE_LABELS:e=>({labelBytes:e("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:e("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:e("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:e("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0})}),Nc=t=>{const e=ye(t.items).length;if(!t.options.allowMultiple)return e===0;const i=t.options.maxFiles;return i===null||e<i},Es=(t,e,i)=>Math.max(Math.min(i,t),e),xc=(t,e,i)=>t.splice(e,0,i),Fc=(t,e,i)=>Se(e)?null:typeof i>"u"?(t.push(e),e):(i=Es(i,0,t.length),xc(t,i,e),e),Pi=t=>/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(t),wt=t=>t.split("/").pop().split("?").shift(),ii=t=>t.split(".").pop(),Bc=t=>{if(typeof t!="string")return"";const e=t.split("/").pop();return/svg/.test(e)?"svg":/zip|compressed/.test(e)?"zip":/plain/.test(e)?"txt":/msword/.test(e)?"doc":/[a-z]+/.test(e)?e==="jpeg"?"jpg":e:""},pt=(t,e="")=>(e+t).slice(-e.length),Ts=(t=new Date)=>`${t.getFullYear()}-${pt(t.getMonth()+1,"00")}-${pt(t.getDate(),"00")}_${pt(t.getHours(),"00")}-${pt(t.getMinutes(),"00")}-${pt(t.getSeconds(),"00")}`,at=(t,e,i=null,r=null)=>{const n=typeof i=="string"?t.slice(0,t.size,i):t.slice(0,t.size,t.type);return n.lastModifiedDate=new Date,t._relativePath&&(n._relativePath=t._relativePath),ie(e)||(e=Ts()),e&&r===null&&ii(e)?n.name=e:(r=r||Bc(n.type),n.name=e+(r?"."+r:"")),n},Gc=()=>window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,Is=(t,e)=>{const i=Gc();if(i){const r=new i;return r.append(t),r.getBlob(e)}return new Blob([t],{type:e})},Vc=(t,e)=>{const i=new ArrayBuffer(t.length),r=new Uint8Array(i);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return Is(i,e)},_s=t=>(/^data:(.+);/.exec(t)||[])[1]||null,Uc=t=>t.split(",")[1].replace(/\s/g,""),kc=t=>atob(Uc(t)),$c=t=>{const e=_s(t),i=kc(t);return Vc(i,e)},Hc=(t,e,i)=>at($c(t),e,null,i),Wc=t=>{if(!/^content-disposition:/i.test(t))return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(i=>i.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(i=>i.length);return e.length?decodeURI(e[e.length-1]):null},Yc=t=>{if(/content-length:/i.test(t)){const e=t.match(/[0-9]+/)[0];return e?parseInt(e,10):null}return null},zc=t=>/x-content-transfer-id:/i.test(t)&&(t.split(":")[1]||"").trim()||null,ir=t=>{const e={source:null,name:null,size:null},i=t.split(`
`);for(let r of i){const n=Wc(r);if(n){e.name=n;continue}const s=Yc(r);if(s){e.size=s;continue}const a=zc(r);if(a){e.source=a;continue}}return e},qc=t=>{const e={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},i=()=>e.progress,r=()=>{e.request&&e.request.abort&&e.request.abort()},n=()=>{const o=e.source;a.fire("init",o),o instanceof File?a.fire("load",o):o instanceof Blob?a.fire("load",at(o,o.name)):Pi(o)?a.fire("load",Hc(o)):s(o)},s=o=>{if(!t){a.fire("error",{type:"error",body:"Can't load URL",code:400});return}e.timestamp=Date.now(),e.request=t(o,l=>{e.duration=Date.now()-e.timestamp,e.complete=!0,l instanceof Blob&&(l=at(l,l.name||wt(o))),a.fire("load",l instanceof Blob?l:l?l.body:null)},l=>{a.fire("error",typeof l=="string"?{type:"error",code:0,body:l}:l)},(l,d,c)=>{if(c&&(e.size=c),e.duration=Date.now()-e.timestamp,!l){e.progress=null;return}e.progress=d/c,a.fire("progress",e.progress)},()=>{a.fire("abort")},l=>{const d=ir(typeof l=="string"?l:l.headers);a.fire("meta",{size:e.size||d.size,filename:d.name,source:d.source})})},a={...ti(),setSource:o=>e.source=o,getProgress:i,abort:r,load:n};return a},Yr=t=>/GET|HEAD/.test(t),He=(t,e,i)=>{const r={onheaders:()=>{},onprogress:()=>{},onload:()=>{},ontimeout:()=>{},onerror:()=>{},onabort:()=>{},abort:()=>{n=!0,a.abort()}};let n=!1,s=!1;i={method:"POST",headers:{},withCredentials:!1,...i},e=encodeURI(e),Yr(i.method)&&t&&(e=`${e}${encodeURIComponent(typeof t=="string"?t:JSON.stringify(t))}`);const a=new XMLHttpRequest,o=Yr(i.method)?a:a.upload;return o.onprogress=l=>{n||r.onprogress(l.lengthComputable,l.loaded,l.total)},a.onreadystatechange=()=>{a.readyState<2||a.readyState===4&&a.status===0||s||(s=!0,r.onheaders(a))},a.onload=()=>{a.status>=200&&a.status<300?r.onload(a):r.onerror(a)},a.onerror=()=>r.onerror(a),a.onabort=()=>{n=!0,r.onabort()},a.ontimeout=()=>r.ontimeout(a),a.open(i.method,e,!0),lt(i.timeout)&&(a.timeout=i.timeout),Object.keys(i.headers).forEach(l=>{const d=unescape(encodeURIComponent(i.headers[l]));a.setRequestHeader(l,d)}),i.responseType&&(a.responseType=i.responseType),i.withCredentials&&(a.withCredentials=!0),a.send(t),r},z=(t,e,i,r)=>({type:t,code:e,body:i,headers:r}),We=t=>e=>{t(z("error",0,"Timeout",e.getAllResponseHeaders()))},zr=t=>/\?/.test(t),Tt=(...t)=>{let e="";return t.forEach(i=>{e+=zr(e)&&zr(i)?i.replace(/\?/,"&"):i}),e},oi=(t="",e)=>{if(typeof e=="function")return e;if(!e||!ie(e.url))return null;const i=e.onload||(n=>n),r=e.onerror||(n=>null);return(n,s,a,o,l,d)=>{const c=He(n,Tt(t,e.url),{...e,responseType:"blob"});return c.onload=u=>{const h=u.getAllResponseHeaders(),g=ir(h).name||wt(n);s(z("load",u.status,e.method==="HEAD"?null:at(i(u.response),g),h))},c.onerror=u=>{a(z("error",u.status,r(u.response)||u.statusText,u.getAllResponseHeaders()))},c.onheaders=u=>{d(z("headers",u.status,null,u.getAllResponseHeaders()))},c.ontimeout=We(a),c.onprogress=o,c.onabort=l,c}},he={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4},Xc=(t,e,i,r,n,s,a,o,l,d,c)=>{const u=[],{chunkTransferId:h,chunkServer:g,chunkSize:f,chunkRetryDelays:m}=c,I={serverId:h,aborted:!1},_=e.ondata||(w=>w),p=e.onload||((w,x)=>x==="HEAD"?w.getResponseHeader("Upload-Offset"):w.response),T=e.onerror||(w=>null),y=w=>{const x=new FormData;J(n)&&x.append(i,JSON.stringify(n));const O=typeof e.headers=="function"?e.headers(r,n):{...e.headers,"Upload-Length":r.size},A={...e,headers:O},L=He(_(x),Tt(t,e.url),A);L.onload=P=>w(p(P,A.method)),L.onerror=P=>a(z("error",P.status,T(P.response)||P.statusText,P.getAllResponseHeaders())),L.ontimeout=We(a)},v=w=>{const x=Tt(t,g.url,I.serverId),A={headers:typeof e.headers=="function"?e.headers(I.serverId):{...e.headers},method:"HEAD"},L=He(null,x,A);L.onload=P=>w(p(P,A.method)),L.onerror=P=>a(z("error",P.status,T(P.response)||P.statusText,P.getAllResponseHeaders())),L.ontimeout=We(a)},E=Math.floor(r.size/f);for(let w=0;w<=E;w++){const x=w*f,O=r.slice(x,x+f,"application/offset+octet-stream");u[w]={index:w,size:O.size,offset:x,data:O,file:r,progress:0,retries:[...m],status:he.QUEUED,error:null,request:null,timeout:null}}const D=()=>s(I.serverId),R=w=>w.status===he.QUEUED||w.status===he.ERROR,S=w=>{if(I.aborted)return;if(w=w||u.find(R),!w){u.every(G=>G.status===he.COMPLETE)&&D();return}w.status=he.PROCESSING,w.progress=null;const x=g.ondata||(G=>G),O=g.onerror||(G=>null),A=Tt(t,g.url,I.serverId),L=typeof g.headers=="function"?g.headers(w):{...g.headers,"Content-Type":"application/offset+octet-stream","Upload-Offset":w.offset,"Upload-Length":r.size,"Upload-Name":r.name},P=w.request=He(x(w.data),A,{...g,headers:L});P.onload=()=>{w.status=he.COMPLETE,w.request=null,C()},P.onprogress=(G,k,Ae)=>{w.progress=G?k:null,M()},P.onerror=G=>{w.status=he.ERROR,w.request=null,w.error=O(G.response)||G.statusText,N(w)||a(z("error",G.status,O(G.response)||G.statusText,G.getAllResponseHeaders()))},P.ontimeout=G=>{w.status=he.ERROR,w.request=null,N(w)||We(a)(G)},P.onabort=()=>{w.status=he.QUEUED,w.request=null,l()}},N=w=>w.retries.length===0?!1:(w.status=he.WAITING,clearTimeout(w.timeout),w.timeout=setTimeout(()=>{S(w)},w.retries.shift()),!0),M=()=>{const w=u.reduce((O,A)=>O===null||A.progress===null?null:O+A.progress,0);if(w===null)return o(!1,0,0);const x=u.reduce((O,A)=>O+A.size,0);o(!0,w,x)},C=()=>{u.filter(x=>x.status===he.PROCESSING).length>=1||S()},B=()=>{u.forEach(w=>{clearTimeout(w.timeout),w.request&&w.request.abort()})};return I.serverId?v(w=>{I.aborted||(u.filter(x=>x.offset<w).forEach(x=>{x.status=he.COMPLETE,x.progress=x.size}),C())}):y(w=>{I.aborted||(d(w),I.serverId=w,C())}),{abort:()=>{I.aborted=!0,B()}}},jc=(t,e,i,r)=>(n,s,a,o,l,d,c)=>{if(!n)return;const u=r.chunkUploads,h=u&&n.size>r.chunkSize,g=u&&(h||r.chunkForce);if(n instanceof Blob&&g)return Xc(t,e,i,n,s,a,o,l,d,c,r);const f=e.ondata||(v=>v),m=e.onload||(v=>v),I=e.onerror||(v=>null),_=typeof e.headers=="function"?e.headers(n,s)||{}:{...e.headers},p={...e,headers:_};var T=new FormData;J(s)&&T.append(i,JSON.stringify(s)),(n instanceof Blob?[{name:null,file:n}]:n).forEach(v=>{T.append(i,v.file,v.name===null?v.file.name:`${v.name}${v.file.name}`)});const y=He(f(T),Tt(t,e.url),p);return y.onload=v=>{a(z("load",v.status,m(v.response),v.getAllResponseHeaders()))},y.onerror=v=>{o(z("error",v.status,I(v.response)||v.statusText,v.getAllResponseHeaders()))},y.ontimeout=We(o),y.onprogress=l,y.onabort=d,y},Kc=(t="",e,i,r)=>typeof e=="function"?(...n)=>e(i,...n,r):!e||!ie(e.url)?null:jc(t,e,i,r),gt=(t="",e)=>{if(typeof e=="function")return e;if(!e||!ie(e.url))return(n,s)=>s();const i=e.onload||(n=>n),r=e.onerror||(n=>null);return(n,s,a)=>{const o=He(n,t+e.url,e);return o.onload=l=>{s(z("load",l.status,i(l.response),l.getAllResponseHeaders()))},o.onerror=l=>{a(z("error",l.status,r(l.response)||l.statusText,l.getAllResponseHeaders()))},o.ontimeout=We(a),o}},ys=(t=0,e=1)=>t+Math.random()*(e-t),Zc=(t,e=1e3,i=0,r=25,n=250)=>{let s=null;const a=Date.now(),o=()=>{let l=Date.now()-a,d=ys(r,n);l+d>e&&(d=l+d-e);let c=l/e;if(c>=1||document.hidden){t(1);return}t(c),s=setTimeout(o,d)};return e>0&&o(),{clear:()=>{clearTimeout(s)}}},Qc=(t,e)=>{const i={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},{allowMinimumUploadDuration:r}=e,n=(c,u)=>{const h=()=>{i.duration===0||i.progress===null||d.fire("progress",d.getProgress())},g=()=>{i.complete=!0,d.fire("load-perceived",i.response.body)};d.fire("start"),i.timestamp=Date.now(),i.perceivedPerformanceUpdater=Zc(f=>{i.perceivedProgress=f,i.perceivedDuration=Date.now()-i.timestamp,h(),i.response&&i.perceivedProgress===1&&!i.complete&&g()},r?ys(750,1500):0),i.request=t(c,u,f=>{i.response=J(f)?f:{type:"load",code:200,body:`${f}`,headers:{}},i.duration=Date.now()-i.timestamp,i.progress=1,d.fire("load",i.response.body),(!r||r&&i.perceivedProgress===1)&&g()},f=>{i.perceivedPerformanceUpdater.clear(),d.fire("error",J(f)?f:{type:"error",code:0,body:`${f}`})},(f,m,I)=>{i.duration=Date.now()-i.timestamp,i.progress=f?m/I:null,h()},()=>{i.perceivedPerformanceUpdater.clear(),d.fire("abort",i.response?i.response.body:null)},f=>{d.fire("transfer",f)})},s=()=>{i.request&&(i.perceivedPerformanceUpdater.clear(),i.request.abort&&i.request.abort(),i.complete=!0)},a=()=>{s(),i.complete=!1,i.perceivedProgress=0,i.progress=0,i.timestamp=null,i.perceivedDuration=0,i.duration=0,i.request=null,i.response=null},o=r?()=>i.progress?Math.min(i.progress,i.perceivedProgress):null:()=>i.progress||null,l=r?()=>Math.min(i.duration,i.perceivedDuration):()=>i.duration,d={...ti(),process:n,abort:s,getProgress:o,getDuration:l,reset:a};return d},vs=t=>t.substring(0,t.lastIndexOf("."))||t,Jc=t=>{let e=[t.name,t.size,t.type];return t instanceof Blob||Pi(t)?e[0]=t.name||Ts():Pi(t)?(e[1]=t.length,e[2]=_s(t)):ie(t)&&(e[0]=wt(t),e[1]=0,e[2]="application/octet-stream"),{name:e[0],size:e[1],type:e[2]}},ot=t=>!!(t instanceof File||t instanceof Blob&&t.name),Os=t=>{if(!J(t))return t;const e=Qt(t)?[]:{};for(const i in t){if(!t.hasOwnProperty(i))continue;const r=t[i];e[i]=r&&J(r)?Os(r):r}return e},ed=(t=null,e=null,i=null)=>{const r=Ji(),n={archived:!1,frozen:!1,released:!1,source:null,file:i,serverFileReference:e,transferId:null,processingAborted:!1,status:e?F.PROCESSING_COMPLETE:F.INIT,activeLoader:null,activeProcessor:null};let s=null;const a={},o=R=>n.status=R,l=(R,...S)=>{n.released||n.frozen||E.fire(R,...S)},d=()=>ii(n.file.name),c=()=>n.file.type,u=()=>n.file.size,h=()=>n.file,g=(R,S,N)=>{if(n.source=R,E.fireSync("init"),n.file){E.fireSync("load-skip");return}n.file=Jc(R),S.on("init",()=>{l("load-init")}),S.on("meta",M=>{n.file.size=M.size,n.file.filename=M.filename,M.source&&(t=Z.LIMBO,n.serverFileReference=M.source,n.status=F.PROCESSING_COMPLETE),l("load-meta")}),S.on("progress",M=>{o(F.LOADING),l("load-progress",M)}),S.on("error",M=>{o(F.LOAD_ERROR),l("load-request-error",M)}),S.on("abort",()=>{o(F.INIT),l("load-abort")}),S.on("load",M=>{n.activeLoader=null;const C=w=>{n.file=ot(w)?w:n.file,t===Z.LIMBO&&n.serverFileReference?o(F.PROCESSING_COMPLETE):o(F.IDLE),l("load")},B=w=>{n.file=M,l("load-meta"),o(F.LOAD_ERROR),l("load-file-error",w)};if(n.serverFileReference){C(M);return}N(M,C,B)}),S.setSource(R),n.activeLoader=S,S.load()},f=()=>{n.activeLoader&&n.activeLoader.load()},m=()=>{if(n.activeLoader){n.activeLoader.abort();return}o(F.INIT),l("load-abort")},I=(R,S)=>{if(n.processingAborted){n.processingAborted=!1;return}if(o(F.PROCESSING),s=null,!(n.file instanceof Blob)){E.on("load",()=>{I(R,S)});return}R.on("load",C=>{n.transferId=null,n.serverFileReference=C}),R.on("transfer",C=>{n.transferId=C}),R.on("load-perceived",C=>{n.activeProcessor=null,n.transferId=null,n.serverFileReference=C,o(F.PROCESSING_COMPLETE),l("process-complete",C)}),R.on("start",()=>{l("process-start")}),R.on("error",C=>{n.activeProcessor=null,o(F.PROCESSING_ERROR),l("process-error",C)}),R.on("abort",C=>{n.activeProcessor=null,n.serverFileReference=C,o(F.IDLE),l("process-abort"),s&&s()}),R.on("progress",C=>{l("process-progress",C)});const N=C=>{n.archived||R.process(C,{...a})},M=console.error;S(n.file,N,M),n.activeProcessor=R},_=()=>{n.processingAborted=!1,o(F.PROCESSING_QUEUED)},p=()=>new Promise(R=>{if(!n.activeProcessor){n.processingAborted=!0,o(F.IDLE),l("process-abort"),R();return}s=()=>{R()},n.activeProcessor.abort()}),T=(R,S)=>new Promise((N,M)=>{const C=n.serverFileReference!==null?n.serverFileReference:n.transferId;if(C===null){N();return}R(C,()=>{n.serverFileReference=null,n.transferId=null,N()},B=>{if(!S){N();return}o(F.PROCESSING_REVERT_ERROR),l("process-revert-error"),M(B)}),o(F.IDLE),l("process-revert")}),y=(R,S,N)=>{const M=R.split("."),C=M[0],B=M.pop();let w=a;M.forEach(x=>w=w[x]),JSON.stringify(w[B])!==JSON.stringify(S)&&(w[B]=S,l("metadata-update",{key:C,value:a[C],silent:N}))},E={id:{get:()=>r},origin:{get:()=>t,set:R=>t=R},serverId:{get:()=>n.serverFileReference},transferId:{get:()=>n.transferId},status:{get:()=>n.status},filename:{get:()=>n.file.name},filenameWithoutExtension:{get:()=>vs(n.file.name)},fileExtension:{get:d},fileType:{get:c},fileSize:{get:u},file:{get:h},relativePath:{get:()=>n.file._relativePath},source:{get:()=>n.source},getMetadata:R=>Os(R?a[R]:a),setMetadata:(R,S,N)=>{if(J(R)){const M=R;return Object.keys(M).forEach(C=>{y(C,M[C],S)}),R}return y(R,S,N),S},extend:(R,S)=>D[R]=S,abortLoad:m,retryLoad:f,requestProcessing:_,abortProcessing:p,load:g,process:I,revert:T,...ti(),freeze:()=>n.frozen=!0,release:()=>n.released=!0,released:{get:()=>n.released},archive:()=>n.archived=!0,archived:{get:()=>n.archived}},D=xe(E);return D},td=(t,e)=>Se(e)?0:ie(e)?t.findIndex(i=>i.id===e):-1,qr=(t,e)=>{const i=td(t,e);if(!(i<0))return t[i]||null},Xr=(t,e,i,r,n,s)=>{const a=He(null,t,{method:"GET",responseType:"blob"});return a.onload=o=>{const l=o.getAllResponseHeaders(),d=ir(l).name||wt(t);e(z("load",o.status,at(o.response,d),l))},a.onerror=o=>{i(z("error",o.status,o.statusText,o.getAllResponseHeaders()))},a.onheaders=o=>{s(z("headers",o.status,null,o.getAllResponseHeaders()))},a.ontimeout=We(i),a.onprogress=r,a.onabort=n,a},jr=t=>(t.indexOf("//")===0&&(t=location.protocol+t),t.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]),id=t=>(t.indexOf(":")>-1||t.indexOf("//")>-1)&&jr(location.href)!==jr(t),Lt=t=>(...e)=>Ue(t)?t(...e):t,rd=t=>!ot(t.file),li=(t,e)=>{clearTimeout(e.listUpdateTimeout),e.listUpdateTimeout=setTimeout(()=>{t("DID_UPDATE_ITEMS",{items:ye(e.items)})},0)},Kr=(t,...e)=>new Promise(i=>{if(!t)return i(!0);const r=t(...e);if(r==null)return i(!0);if(typeof r=="boolean")return i(r);typeof r.then=="function"&&r.then(i)}),ci=(t,e)=>{t.items.sort((i,r)=>e(ae(i),ae(r)))},fe=(t,e)=>({query:i,success:r=()=>{},failure:n=()=>{},...s}={})=>{const a=ke(t.items,i);if(!a){n({error:z("error",0,"Item not found"),file:null});return}e(a,r,n,s||{})},nd=(t,e,i)=>({ABORT_ALL:()=>{ye(i.items).forEach(r=>{r.freeze(),r.abortLoad(),r.abortProcessing()})},DID_SET_FILES:({value:r=[]})=>{const n=r.map(a=>({source:a.source?a.source:a,options:a.options}));let s=ye(i.items);s.forEach(a=>{n.find(o=>o.source===a.source||o.source===a.file)||t("REMOVE_ITEM",{query:a,remove:!1})}),s=ye(i.items),n.forEach((a,o)=>{s.find(l=>l.source===a.source||l.file===a.source)||t("ADD_ITEM",{...a,interactionMethod:Ee.NONE,index:o})})},DID_UPDATE_ITEM_METADATA:({id:r,action:n,change:s})=>{s.silent||(clearTimeout(i.itemUpdateTimeout),i.itemUpdateTimeout=setTimeout(()=>{const a=qr(i.items,r);if(!e("IS_ASYNC")){_e("SHOULD_PREPARE_OUTPUT",!1,{item:a,query:e,action:n,change:s}).then(c=>{const u=e("GET_BEFORE_PREPARE_FILE");u&&(c=u(a,c)),c&&t("REQUEST_PREPARE_OUTPUT",{query:r,item:a,success:h=>{t("DID_PREPARE_OUTPUT",{id:r,file:h})}},!0)});return}a.origin===Z.LOCAL&&t("DID_LOAD_ITEM",{id:a.id,error:null,serverFileReference:a.source});const o=()=>{setTimeout(()=>{t("REQUEST_ITEM_PROCESSING",{query:r})},32)},l=c=>{a.revert(gt(i.options.server.url,i.options.server.revert),e("GET_FORCE_REVERT")).then(c?o:()=>{}).catch(()=>{})},d=c=>{a.abortProcessing().then(c?o:()=>{})};if(a.status===F.PROCESSING_COMPLETE)return l(i.options.instantUpload);if(a.status===F.PROCESSING)return d(i.options.instantUpload);i.options.instantUpload&&o()},0))},MOVE_ITEM:({query:r,index:n})=>{const s=ke(i.items,r);if(!s)return;const a=i.items.indexOf(s);n=Es(n,0,i.items.length-1),a!==n&&i.items.splice(n,0,i.items.splice(a,1)[0])},SORT:({compare:r})=>{ci(i,r),t("DID_SORT_ITEMS",{items:e("GET_ACTIVE_ITEMS")})},ADD_ITEMS:({items:r,index:n,interactionMethod:s,success:a=()=>{},failure:o=()=>{}})=>{let l=n;if(n===-1||typeof n>"u"){const g=e("GET_ITEM_INSERT_LOCATION"),f=e("GET_TOTAL_ITEMS");l=g==="before"?0:f}const d=e("GET_IGNORED_FILES"),c=g=>ot(g)?!d.includes(g.name.toLowerCase()):!Se(g),h=r.filter(c).map(g=>new Promise((f,m)=>{t("ADD_ITEM",{interactionMethod:s,source:g.source||g,success:f,failure:m,index:l++,options:g.options||{}})}));Promise.all(h).then(a).catch(o)},ADD_ITEM:({source:r,index:n=-1,interactionMethod:s,success:a=()=>{},failure:o=()=>{},options:l={}})=>{if(Se(r)){o({error:z("error",0,"No source"),file:null});return}if(ot(r)&&i.options.ignoredFiles.includes(r.name.toLowerCase()))return;if(!Nc(i)){if(i.options.allowMultiple||!i.options.allowMultiple&&!i.options.allowReplace){const p=z("warning",0,"Max files");t("DID_THROW_MAX_FILES",{source:r,error:p}),o({error:p,file:null});return}const _=ye(i.items)[0];if(_.status===F.PROCESSING_COMPLETE||_.status===F.PROCESSING_REVERT_ERROR){const p=e("GET_FORCE_REVERT");if(_.revert(gt(i.options.server.url,i.options.server.revert),p).then(()=>{p&&t("ADD_ITEM",{source:r,index:n,interactionMethod:s,success:a,failure:o,options:l})}).catch(()=>{}),p)return}t("REMOVE_ITEM",{query:_.id})}const d=l.type==="local"?Z.LOCAL:l.type==="limbo"?Z.LIMBO:Z.INPUT,c=ed(d,d===Z.INPUT?null:r,l.file);Object.keys(l.metadata||{}).forEach(_=>{c.setMetadata(_,l.metadata[_])}),qe("DID_CREATE_ITEM",c,{query:e,dispatch:t});const u=e("GET_ITEM_INSERT_LOCATION");i.options.itemInsertLocationFreedom||(n=u==="before"?-1:i.items.length),Fc(i.items,c,n),Ue(u)&&r&&ci(i,u);const h=c.id;c.on("init",()=>{t("DID_INIT_ITEM",{id:h})}),c.on("load-init",()=>{t("DID_START_ITEM_LOAD",{id:h})}),c.on("load-meta",()=>{t("DID_UPDATE_ITEM_META",{id:h})}),c.on("load-progress",_=>{t("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:h,progress:_})}),c.on("load-request-error",_=>{const p=Lt(i.options.labelFileLoadError)(_);if(_.code>=400&&_.code<500){t("DID_THROW_ITEM_INVALID",{id:h,error:_,status:{main:p,sub:`${_.code} (${_.body})`}}),o({error:_,file:ae(c)});return}t("DID_THROW_ITEM_LOAD_ERROR",{id:h,error:_,status:{main:p,sub:i.options.labelTapToRetry}})}),c.on("load-file-error",_=>{t("DID_THROW_ITEM_INVALID",{id:h,error:_.status,status:_.status}),o({error:_.status,file:ae(c)})}),c.on("load-abort",()=>{t("REMOVE_ITEM",{query:h})}),c.on("load-skip",()=>{t("COMPLETE_LOAD_ITEM",{query:h,item:c,data:{source:r,success:a}})}),c.on("load",()=>{const _=p=>{if(!p){t("REMOVE_ITEM",{query:h});return}c.on("metadata-update",T=>{t("DID_UPDATE_ITEM_METADATA",{id:h,change:T})}),_e("SHOULD_PREPARE_OUTPUT",!1,{item:c,query:e}).then(T=>{const y=e("GET_BEFORE_PREPARE_FILE");y&&(T=y(c,T));const v=()=>{t("COMPLETE_LOAD_ITEM",{query:h,item:c,data:{source:r,success:a}}),li(t,i)};if(T){t("REQUEST_PREPARE_OUTPUT",{query:h,item:c,success:E=>{t("DID_PREPARE_OUTPUT",{id:h,file:E}),v()}},!0);return}v()})};_e("DID_LOAD_ITEM",c,{query:e,dispatch:t}).then(()=>{Kr(e("GET_BEFORE_ADD_FILE"),ae(c)).then(_)}).catch(p=>{if(!p||!p.error||!p.status)return _(!1);t("DID_THROW_ITEM_INVALID",{id:h,error:p.error,status:p.status})})}),c.on("process-start",()=>{t("DID_START_ITEM_PROCESSING",{id:h})}),c.on("process-progress",_=>{t("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:h,progress:_})}),c.on("process-error",_=>{t("DID_THROW_ITEM_PROCESSING_ERROR",{id:h,error:_,status:{main:Lt(i.options.labelFileProcessingError)(_),sub:i.options.labelTapToRetry}})}),c.on("process-revert-error",_=>{t("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:h,error:_,status:{main:Lt(i.options.labelFileProcessingRevertError)(_),sub:i.options.labelTapToRetry}})}),c.on("process-complete",_=>{t("DID_COMPLETE_ITEM_PROCESSING",{id:h,error:null,serverFileReference:_}),t("DID_DEFINE_VALUE",{id:h,value:_})}),c.on("process-abort",()=>{t("DID_ABORT_ITEM_PROCESSING",{id:h})}),c.on("process-revert",()=>{t("DID_REVERT_ITEM_PROCESSING",{id:h}),t("DID_DEFINE_VALUE",{id:h,value:null})}),t("DID_ADD_ITEM",{id:h,index:n,interactionMethod:s}),li(t,i);const{url:g,load:f,restore:m,fetch:I}=i.options.server||{};c.load(r,qc(d===Z.INPUT?ie(r)&&id(r)&&I?oi(g,I):Xr:d===Z.LIMBO?oi(g,m):oi(g,f)),(_,p,T)=>{_e("LOAD_FILE",_,{query:e}).then(p).catch(T)})},REQUEST_PREPARE_OUTPUT:({item:r,success:n,failure:s=()=>{}})=>{const a={error:z("error",0,"Item not found"),file:null};if(r.archived)return s(a);_e("PREPARE_OUTPUT",r.file,{query:e,item:r}).then(o=>{_e("COMPLETE_PREPARE_OUTPUT",o,{query:e,item:r}).then(l=>{if(r.archived)return s(a);n(l)})})},COMPLETE_LOAD_ITEM:({item:r,data:n})=>{const{success:s,source:a}=n,o=e("GET_ITEM_INSERT_LOCATION");if(Ue(o)&&a&&ci(i,o),t("DID_LOAD_ITEM",{id:r.id,error:null,serverFileReference:r.origin===Z.INPUT?null:a}),s(ae(r)),r.origin===Z.LOCAL){t("DID_LOAD_LOCAL_ITEM",{id:r.id});return}if(r.origin===Z.LIMBO){t("DID_COMPLETE_ITEM_PROCESSING",{id:r.id,error:null,serverFileReference:a}),t("DID_DEFINE_VALUE",{id:r.id,value:r.serverId||a});return}e("IS_ASYNC")&&i.options.instantUpload&&t("REQUEST_ITEM_PROCESSING",{query:r.id})},RETRY_ITEM_LOAD:fe(i,r=>{r.retryLoad()}),REQUEST_ITEM_PREPARE:fe(i,(r,n,s)=>{t("REQUEST_PREPARE_OUTPUT",{query:r.id,item:r,success:a=>{t("DID_PREPARE_OUTPUT",{id:r.id,file:a}),n({file:r,output:a})},failure:s},!0)}),REQUEST_ITEM_PROCESSING:fe(i,(r,n,s)=>{if(!(r.status===F.IDLE||r.status===F.PROCESSING_ERROR)){const o=()=>t("REQUEST_ITEM_PROCESSING",{query:r,success:n,failure:s}),l=()=>document.hidden?o():setTimeout(o,32);r.status===F.PROCESSING_COMPLETE||r.status===F.PROCESSING_REVERT_ERROR?r.revert(gt(i.options.server.url,i.options.server.revert),e("GET_FORCE_REVERT")).then(l).catch(()=>{}):r.status===F.PROCESSING&&r.abortProcessing().then(l);return}r.status!==F.PROCESSING_QUEUED&&(r.requestProcessing(),t("DID_REQUEST_ITEM_PROCESSING",{id:r.id}),t("PROCESS_ITEM",{query:r,success:n,failure:s},!0))}),PROCESS_ITEM:fe(i,(r,n,s)=>{const a=e("GET_MAX_PARALLEL_UPLOADS");if(e("GET_ITEMS_BY_STATUS",F.PROCESSING).length===a){i.processingQueue.push({id:r.id,success:n,failure:s});return}if(r.status===F.PROCESSING)return;const l=()=>{const c=i.processingQueue.shift();if(!c)return;const{id:u,success:h,failure:g}=c,f=ke(i.items,u);if(!f||f.archived){l();return}t("PROCESS_ITEM",{query:u,success:h,failure:g},!0)};r.onOnce("process-complete",()=>{n(ae(r)),l();const c=i.options.server;if(i.options.instantUpload&&r.origin===Z.LOCAL&&Ue(c.remove)){const g=()=>{};r.origin=Z.LIMBO,i.options.server.remove(r.source,g,g)}e("GET_ITEMS_BY_STATUS",F.PROCESSING_COMPLETE).length===i.items.length&&t("DID_COMPLETE_ITEM_PROCESSING_ALL")}),r.onOnce("process-error",c=>{s({error:c,file:ae(r)}),l()});const d=i.options;r.process(Qc(Kc(d.server.url,d.server.process,d.name,{chunkTransferId:r.transferId,chunkServer:d.server.patch,chunkUploads:d.chunkUploads,chunkForce:d.chunkForce,chunkSize:d.chunkSize,chunkRetryDelays:d.chunkRetryDelays}),{allowMinimumUploadDuration:e("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(c,u,h)=>{_e("PREPARE_OUTPUT",c,{query:e,item:r}).then(g=>{t("DID_PREPARE_OUTPUT",{id:r.id,file:g}),u(g)}).catch(h)})}),RETRY_ITEM_PROCESSING:fe(i,r=>{t("REQUEST_ITEM_PROCESSING",{query:r})}),REQUEST_REMOVE_ITEM:fe(i,r=>{Kr(e("GET_BEFORE_REMOVE_FILE"),ae(r)).then(n=>{n&&t("REMOVE_ITEM",{query:r})})}),RELEASE_ITEM:fe(i,r=>{r.release()}),REMOVE_ITEM:fe(i,(r,n,s,a)=>{const o=()=>{const d=r.id;qr(i.items,d).archive(),t("DID_REMOVE_ITEM",{error:null,id:d,item:r}),li(t,i),n(ae(r))},l=i.options.server;r.origin===Z.LOCAL&&l&&Ue(l.remove)&&a.remove!==!1?(t("DID_START_ITEM_REMOVE",{id:r.id}),l.remove(r.source,()=>o(),d=>{t("DID_THROW_ITEM_REMOVE_ERROR",{id:r.id,error:z("error",0,d,null),status:{main:Lt(i.options.labelFileRemoveError)(d),sub:i.options.labelTapToRetry}})})):((a.revert&&r.origin!==Z.LOCAL&&r.serverId!==null||i.options.chunkUploads&&r.file.size>i.options.chunkSize||i.options.chunkUploads&&i.options.chunkForce)&&r.revert(gt(i.options.server.url,i.options.server.revert),e("GET_FORCE_REVERT")),o())}),ABORT_ITEM_LOAD:fe(i,r=>{r.abortLoad()}),ABORT_ITEM_PROCESSING:fe(i,r=>{if(r.serverId){t("REVERT_ITEM_PROCESSING",{id:r.id});return}r.abortProcessing().then(()=>{i.options.instantUpload&&t("REMOVE_ITEM",{query:r.id})})}),REQUEST_REVERT_ITEM_PROCESSING:fe(i,r=>{if(!i.options.instantUpload){t("REVERT_ITEM_PROCESSING",{query:r});return}const n=o=>{o&&t("REVERT_ITEM_PROCESSING",{query:r})},s=e("GET_BEFORE_REMOVE_FILE");if(!s)return n(!0);const a=s(ae(r));if(a==null)return n(!0);if(typeof a=="boolean")return n(a);typeof a.then=="function"&&a.then(n)}),REVERT_ITEM_PROCESSING:fe(i,r=>{r.revert(gt(i.options.server.url,i.options.server.revert),e("GET_FORCE_REVERT")).then(()=>{(i.options.instantUpload||rd(r))&&t("REMOVE_ITEM",{query:r.id})}).catch(()=>{})}),SET_OPTIONS:({options:r})=>{const n=Object.keys(r),s=sd.filter(o=>n.includes(o));[...s,...Object.keys(r).filter(o=>!s.includes(o))].forEach(o=>{t(`SET_${ei(o,"_").toUpperCase()}`,{value:r[o]})})}}),sd=["server"],rr=t=>t,Me=t=>document.createElement(t),q=(t,e)=>{let i=t.childNodes[0];i?e!==i.nodeValue&&(i.nodeValue=e):(i=document.createTextNode(e),t.appendChild(i))},Zr=(t,e,i,r)=>{const n=(r%360-90)*Math.PI/180;return{x:t+i*Math.cos(n),y:e+i*Math.sin(n)}},ad=(t,e,i,r,n,s)=>{const a=Zr(t,e,i,n),o=Zr(t,e,i,r);return["M",a.x,a.y,"A",i,i,0,s,0,o.x,o.y].join(" ")},od=(t,e,i,r,n)=>{let s=1;return n>r&&n-r<=.5&&(s=0),r>n&&r-n>=.5&&(s=0),ad(t,e,i,Math.min(.9999,r)*360,Math.min(.9999,n)*360,s)},ld=({root:t,props:e})=>{e.spin=!1,e.progress=0,e.opacity=0;const i=zt("svg");t.ref.path=zt("path",{"stroke-width":2,"stroke-linecap":"round"}),i.appendChild(t.ref.path),t.ref.svg=i,t.appendChild(i)},cd=({root:t,props:e})=>{if(e.opacity===0)return;e.align&&(t.element.dataset.align=e.align);const i=parseInt(j(t.ref.path,"stroke-width"),10),r=t.rect.element.width*.5;let n=0,s=0;e.spin?(n=0,s=.5):(n=0,s=e.progress);const a=od(r,r,r-i,n,s);j(t.ref.path,"d",a),j(t.ref.path,"stroke-opacity",e.spin||e.progress>0?1:0)},Qr=K({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:ld,write:cd,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),dd=({root:t,props:e})=>{t.element.innerHTML=(e.icon||"")+`<span>${e.label}</span>`,e.isDisabled=!1},ud=({root:t,props:e})=>{const{isDisabled:i}=e,r=t.query("GET_DISABLED")||e.opacity===0;r&&!i?(e.isDisabled=!0,j(t.element,"disabled","disabled")):!r&&i&&(e.isDisabled=!1,t.element.removeAttribute("disabled"))},Rs=K({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:dd,write:ud}),bs=(t,e=".",i=1e3,r={})=>{const{labelBytes:n="bytes",labelKilobytes:s="KB",labelMegabytes:a="MB",labelGigabytes:o="GB"}=r;t=Math.round(Math.abs(t));const l=i,d=i*i,c=i*i*i;return t<l?`${t} ${n}`:t<d?`${Math.floor(t/l)} ${s}`:t<c?`${Jr(t/d,1,e)} ${a}`:`${Jr(t/c,2,e)} ${o}`},Jr=(t,e,i)=>t.toFixed(e).split(".").filter(r=>r!=="0").join(i),hd=({root:t,props:e})=>{const i=Me("span");i.className="filepond--file-info-main",j(i,"aria-hidden","true"),t.appendChild(i),t.ref.fileName=i;const r=Me("span");r.className="filepond--file-info-sub",t.appendChild(r),t.ref.fileSize=r,q(r,t.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),q(i,rr(t.query("GET_ITEM_NAME",e.id)))},Ni=({root:t,props:e})=>{q(t.ref.fileSize,bs(t.query("GET_ITEM_SIZE",e.id),".",t.query("GET_FILE_SIZE_BASE"),t.query("GET_FILE_SIZE_LABELS",t.query))),q(t.ref.fileName,rr(t.query("GET_ITEM_NAME",e.id)))},en=({root:t,props:e})=>{if(lt(t.query("GET_ITEM_SIZE",e.id))){Ni({root:t,props:e});return}q(t.ref.fileSize,t.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},fd=K({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:re({DID_LOAD_ITEM:Ni,DID_UPDATE_ITEM_META:Ni,DID_THROW_ITEM_LOAD_ERROR:en,DID_THROW_ITEM_INVALID:en}),didCreateView:t=>{qe("CREATE_VIEW",{...t,view:t})},create:hd,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),ws=t=>Math.round(t*100),pd=({root:t})=>{const e=Me("span");e.className="filepond--file-status-main",t.appendChild(e),t.ref.main=e;const i=Me("span");i.className="filepond--file-status-sub",t.appendChild(i),t.ref.sub=i,As({root:t,action:{progress:null}})},As=({root:t,action:e})=>{const i=e.progress===null?t.query("GET_LABEL_FILE_LOADING"):`${t.query("GET_LABEL_FILE_LOADING")} ${ws(e.progress)}%`;q(t.ref.main,i),q(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},gd=({root:t,action:e})=>{const i=e.progress===null?t.query("GET_LABEL_FILE_PROCESSING"):`${t.query("GET_LABEL_FILE_PROCESSING")} ${ws(e.progress)}%`;q(t.ref.main,i),q(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},md=({root:t})=>{q(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING")),q(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},Ed=({root:t})=>{q(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_ABORTED")),q(t.ref.sub,t.query("GET_LABEL_TAP_TO_RETRY"))},Td=({root:t})=>{q(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),q(t.ref.sub,t.query("GET_LABEL_TAP_TO_UNDO"))},tn=({root:t})=>{q(t.ref.main,""),q(t.ref.sub,"")},mt=({root:t,action:e})=>{q(t.ref.main,e.status.main),q(t.ref.sub,e.status.sub)},Id=K({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:re({DID_LOAD_ITEM:tn,DID_REVERT_ITEM_PROCESSING:tn,DID_REQUEST_ITEM_PROCESSING:md,DID_ABORT_ITEM_PROCESSING:Ed,DID_COMPLETE_ITEM_PROCESSING:Td,DID_UPDATE_ITEM_PROCESS_PROGRESS:gd,DID_UPDATE_ITEM_LOAD_PROGRESS:As,DID_THROW_ITEM_LOAD_ERROR:mt,DID_THROW_ITEM_INVALID:mt,DID_THROW_ITEM_PROCESSING_ERROR:mt,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:mt,DID_THROW_ITEM_REMOVE_ERROR:mt}),didCreateView:t=>{qe("CREATE_VIEW",{...t,view:t})},create:pd,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),xi={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},Fi=[];Y(xi,t=>{Fi.push(t)});const ue=t=>{if(Bi(t)==="right")return 0;const e=t.ref.buttonRemoveItem.rect.element;return e.hidden?null:e.width+e.left},_d=t=>t.ref.buttonAbortItemLoad.rect.element.width,Pt=t=>Math.floor(t.ref.buttonRemoveItem.rect.element.height/4),yd=t=>Math.floor(t.ref.buttonRemoveItem.rect.element.left/2),vd=t=>t.query("GET_STYLE_LOAD_INDICATOR_POSITION"),Od=t=>t.query("GET_STYLE_PROGRESS_INDICATOR_POSITION"),Bi=t=>t.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION"),Rd={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:vd},processProgressIndicator:{opacity:0,align:Od},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},rn={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:ue},status:{translateX:ue}},di={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},et={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:ue},status:{translateX:ue,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:ue},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:Bi},info:{translateX:ue},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:Bi},buttonRemoveItem:{opacity:1},info:{translateX:ue},status:{opacity:1,translateX:ue}},DID_LOAD_ITEM:rn,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:ue},status:{translateX:ue}},DID_START_ITEM_PROCESSING:di,DID_REQUEST_ITEM_PROCESSING:di,DID_UPDATE_ITEM_PROCESS_PROGRESS:di,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:ue}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:ue},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:rn},bd=K({create:({root:t})=>{t.element.innerHTML=t.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),wd=({root:t,props:e})=>{const i=Object.keys(xi).reduce((f,m)=>(f[m]={...xi[m]},f),{}),{id:r}=e,n=t.query("GET_ALLOW_REVERT"),s=t.query("GET_ALLOW_REMOVE"),a=t.query("GET_ALLOW_PROCESS"),o=t.query("GET_INSTANT_UPLOAD"),l=t.query("IS_ASYNC"),d=t.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");let c;l?a&&!n?c=f=>!/RevertItemProcessing/.test(f):!a&&n?c=f=>!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(f):!a&&!n&&(c=f=>!/Process/.test(f)):c=f=>!/Process/.test(f);const u=c?Fi.filter(c):Fi.concat();if(o&&n&&(i.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",i.RevertItemProcessing.icon="GET_ICON_REMOVE"),l&&!n){const f=et.DID_COMPLETE_ITEM_PROCESSING;f.info.translateX=yd,f.info.translateY=Pt,f.status.translateY=Pt,f.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(l&&!a&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(f=>{et[f].status.translateY=Pt}),et.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=_d),d&&n){i.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";const f=et.DID_COMPLETE_ITEM_PROCESSING;f.info.translateX=ue,f.status.translateY=Pt,f.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}s||(i.RemoveItem.disabled=!0),Y(i,(f,m)=>{const I=t.createChildView(Rs,{label:t.query(m.label),icon:t.query(m.icon),opacity:0});u.includes(f)&&t.appendChildView(I),m.disabled&&(I.element.setAttribute("disabled","disabled"),I.element.setAttribute("hidden","hidden")),I.element.dataset.align=t.query(`GET_STYLE_${m.align}`),I.element.classList.add(m.className),I.on("click",_=>{_.stopPropagation(),!m.disabled&&t.dispatch(m.action,{query:r})}),t.ref[`button${f}`]=I}),t.ref.processingCompleteIndicator=t.appendChildView(t.createChildView(bd)),t.ref.processingCompleteIndicator.element.dataset.align=t.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),t.ref.info=t.appendChildView(t.createChildView(fd,{id:r})),t.ref.status=t.appendChildView(t.createChildView(Id,{id:r}));const h=t.appendChildView(t.createChildView(Qr,{opacity:0,align:t.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));h.element.classList.add("filepond--load-indicator"),t.ref.loadProgressIndicator=h;const g=t.appendChildView(t.createChildView(Qr,{opacity:0,align:t.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));g.element.classList.add("filepond--process-indicator"),t.ref.processProgressIndicator=g,t.ref.activeStyles=[]},Ad=({root:t,actions:e,props:i})=>{Dd({root:t,actions:e,props:i});let r=e.concat().filter(n=>/^DID_/.test(n.type)).reverse().find(n=>et[n.type]);if(r){t.ref.activeStyles=[];const n=et[r.type];Y(Rd,(s,a)=>{const o=t.ref[s];Y(a,(l,d)=>{const c=n[s]&&typeof n[s][l]<"u"?n[s][l]:d;t.ref.activeStyles.push({control:o,key:l,value:c})})})}t.ref.activeStyles.forEach(({control:n,key:s,value:a})=>{n[s]=typeof a=="function"?a(t):a})},Dd=re({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:({root:t,action:e})=>{t.ref.buttonAbortItemProcessing.label=e.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:({root:t,action:e})=>{t.ref.buttonAbortItemLoad.label=e.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:({root:t,action:e})=>{t.ref.buttonAbortItemRemoval.label=e.value},DID_REQUEST_ITEM_PROCESSING:({root:t})=>{t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:({root:t})=>{t.ref.loadProgressIndicator.spin=!0,t.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:({root:t})=>{t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:({root:t,action:e})=>{t.ref.loadProgressIndicator.spin=!1,t.ref.loadProgressIndicator.progress=e.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:({root:t,action:e})=>{t.ref.processProgressIndicator.spin=!1,t.ref.processProgressIndicator.progress=e.progress}}),Sd=K({create:wd,write:Ad,didCreateView:t=>{qe("CREATE_VIEW",{...t,view:t})},name:"file"}),Md=({root:t,props:e})=>{t.ref.fileName=Me("legend"),t.appendChild(t.ref.fileName),t.ref.file=t.appendChildView(t.createChildView(Sd,{id:e.id})),t.ref.data=!1},Cd=({root:t,props:e})=>{q(t.ref.fileName,rr(t.query("GET_ITEM_NAME",e.id)))},Ld=K({create:Md,ignoreRect:!0,write:re({DID_LOAD_ITEM:Cd}),didCreateView:t=>{qe("CREATE_VIEW",{...t,view:t})},tag:"fieldset",name:"file-wrapper"}),nn={type:"spring",damping:.6,mass:7},Pd=({root:t,props:e})=>{[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:nn},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:nn},styles:["translateY"]}}].forEach(i=>{Nd(t,i,e.name)}),t.element.classList.add(`filepond--${e.name}`),t.ref.scalable=null},Nd=(t,e,i)=>{const r=K({name:`panel-${e.name} filepond--${i}`,mixins:e.mixins,ignoreRectUpdate:!0}),n=t.createChildView(r,e.props);t.ref[e.name]=t.appendChildView(n)},xd=({root:t,props:e})=>{if((t.ref.scalable===null||e.scalable!==t.ref.scalable)&&(t.ref.scalable=cs(e.scalable)?e.scalable:!0,t.element.dataset.scalable=t.ref.scalable),!e.height)return;const i=t.ref.top.rect.element,r=t.ref.bottom.rect.element,n=Math.max(i.height+r.height,e.height);t.ref.center.translateY=i.height,t.ref.center.scaleY=(n-i.height-r.height)/100,t.ref.bottom.translateY=n-r.height},Ds=K({name:"panel",read:({root:t,props:e})=>e.heightCurrent=t.ref.bottom.translateY,write:xd,create:Pd,ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),Fd=t=>{const e=t.map(r=>r.id);let i;return{setIndex:r=>{i=r},getIndex:()=>i,getItemIndex:r=>e.indexOf(r.id)}},sn={type:"spring",stiffness:.75,damping:.45,mass:10},an="spring",on={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},Bd=({root:t,props:e})=>{if(t.ref.handleClick=r=>t.dispatch("DID_ACTIVATE_ITEM",{id:e.id}),t.element.id=`filepond--item-${e.id}`,t.element.addEventListener("click",t.ref.handleClick),t.ref.container=t.appendChildView(t.createChildView(Ld,{id:e.id})),t.ref.panel=t.appendChildView(t.createChildView(Ds,{name:"item-panel"})),t.ref.panel.height=null,e.markedForRemoval=!1,!t.query("GET_ALLOW_REORDER"))return;t.element.dataset.dragState="idle";const i=r=>{if(!r.isPrimary)return;let n=!1;const s={x:r.pageX,y:r.pageY};e.dragOrigin={x:t.translateX,y:t.translateY},e.dragCenter={x:r.offsetX,y:r.offsetY};const a=Fd(t.query("GET_ACTIVE_ITEMS"));t.dispatch("DID_GRAB_ITEM",{id:e.id,dragState:a});const o=d=>{if(!d.isPrimary)return;d.stopPropagation(),d.preventDefault(),e.dragOffset={x:d.pageX-s.x,y:d.pageY-s.y},e.dragOffset.x*e.dragOffset.x+e.dragOffset.y*e.dragOffset.y>16&&!n&&(n=!0,t.element.removeEventListener("click",t.ref.handleClick)),t.dispatch("DID_DRAG_ITEM",{id:e.id,dragState:a})},l=d=>{d.isPrimary&&(document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",l),e.dragOffset={x:d.pageX-s.x,y:d.pageY-s.y},t.dispatch("DID_DROP_ITEM",{id:e.id,dragState:a}),n&&setTimeout(()=>t.element.addEventListener("click",t.ref.handleClick),0))};document.addEventListener("pointermove",o),document.addEventListener("pointerup",l)};t.element.addEventListener("pointerdown",i)},Gd=re({DID_UPDATE_PANEL_HEIGHT:({root:t,action:e})=>{t.height=e.height}}),Vd=re({DID_GRAB_ITEM:({root:t,props:e})=>{e.dragOrigin={x:t.translateX,y:t.translateY}},DID_DRAG_ITEM:({root:t})=>{t.element.dataset.dragState="drag"},DID_DROP_ITEM:({root:t,props:e})=>{e.dragOffset=null,e.dragOrigin=null,t.element.dataset.dragState="drop"}},({root:t,actions:e,props:i,shouldOptimize:r})=>{t.element.dataset.dragState==="drop"&&t.scaleX<=1&&(t.element.dataset.dragState="idle");let n=e.concat().filter(a=>/^DID_/.test(a.type)).reverse().find(a=>on[a.type]);n&&n.type!==i.currentState&&(i.currentState=n.type,t.element.dataset.filepondItemState=on[i.currentState]||"");const s=t.query("GET_ITEM_PANEL_ASPECT_RATIO")||t.query("GET_PANEL_ASPECT_RATIO");s?r||(t.height=t.rect.element.width*s):(Gd({root:t,actions:e,props:i}),!t.height&&t.ref.container.rect.element.height>0&&(t.height=t.ref.container.rect.element.height)),r&&(t.ref.panel.height=null),t.ref.panel.height=t.height}),Ud=K({create:Bd,write:Vd,destroy:({root:t,props:e})=>{t.element.removeEventListener("click",t.ref.handleClick),t.dispatch("RELEASE_ITEM",{query:e.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:an,scaleY:an,translateX:sn,translateY:sn,opacity:{type:"tween",duration:150}}}});var nr=(t,e)=>Math.max(1,Math.floor((t+1)/e));const sr=(t,e,i)=>{if(!i)return;const r=t.rect.element.width,n=e.length;let s=null;if(n===0||i.top<e[0].rect.element.top)return-1;const o=e[0].rect.element,l=o.marginLeft+o.marginRight,d=o.width+l,c=nr(r,d);if(c===1){for(let g=0;g<n;g++){const f=e[g],m=f.rect.outer.top+f.rect.element.height*.5;if(i.top<m)return g}return n}const u=o.marginTop+o.marginBottom,h=o.height+u;for(let g=0;g<n;g++){const f=g%c,m=Math.floor(g/c),I=f*d,_=m*h,p=_-o.marginTop,T=I+d,y=_+h+o.marginBottom;if(i.top<y&&i.top>p){if(i.left<T)return g;g!==n-1?s=g:s=null}}return s!==null?s:n},Nt={height:0,width:0,get getHeight(){return this.height},set setHeight(t){(this.height===0||t===0)&&(this.height=t)},get getWidth(){return this.width},set setWidth(t){(this.width===0||t===0)&&(this.width=t)},setDimensions:function(t,e){(this.height===0||t===0)&&(this.height=t),(this.width===0||e===0)&&(this.width=e)}},kd=({root:t})=>{j(t.element,"role","list"),t.ref.lastItemSpanwDate=Date.now()},$d=({root:t,action:e})=>{const{id:i,index:r,interactionMethod:n}=e;t.ref.addIndex=r;const s=Date.now();let a=s,o=1;if(n!==Ee.NONE){o=0;const l=t.query("GET_ITEM_INSERT_INTERVAL"),d=s-t.ref.lastItemSpanwDate;a=d<l?s+(l-d):s}t.ref.lastItemSpanwDate=a,t.appendChildView(t.createChildView(Ud,{spawnDate:a,id:i,opacity:o,interactionMethod:n}),r)},ln=(t,e,i,r=0,n=1)=>{t.dragOffset?(t.translateX=null,t.translateY=null,t.translateX=t.dragOrigin.x+t.dragOffset.x,t.translateY=t.dragOrigin.y+t.dragOffset.y,t.scaleX=1.025,t.scaleY=1.025):(t.translateX=e,t.translateY=i,Date.now()>t.spawnDate&&(t.opacity===0&&Hd(t,e,i,r,n),t.scaleX=1,t.scaleY=1,t.opacity=1))},Hd=(t,e,i,r,n)=>{t.interactionMethod===Ee.NONE?(t.translateX=null,t.translateX=e,t.translateY=null,t.translateY=i):t.interactionMethod===Ee.DROP?(t.translateX=null,t.translateX=e-r*20,t.translateY=null,t.translateY=i-n*10,t.scaleX=.8,t.scaleY=.8):t.interactionMethod===Ee.BROWSE?(t.translateY=null,t.translateY=i-30):t.interactionMethod===Ee.API&&(t.translateX=null,t.translateX=e-30,t.translateY=null)},Wd=({root:t,action:e})=>{const{id:i}=e,r=t.childViews.find(n=>n.id===i);r&&(r.scaleX=.9,r.scaleY=.9,r.opacity=0,r.markedForRemoval=!0)},ui=t=>t.rect.element.height+t.rect.element.marginBottom*.5+t.rect.element.marginTop*.5,Yd=t=>t.rect.element.width+t.rect.element.marginLeft*.5+t.rect.element.marginRight*.5,zd=({root:t,action:e})=>{const{id:i,dragState:r}=e,n=t.query("GET_ITEM",{id:i}),s=t.childViews.find(I=>I.id===i),a=t.childViews.length,o=r.getItemIndex(n);if(!s)return;const l={x:s.dragOrigin.x+s.dragOffset.x+s.dragCenter.x,y:s.dragOrigin.y+s.dragOffset.y+s.dragCenter.y},d=ui(s),c=Yd(s);let u=Math.floor(t.rect.outer.width/c);u>a&&(u=a);const h=Math.floor(a/u+1);Nt.setHeight=d*h,Nt.setWidth=c*u;var g={y:Math.floor(l.y/d),x:Math.floor(l.x/c),getGridIndex:function(){return l.y>Nt.getHeight||l.y<0||l.x>Nt.getWidth||l.x<0?o:this.y*u+this.x},getColIndex:function(){const _=t.query("GET_ACTIVE_ITEMS"),p=t.childViews.filter(M=>M.rect.element.height),T=_.map(M=>p.find(C=>C.id===M.id)),y=T.findIndex(M=>M===s),v=ui(s),E=T.length;let D=E,R=0,S=0,N=0;for(let M=0;M<E;M++)if(R=ui(T[M]),N=S,S=N+R,l.y<S){if(y>M){if(l.y<N+v){D=M;break}continue}D=M;break}return D}};const f=u>1?g.getGridIndex():g.getColIndex();t.dispatch("MOVE_ITEM",{query:s,index:f});const m=r.getIndex();if(m===void 0||m!==f){if(r.setIndex(f),m===void 0)return;t.dispatch("DID_REORDER_ITEMS",{items:t.query("GET_ACTIVE_ITEMS"),origin:o,target:f})}},qd=re({DID_ADD_ITEM:$d,DID_REMOVE_ITEM:Wd,DID_DRAG_ITEM:zd}),Xd=({root:t,props:e,actions:i,shouldOptimize:r})=>{qd({root:t,props:e,actions:i});const{dragCoordinates:n}=e,s=t.rect.element.width,a=t.childViews.filter(T=>T.rect.element.height),o=t.query("GET_ACTIVE_ITEMS").map(T=>a.find(y=>y.id===T.id)).filter(T=>T),l=n?sr(t,o,n):null,d=t.ref.addIndex||null;t.ref.addIndex=null;let c=0,u=0,h=0;if(o.length===0)return;const g=o[0].rect.element,f=g.marginTop+g.marginBottom,m=g.marginLeft+g.marginRight,I=g.width+m,_=g.height+f,p=nr(s,I);if(p===1){let T=0,y=0;o.forEach((v,E)=>{if(l){let S=E-l;S===-2?y=-f*.25:S===-1?y=-f*.75:S===0?y=f*.75:S===1?y=f*.25:y=0}r&&(v.translateX=null,v.translateY=null),v.markedForRemoval||ln(v,0,T+y);let R=(v.rect.element.height+f)*(v.markedForRemoval?v.opacity:1);T+=R})}else{let T=0,y=0;o.forEach((v,E)=>{E===l&&(c=1),E===d&&(h+=1),v.markedForRemoval&&v.opacity<.5&&(u-=1);const D=E+h+c+u,R=D%p,S=Math.floor(D/p),N=R*I,M=S*_,C=Math.sign(N-T),B=Math.sign(M-y);T=N,y=M,!v.markedForRemoval&&(r&&(v.translateX=null,v.translateY=null),ln(v,N,M,C,B))})}},jd=(t,e)=>e.filter(i=>i.data&&i.data.id?t.id===i.data.id:!0),Kd=K({create:kd,write:Xd,tag:"ul",name:"list",didWriteView:({root:t})=>{t.childViews.filter(e=>e.markedForRemoval&&e.opacity===0&&e.resting).forEach(e=>{e._destroy(),t.removeChildView(e)})},filterFrameActionsForChild:jd,mixins:{apis:["dragCoordinates"]}}),Zd=({root:t,props:e})=>{t.ref.list=t.appendChildView(t.createChildView(Kd)),e.dragCoordinates=null,e.overflowing=!1},Qd=({root:t,props:e,action:i})=>{t.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(e.dragCoordinates={left:i.position.scopeLeft-t.ref.list.rect.element.left,top:i.position.scopeTop-(t.rect.outer.top+t.rect.element.marginTop+t.rect.element.scrollTop)})},Jd=({props:t})=>{t.dragCoordinates=null},eu=re({DID_DRAG:Qd,DID_END_DRAG:Jd}),tu=({root:t,props:e,actions:i})=>{if(eu({root:t,props:e,actions:i}),t.ref.list.dragCoordinates=e.dragCoordinates,e.overflowing&&!e.overflow&&(e.overflowing=!1,t.element.dataset.state="",t.height=null),e.overflow){const r=Math.round(e.overflow);r!==t.height&&(e.overflowing=!0,t.element.dataset.state="overflow",t.height=r)}},iu=K({create:Zd,write:tu,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),ve=(t,e,i,r="")=>{i?j(t,e,r):t.removeAttribute(e)},ru=t=>{if(!(!t||t.value==="")){try{t.value=""}catch{}if(t.value){const e=Me("form"),i=t.parentNode,r=t.nextSibling;e.appendChild(t),e.reset(),r?i.insertBefore(t,r):i.appendChild(t)}}},nu=({root:t,props:e})=>{t.element.id=`filepond--browser-${e.id}`,j(t.element,"name",t.query("GET_NAME")),j(t.element,"aria-controls",`filepond--assistant-${e.id}`),j(t.element,"aria-labelledby",`filepond--drop-label-${e.id}`),Ss({root:t,action:{value:t.query("GET_ACCEPTED_FILE_TYPES")}}),Ms({root:t,action:{value:t.query("GET_ALLOW_MULTIPLE")}}),Cs({root:t,action:{value:t.query("GET_ALLOW_DIRECTORIES_ONLY")}}),Gi({root:t}),Ls({root:t,action:{value:t.query("GET_REQUIRED")}}),Ps({root:t,action:{value:t.query("GET_CAPTURE_METHOD")}}),t.ref.handleChange=i=>{if(!t.element.value)return;const r=Array.from(t.element.files).map(n=>(n._relativePath=n.webkitRelativePath,n));setTimeout(()=>{e.onload(r),ru(t.element)},250)},t.element.addEventListener("change",t.ref.handleChange)},Ss=({root:t,action:e})=>{t.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&ve(t.element,"accept",!!e.value,e.value?e.value.join(","):"")},Ms=({root:t,action:e})=>{ve(t.element,"multiple",e.value)},Cs=({root:t,action:e})=>{ve(t.element,"webkitdirectory",e.value)},Gi=({root:t})=>{const e=t.query("GET_DISABLED"),i=t.query("GET_ALLOW_BROWSE"),r=e||!i;ve(t.element,"disabled",r)},Ls=({root:t,action:e})=>{e.value?t.query("GET_TOTAL_ITEMS")===0&&ve(t.element,"required",!0):ve(t.element,"required",!1)},Ps=({root:t,action:e})=>{ve(t.element,"capture",!!e.value,e.value===!0?"":e.value)},cn=({root:t})=>{const{element:e}=t;t.query("GET_TOTAL_ITEMS")>0?(ve(e,"required",!1),ve(e,"name",!1)):(ve(e,"name",!0,t.query("GET_NAME")),t.query("GET_CHECK_VALIDITY")&&e.setCustomValidity(""),t.query("GET_REQUIRED")&&ve(e,"required",!0))},su=({root:t})=>{t.query("GET_CHECK_VALIDITY")&&t.element.setCustomValidity(t.query("GET_LABEL_INVALID_FIELD"))},au=K({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:nu,destroy:({root:t})=>{t.element.removeEventListener("change",t.ref.handleChange)},write:re({DID_LOAD_ITEM:cn,DID_REMOVE_ITEM:cn,DID_THROW_ITEM_INVALID:su,DID_SET_DISABLED:Gi,DID_SET_ALLOW_BROWSE:Gi,DID_SET_ALLOW_DIRECTORIES_ONLY:Cs,DID_SET_ALLOW_MULTIPLE:Ms,DID_SET_ACCEPTED_FILE_TYPES:Ss,DID_SET_CAPTURE_METHOD:Ps,DID_SET_REQUIRED:Ls})}),dn={ENTER:13,SPACE:32},ou=({root:t,props:e})=>{const i=Me("label");j(i,"for",`filepond--browser-${e.id}`),j(i,"id",`filepond--drop-label-${e.id}`),j(i,"aria-hidden","true"),t.ref.handleKeyDown=r=>{(r.keyCode===dn.ENTER||r.keyCode===dn.SPACE)&&(r.preventDefault(),t.ref.label.click())},t.ref.handleClick=r=>{r.target===i||i.contains(r.target)||t.ref.label.click()},i.addEventListener("keydown",t.ref.handleKeyDown),t.element.addEventListener("click",t.ref.handleClick),Ns(i,e.caption),t.appendChild(i),t.ref.label=i},Ns=(t,e)=>{t.innerHTML=e;const i=t.querySelector(".filepond--label-action");return i&&j(i,"tabindex","0"),e},lu=K({name:"drop-label",ignoreRect:!0,create:ou,destroy:({root:t})=>{t.ref.label.addEventListener("keydown",t.ref.handleKeyDown),t.element.removeEventListener("click",t.ref.handleClick)},write:re({DID_SET_LABEL_IDLE:({root:t,action:e})=>{Ns(t.ref.label,e.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),cu=K({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),du=({root:t})=>{const e=t.rect.element.width*.5,i=t.rect.element.height*.5;t.ref.blob=t.appendChildView(t.createChildView(cu,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:e,translateY:i}))},uu=({root:t,action:e})=>{if(!t.ref.blob){du({root:t});return}t.ref.blob.translateX=e.position.scopeLeft,t.ref.blob.translateY=e.position.scopeTop,t.ref.blob.scaleX=1,t.ref.blob.scaleY=1,t.ref.blob.opacity=1},hu=({root:t})=>{t.ref.blob&&(t.ref.blob.opacity=0)},fu=({root:t})=>{t.ref.blob&&(t.ref.blob.scaleX=2.5,t.ref.blob.scaleY=2.5,t.ref.blob.opacity=0)},pu=({root:t,props:e,actions:i})=>{gu({root:t,props:e,actions:i});const{blob:r}=t.ref;i.length===0&&r&&r.opacity===0&&(t.removeChildView(r),t.ref.blob=null)},gu=re({DID_DRAG:uu,DID_DROP:fu,DID_END_DRAG:hu}),mu=K({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:pu}),xs=(t,e)=>{try{const i=new DataTransfer;e.forEach(r=>{r instanceof File?i.items.add(r):i.items.add(new File([r],r.name,{type:r.type}))}),t.files=i.files}catch{return!1}return!0},Eu=({root:t})=>t.ref.fields={},ri=(t,e)=>t.ref.fields[e],ar=t=>{t.query("GET_ACTIVE_ITEMS").forEach(e=>{t.ref.fields[e.id]&&t.element.appendChild(t.ref.fields[e.id])})},un=({root:t})=>ar(t),Tu=({root:t,action:e})=>{const n=!(t.query("GET_ITEM",e.id).origin===Z.LOCAL)&&t.query("SHOULD_UPDATE_FILE_INPUT"),s=Me("input");s.type=n?"file":"hidden",s.name=t.query("GET_NAME"),s.disabled=t.query("GET_DISABLED"),t.ref.fields[e.id]=s,ar(t)},Iu=({root:t,action:e})=>{const i=ri(t,e.id);if(!i||(e.serverFileReference!==null&&(i.value=e.serverFileReference),!t.query("SHOULD_UPDATE_FILE_INPUT")))return;const r=t.query("GET_ITEM",e.id);xs(i,[r.file])},_u=({root:t,action:e})=>{t.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout(()=>{const i=ri(t,e.id);i&&xs(i,[e.file])},0)},yu=({root:t})=>{t.element.disabled=t.query("GET_DISABLED")},vu=({root:t,action:e})=>{const i=ri(t,e.id);i&&(i.parentNode&&i.parentNode.removeChild(i),delete t.ref.fields[e.id])},Ou=({root:t,action:e})=>{const i=ri(t,e.id);i&&(e.value===null?i.removeAttribute("value"):i.value=e.value,ar(t))},Ru=re({DID_SET_DISABLED:yu,DID_ADD_ITEM:Tu,DID_LOAD_ITEM:Iu,DID_REMOVE_ITEM:vu,DID_DEFINE_VALUE:Ou,DID_PREPARE_OUTPUT:_u,DID_REORDER_ITEMS:un,DID_SORT_ITEMS:un}),bu=K({tag:"fieldset",name:"data",create:Eu,write:Ru,ignoreRect:!0}),wu=t=>"getRootNode"in t?t.getRootNode():document,Au=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],Du=["css","csv","html","txt"],Su={zip:"zip|compressed",epub:"application/epub+zip"},Fs=(t="")=>(t=t.toLowerCase(),Au.includes(t)?"image/"+(t==="jpg"?"jpeg":t==="svg"?"svg+xml":t):Du.includes(t)?"text/"+t:Su[t]||""),or=t=>new Promise((e,i)=>{const r=Bu(t);if(r.length&&!Mu(t))return e(r);Cu(t).then(e)}),Mu=t=>t.files?t.files.length>0:!1,Cu=t=>new Promise((e,i)=>{const r=(t.items?Array.from(t.items):[]).filter(n=>Lu(n)).map(n=>Pu(n));if(!r.length){e(t.files?Array.from(t.files):[]);return}Promise.all(r).then(n=>{const s=[];n.forEach(a=>{s.push.apply(s,a)}),e(s.filter(a=>a).map(a=>(a._relativePath||(a._relativePath=a.webkitRelativePath),a)))}).catch(console.error)}),Lu=t=>{if(Bs(t)){const e=lr(t);if(e)return e.isFile||e.isDirectory}return t.kind==="file"},Pu=t=>new Promise((e,i)=>{if(Fu(t)){Nu(lr(t)).then(e).catch(i);return}e([t.getAsFile()])}),Nu=t=>new Promise((e,i)=>{const r=[];let n=0,s=0;const a=()=>{s===0&&n===0&&e(r)},o=l=>{n++;const d=l.createReader(),c=()=>{d.readEntries(u=>{if(u.length===0){n--,a();return}u.forEach(h=>{h.isDirectory?o(h):(s++,h.file(g=>{const f=xu(g);h.fullPath&&(f._relativePath=h.fullPath),r.push(f),s--,a()}))}),c()},i)};c()};o(t)}),xu=t=>{if(t.type.length)return t;const e=t.lastModifiedDate,i=t.name,r=Fs(ii(t.name));return r.length&&(t=t.slice(0,t.size,r),t.name=i,t.lastModifiedDate=e),t},Fu=t=>Bs(t)&&(lr(t)||{}).isDirectory,Bs=t=>"webkitGetAsEntry"in t,lr=t=>t.webkitGetAsEntry(),Bu=t=>{let e=[];try{if(e=Vu(t),e.length)return e;e=Gu(t)}catch{}return e},Gu=t=>{let e=t.getData("url");return typeof e=="string"&&e.length?[e]:[]},Vu=t=>{let e=t.getData("text/html");if(typeof e=="string"&&e.length){const i=e.match(/src\s*=\s*"(.+?)"/);if(i)return[i[1]]}return[]},Xt=[],Ye=t=>({pageLeft:t.pageX,pageTop:t.pageY,scopeLeft:t.offsetX||t.layerX,scopeTop:t.offsetY||t.layerY}),Uu=(t,e,i)=>{const r=ku(e),n={element:t,filterElement:i,state:null,ondrop:()=>{},onenter:()=>{},ondrag:()=>{},onexit:()=>{},onload:()=>{},allowdrop:()=>{}};return n.destroy=r.addListener(n),n},ku=t=>{const e=Xt.find(r=>r.element===t);if(e)return e;const i=$u(t);return Xt.push(i),i},$u=t=>{const e=[],i={dragenter:Wu,dragover:Yu,dragleave:qu,drop:zu},r={};Y(i,(s,a)=>{r[s]=a(t,e),t.addEventListener(s,r[s],!1)});const n={element:t,addListener:s=>(e.push(s),()=>{e.splice(e.indexOf(s),1),e.length===0&&(Xt.splice(Xt.indexOf(n),1),Y(i,a=>{t.removeEventListener(a,r[a],!1)}))})};return n},Hu=(t,e)=>("elementFromPoint"in t||(t=document),t.elementFromPoint(e.x,e.y)),cr=(t,e)=>{const i=wu(e),r=Hu(i,{x:t.pageX-window.pageXOffset,y:t.pageY-window.pageYOffset});return r===e||e.contains(r)};let Gs=null;const xt=(t,e)=>{try{t.dropEffect=e}catch{}},Wu=(t,e)=>i=>{i.preventDefault(),Gs=i.target,e.forEach(r=>{const{element:n,onenter:s}=r;cr(i,n)&&(r.state="enter",s(Ye(i)))})},Yu=(t,e)=>i=>{i.preventDefault();const r=i.dataTransfer;or(r).then(n=>{let s=!1;e.some(a=>{const{filterElement:o,element:l,onenter:d,onexit:c,ondrag:u,allowdrop:h}=a;xt(r,"copy");const g=h(n);if(!g){xt(r,"none");return}if(cr(i,l)){if(s=!0,a.state===null){a.state="enter",d(Ye(i));return}if(a.state="over",o&&!g){xt(r,"none");return}u(Ye(i))}else o&&!s&&xt(r,"none"),a.state&&(a.state=null,c(Ye(i)))})})},zu=(t,e)=>i=>{i.preventDefault();const r=i.dataTransfer;or(r).then(n=>{e.forEach(s=>{const{filterElement:a,element:o,ondrop:l,onexit:d,allowdrop:c}=s;if(s.state=null,!(a&&!cr(i,o))){if(!c(n))return d(Ye(i));l(Ye(i),n)}})})},qu=(t,e)=>i=>{Gs===i.target&&e.forEach(r=>{const{onexit:n}=r;r.state=null,n(Ye(i))})},Xu=(t,e,i)=>{t.classList.add("filepond--hopper");const{catchesDropsOnPage:r,requiresDropOnElement:n,filterItems:s=c=>c}=i,a=Uu(t,r?document.documentElement:t,n);let o="",l="";a.allowdrop=c=>e(s(c)),a.ondrop=(c,u)=>{const h=s(u);if(!e(h)){d.ondragend(c);return}l="drag-drop",d.onload(h,c)},a.ondrag=c=>{d.ondrag(c)},a.onenter=c=>{l="drag-over",d.ondragstart(c)},a.onexit=c=>{l="drag-exit",d.ondragend(c)};const d={updateHopperState:()=>{o!==l&&(t.dataset.hopperState=l,o=l)},onload:()=>{},ondragstart:()=>{},ondrag:()=>{},ondragend:()=>{},destroy:()=>{a.destroy()}};return d};let Vi=!1;const nt=[],Vs=t=>{const e=document.activeElement;if(e&&/textarea|input/i.test(e.nodeName)){let i=!1,r=e;for(;r!==document.body;){if(r.classList.contains("filepond--root")){i=!0;break}r=r.parentNode}if(!i)return}or(t.clipboardData).then(i=>{i.length&&nt.forEach(r=>r(i))})},ju=t=>{nt.includes(t)||(nt.push(t),!Vi&&(Vi=!0,document.addEventListener("paste",Vs)))},Ku=t=>{er(nt,nt.indexOf(t)),nt.length===0&&(document.removeEventListener("paste",Vs),Vi=!1)},Zu=()=>{const t=i=>{e.onload(i)},e={destroy:()=>{Ku(t)},onload:()=>{}};return ju(t),e},Qu=({root:t,props:e})=>{t.element.id=`filepond--assistant-${e.id}`,j(t.element,"role","status"),j(t.element,"aria-live","polite"),j(t.element,"aria-relevant","additions")};let hn=null,fn=null;const hi=[],ni=(t,e)=>{t.element.textContent=e},Ju=t=>{t.element.textContent=""},Us=(t,e,i)=>{const r=t.query("GET_TOTAL_ITEMS");ni(t,`${i} ${e}, ${r} ${r===1?t.query("GET_LABEL_FILE_COUNT_SINGULAR"):t.query("GET_LABEL_FILE_COUNT_PLURAL")}`),clearTimeout(fn),fn=setTimeout(()=>{Ju(t)},1500)},ks=t=>t.element.parentNode.contains(document.activeElement),eh=({root:t,action:e})=>{if(!ks(t))return;t.element.textContent="";const i=t.query("GET_ITEM",e.id);hi.push(i.filename),clearTimeout(hn),hn=setTimeout(()=>{Us(t,hi.join(", "),t.query("GET_LABEL_FILE_ADDED")),hi.length=0},750)},th=({root:t,action:e})=>{if(!ks(t))return;const i=e.item;Us(t,i.filename,t.query("GET_LABEL_FILE_REMOVED"))},ih=({root:t,action:e})=>{const r=t.query("GET_ITEM",e.id).filename,n=t.query("GET_LABEL_FILE_PROCESSING_COMPLETE");ni(t,`${r} ${n}`)},pn=({root:t,action:e})=>{const r=t.query("GET_ITEM",e.id).filename,n=t.query("GET_LABEL_FILE_PROCESSING_ABORTED");ni(t,`${r} ${n}`)},Ft=({root:t,action:e})=>{const r=t.query("GET_ITEM",e.id).filename;ni(t,`${e.status.main} ${r} ${e.status.sub}`)},rh=K({create:Qu,ignoreRect:!0,ignoreRectUpdate:!0,write:re({DID_LOAD_ITEM:eh,DID_REMOVE_ITEM:th,DID_COMPLETE_ITEM_PROCESSING:ih,DID_ABORT_ITEM_PROCESSING:pn,DID_REVERT_ITEM_PROCESSING:pn,DID_THROW_ITEM_REMOVE_ERROR:Ft,DID_THROW_ITEM_LOAD_ERROR:Ft,DID_THROW_ITEM_INVALID:Ft,DID_THROW_ITEM_PROCESSING_ERROR:Ft}),tag:"span",name:"assistant"}),$s=(t,e="-")=>t.replace(new RegExp(`${e}.`,"g"),i=>i.charAt(1).toUpperCase()),Hs=(t,e=16,i=!0)=>{let r=Date.now(),n=null;return(...s)=>{clearTimeout(n);const a=Date.now()-r,o=()=>{r=Date.now(),t(...s)};a<e?i||(n=setTimeout(o,e-a)):o()}},nh=1e6,jt=t=>t.preventDefault(),sh=({root:t,props:e})=>{const i=t.query("GET_ID");i&&(t.element.id=i);const r=t.query("GET_CLASS_NAME");r&&r.split(" ").filter(l=>l.length).forEach(l=>{t.element.classList.add(l)}),t.ref.label=t.appendChildView(t.createChildView(lu,{...e,translateY:null,caption:t.query("GET_LABEL_IDLE")})),t.ref.list=t.appendChildView(t.createChildView(iu,{translateY:null})),t.ref.panel=t.appendChildView(t.createChildView(Ds,{name:"panel-root"})),t.ref.assistant=t.appendChildView(t.createChildView(rh,{...e})),t.ref.data=t.appendChildView(t.createChildView(bu,{...e})),t.ref.measure=Me("div"),t.ref.measure.style.height="100%",t.element.appendChild(t.ref.measure),t.ref.bounds=null,t.query("GET_STYLES").filter(l=>!Se(l.value)).map(({name:l,value:d})=>{t.element.dataset[l]=d}),t.ref.widthPrevious=null,t.ref.widthUpdated=Hs(()=>{t.ref.updateHistory=[],t.dispatch("DID_RESIZE_ROOT")},250),t.ref.previousAspectRatio=null,t.ref.updateHistory=[];const n=window.matchMedia("(pointer: fine) and (hover: hover)").matches,s="PointerEvent"in window;t.query("GET_ALLOW_REORDER")&&s&&!n&&(t.element.addEventListener("touchmove",jt,{passive:!1}),t.element.addEventListener("gesturestart",jt));const a=t.query("GET_CREDITS");if(a.length===2){const l=document.createElement("a");l.className="filepond--credits",l.setAttribute("aria-hidden","true"),l.href=a[0],l.tabindex=-1,l.target="_blank",l.rel="noopener noreferrer",l.textContent=a[1],t.element.appendChild(l),t.ref.credits=l}},ah=({root:t,props:e,actions:i})=>{if(uh({root:t,props:e,actions:i}),i.filter(E=>/^DID_SET_STYLE_/.test(E.type)).filter(E=>!Se(E.data.value)).map(({type:E,data:D})=>{const R=$s(E.substring(8).toLowerCase(),"_");t.element.dataset[R]=D.value,t.invalidateLayout()}),t.rect.element.hidden)return;t.rect.element.width!==t.ref.widthPrevious&&(t.ref.widthPrevious=t.rect.element.width,t.ref.widthUpdated());let r=t.ref.bounds;r||(r=t.ref.bounds=ch(t),t.element.removeChild(t.ref.measure),t.ref.measure=null);const{hopper:n,label:s,list:a,panel:o}=t.ref;n&&n.updateHopperState();const l=t.query("GET_PANEL_ASPECT_RATIO"),d=t.query("GET_ALLOW_MULTIPLE"),c=t.query("GET_TOTAL_ITEMS"),u=d?t.query("GET_MAX_FILES")||nh:1,h=c===u,g=i.find(E=>E.type==="DID_ADD_ITEM");if(h&&g){const E=g.data.interactionMethod;s.opacity=0,d?s.translateY=-40:E===Ee.API?s.translateX=40:E===Ee.BROWSE?s.translateY=40:s.translateY=30}else h||(s.opacity=1,s.translateX=0,s.translateY=0);const f=oh(t),m=lh(t),I=s.rect.element.height,_=!d||h?0:I,p=h?a.rect.element.marginTop:0,T=c===0?0:a.rect.element.marginBottom,y=_+p+m.visual+T,v=_+p+m.bounds+T;if(a.translateY=Math.max(0,_-a.rect.element.marginTop)-f.top,l){const E=t.rect.element.width,D=E*l;l!==t.ref.previousAspectRatio&&(t.ref.previousAspectRatio=l,t.ref.updateHistory=[]);const R=t.ref.updateHistory;R.push(E);const S=2;if(R.length>S*2){const M=R.length,C=M-10;let B=0;for(let w=M;w>=C;w--)if(R[w]===R[w-2]&&B++,B>=S)return}o.scalable=!1,o.height=D;const N=D-_-(T-f.bottom)-(h?p:0);m.visual>N?a.overflow=N:a.overflow=null,t.height=D}else if(r.fixedHeight){o.scalable=!1;const E=r.fixedHeight-_-(T-f.bottom)-(h?p:0);m.visual>E?a.overflow=E:a.overflow=null}else if(r.cappedHeight){const E=y>=r.cappedHeight,D=Math.min(r.cappedHeight,y);o.scalable=!0,o.height=E?D:D-f.top-f.bottom;const R=D-_-(T-f.bottom)-(h?p:0);y>r.cappedHeight&&m.visual>R?a.overflow=R:a.overflow=null,t.height=Math.min(r.cappedHeight,v-f.top-f.bottom)}else{const E=c>0?f.top+f.bottom:0;o.scalable=!0,o.height=Math.max(I,y-E),t.height=Math.max(I,v-E)}t.ref.credits&&o.heightCurrent&&(t.ref.credits.style.transform=`translateY(${o.heightCurrent}px)`)},oh=t=>{const e=t.ref.list.childViews[0].childViews[0];return e?{top:e.rect.element.marginTop,bottom:e.rect.element.marginBottom}:{top:0,bottom:0}},lh=t=>{let e=0,i=0;const r=t.ref.list,n=r.childViews[0],s=n.childViews.filter(p=>p.rect.element.height),a=t.query("GET_ACTIVE_ITEMS").map(p=>s.find(T=>T.id===p.id)).filter(p=>p);if(a.length===0)return{visual:e,bounds:i};const o=n.rect.element.width,l=sr(n,a,r.dragCoordinates),d=a[0].rect.element,c=d.marginTop+d.marginBottom,u=d.marginLeft+d.marginRight,h=d.width+u,g=d.height+c,f=typeof l<"u"&&l>=0?1:0,m=a.find(p=>p.markedForRemoval&&p.opacity<.45)?-1:0,I=a.length+f+m,_=nr(o,h);return _===1?a.forEach(p=>{const T=p.rect.element.height+c;i+=T,e+=T*p.opacity}):(i=Math.ceil(I/_)*g,e=i),{visual:e,bounds:i}},ch=t=>{const e=t.ref.measureHeight||null;return{cappedHeight:parseInt(t.style.maxHeight,10)||null,fixedHeight:e===0?null:e}},dr=(t,e)=>{const i=t.query("GET_ALLOW_REPLACE"),r=t.query("GET_ALLOW_MULTIPLE"),n=t.query("GET_TOTAL_ITEMS");let s=t.query("GET_MAX_FILES");const a=e.length;return!r&&a>1?(t.dispatch("DID_THROW_MAX_FILES",{source:e,error:z("warning",0,"Max files")}),!0):(s=r?s:1,!r&&i?!1:lt(s)&&n+a>s?(t.dispatch("DID_THROW_MAX_FILES",{source:e,error:z("warning",0,"Max files")}),!0):!1)},dh=(t,e,i)=>{const r=t.childViews[0];return sr(r,e,{left:i.scopeLeft-r.rect.element.left,top:i.scopeTop-(t.rect.outer.top+t.rect.element.marginTop+t.rect.element.scrollTop)})},gn=t=>{const e=t.query("GET_ALLOW_DROP"),i=t.query("GET_DISABLED"),r=e&&!i;if(r&&!t.ref.hopper){const n=Xu(t.element,s=>{const a=t.query("GET_BEFORE_DROP_FILE")||(()=>!0);return t.query("GET_DROP_VALIDATION")?s.every(l=>qe("ALLOW_HOPPER_ITEM",l,{query:t.query}).every(d=>d===!0)&&a(l)):!0},{filterItems:s=>{const a=t.query("GET_IGNORED_FILES");return s.filter(o=>ot(o)?!a.includes(o.name.toLowerCase()):!0)},catchesDropsOnPage:t.query("GET_DROP_ON_PAGE"),requiresDropOnElement:t.query("GET_DROP_ON_ELEMENT")});n.onload=(s,a)=>{const l=t.ref.list.childViews[0].childViews.filter(c=>c.rect.element.height),d=t.query("GET_ACTIVE_ITEMS").map(c=>l.find(u=>u.id===c.id)).filter(c=>c);_e("ADD_ITEMS",s,{dispatch:t.dispatch}).then(c=>{if(dr(t,c))return!1;t.dispatch("ADD_ITEMS",{items:c,index:dh(t.ref.list,d,a),interactionMethod:Ee.DROP})}),t.dispatch("DID_DROP",{position:a}),t.dispatch("DID_END_DRAG",{position:a})},n.ondragstart=s=>{t.dispatch("DID_START_DRAG",{position:s})},n.ondrag=Hs(s=>{t.dispatch("DID_DRAG",{position:s})}),n.ondragend=s=>{t.dispatch("DID_END_DRAG",{position:s})},t.ref.hopper=n,t.ref.drip=t.appendChildView(t.createChildView(mu))}else!r&&t.ref.hopper&&(t.ref.hopper.destroy(),t.ref.hopper=null,t.removeChildView(t.ref.drip))},mn=(t,e)=>{const i=t.query("GET_ALLOW_BROWSE"),r=t.query("GET_DISABLED"),n=i&&!r;n&&!t.ref.browser?t.ref.browser=t.appendChildView(t.createChildView(au,{...e,onload:s=>{_e("ADD_ITEMS",s,{dispatch:t.dispatch}).then(a=>{if(dr(t,a))return!1;t.dispatch("ADD_ITEMS",{items:a,index:-1,interactionMethod:Ee.BROWSE})})}}),0):!n&&t.ref.browser&&(t.removeChildView(t.ref.browser),t.ref.browser=null)},En=t=>{const e=t.query("GET_ALLOW_PASTE"),i=t.query("GET_DISABLED"),r=e&&!i;r&&!t.ref.paster?(t.ref.paster=Zu(),t.ref.paster.onload=n=>{_e("ADD_ITEMS",n,{dispatch:t.dispatch}).then(s=>{if(dr(t,s))return!1;t.dispatch("ADD_ITEMS",{items:s,index:-1,interactionMethod:Ee.PASTE})})}):!r&&t.ref.paster&&(t.ref.paster.destroy(),t.ref.paster=null)},uh=re({DID_SET_ALLOW_BROWSE:({root:t,props:e})=>{mn(t,e)},DID_SET_ALLOW_DROP:({root:t})=>{gn(t)},DID_SET_ALLOW_PASTE:({root:t})=>{En(t)},DID_SET_DISABLED:({root:t,props:e})=>{gn(t),En(t),mn(t,e),t.query("GET_DISABLED")?t.element.dataset.disabled="disabled":t.element.removeAttribute("data-disabled")}}),hh=K({name:"root",read:({root:t})=>{t.ref.measure&&(t.ref.measureHeight=t.ref.measure.offsetHeight)},create:sh,write:ah,destroy:({root:t})=>{t.ref.paster&&t.ref.paster.destroy(),t.ref.hopper&&t.ref.hopper.destroy(),t.element.removeEventListener("touchmove",jt),t.element.removeEventListener("gesturestart",jt)},mixins:{styles:["height"]}}),fh=(t={})=>{let e=null;const i=qt(),r=Sl(pc(i),[Pc,Ec(i)],[nd,mc(i)]);r.dispatch("SET_OPTIONS",{options:t});const n=()=>{document.hidden||r.dispatch("KICK")};document.addEventListener("visibilitychange",n);let s=null,a=!1,o=!1,l=null,d=null;const c=()=>{a||(a=!0),clearTimeout(s),s=setTimeout(()=>{a=!1,l=null,d=null,o&&(o=!1,r.dispatch("DID_STOP_RESIZE"))},500)};window.addEventListener("resize",c);const u=hh(r,{id:Ji()});let h=!1,g=!1;const f={_read:()=>{a&&(d=window.innerWidth,l||(l=d),!o&&d!==l&&(r.dispatch("DID_START_RESIZE"),o=!0)),g&&h&&(h=u.element.offsetParent===null),!h&&(u._read(),g=u.rect.element.hidden)},_write:O=>{const A=r.processActionQueue().filter(L=>!/^SET_/.test(L.type));h&&!A.length||(p(A),h=u._write(O,A,o),_c(r.query("GET_ITEMS")),h&&r.processDispatchQueue())}},m=O=>A=>{const L={type:O};if(!A)return L;if(A.hasOwnProperty("error")&&(L.error=A.error?{...A.error}:null),A.status&&(L.status={...A.status}),A.file&&(L.output=A.file),A.source)L.file=A.source;else if(A.item||A.id){const P=A.item?A.item:r.query("GET_ITEM",A.id);L.file=P?ae(P):null}return A.items&&(L.items=A.items.map(ae)),/progress/.test(O)&&(L.progress=A.progress),A.hasOwnProperty("origin")&&A.hasOwnProperty("target")&&(L.origin=A.origin,L.target=A.target),L},I={DID_DESTROY:m("destroy"),DID_INIT:m("init"),DID_THROW_MAX_FILES:m("warning"),DID_INIT_ITEM:m("initfile"),DID_START_ITEM_LOAD:m("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:m("addfileprogress"),DID_LOAD_ITEM:m("addfile"),DID_THROW_ITEM_INVALID:[m("error"),m("addfile")],DID_THROW_ITEM_LOAD_ERROR:[m("error"),m("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[m("error"),m("removefile")],DID_PREPARE_OUTPUT:m("preparefile"),DID_START_ITEM_PROCESSING:m("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:m("processfileprogress"),DID_ABORT_ITEM_PROCESSING:m("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:m("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:m("processfiles"),DID_REVERT_ITEM_PROCESSING:m("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[m("error"),m("processfile")],DID_REMOVE_ITEM:m("removefile"),DID_UPDATE_ITEMS:m("updatefiles"),DID_ACTIVATE_ITEM:m("activatefile"),DID_REORDER_ITEMS:m("reorderfiles")},_=O=>{const A={pond:x,...O};delete A.type,u.element.dispatchEvent(new CustomEvent(`FilePond:${O.type}`,{detail:A,bubbles:!0,cancelable:!0,composed:!0}));const L=[];O.hasOwnProperty("error")&&L.push(O.error),O.hasOwnProperty("file")&&L.push(O.file);const P=["type","error","file"];Object.keys(O).filter(k=>!P.includes(k)).forEach(k=>L.push(O[k])),x.fire(O.type,...L);const G=r.query(`GET_ON${O.type.toUpperCase()}`);G&&G(...L)},p=O=>{O.length&&O.filter(A=>I[A.type]).forEach(A=>{const L=I[A.type];(Array.isArray(L)?L:[L]).forEach(P=>{A.type==="DID_INIT_ITEM"?_(P(A.data)):setTimeout(()=>{_(P(A.data))},0)})})},T=O=>r.dispatch("SET_OPTIONS",{options:O}),y=O=>r.query("GET_ACTIVE_ITEM",O),v=O=>new Promise((A,L)=>{r.dispatch("REQUEST_ITEM_PREPARE",{query:O,success:P=>{A(P)},failure:P=>{L(P)}})}),E=(O,A={})=>new Promise((L,P)=>{S([{source:O,options:A}],{index:A.index}).then(G=>L(G&&G[0])).catch(P)}),D=O=>O.file&&O.id,R=(O,A)=>(typeof O=="object"&&!D(O)&&!A&&(A=O,O=void 0),r.dispatch("REMOVE_ITEM",{...A,query:O}),r.query("GET_ACTIVE_ITEM",O)===null),S=(...O)=>new Promise((A,L)=>{const P=[],G={};if(Qt(O[0]))P.push.apply(P,O[0]),Object.assign(G,O[1]||{});else{const k=O[O.length-1];typeof k=="object"&&!(k instanceof Blob)&&Object.assign(G,O.pop()),P.push(...O)}r.dispatch("ADD_ITEMS",{items:P,index:G.index,interactionMethod:Ee.API,success:A,failure:L})}),N=()=>r.query("GET_ACTIVE_ITEMS"),M=O=>new Promise((A,L)=>{r.dispatch("REQUEST_ITEM_PROCESSING",{query:O,success:P=>{A(P)},failure:P=>{L(P)}})}),C=(...O)=>{const A=Array.isArray(O[0])?O[0]:O,L=A.length?A:N();return Promise.all(L.map(v))},B=(...O)=>{const A=Array.isArray(O[0])?O[0]:O;if(!A.length){const L=N().filter(P=>!(P.status===F.IDLE&&P.origin===Z.LOCAL)&&P.status!==F.PROCESSING&&P.status!==F.PROCESSING_COMPLETE&&P.status!==F.PROCESSING_REVERT_ERROR);return Promise.all(L.map(M))}return Promise.all(A.map(M))},w=(...O)=>{const A=Array.isArray(O[0])?O[0]:O;let L;typeof A[A.length-1]=="object"?L=A.pop():Array.isArray(O[0])&&(L=O[1]);const P=N();return A.length?A.map(k=>Ve(k)?P[k]?P[k].id:null:k).filter(k=>k).map(k=>R(k,L)):Promise.all(P.map(k=>R(k,L)))},x={...ti(),...f,...gc(r,i),setOptions:T,addFile:E,addFiles:S,getFile:y,processFile:M,prepareFile:v,removeFile:R,moveFile:(O,A)=>r.dispatch("MOVE_ITEM",{query:O,index:A}),getFiles:N,processFiles:B,removeFiles:w,prepareFiles:C,sort:O=>r.dispatch("SORT",{compare:O}),browse:()=>{var O=u.element.querySelector("input[type=file]");O&&O.click()},destroy:()=>{x.fire("destroy",u.element),r.dispatch("ABORT_ALL"),u._destroy(),window.removeEventListener("resize",c),document.removeEventListener("visibilitychange",n),r.dispatch("DID_DESTROY")},insertBefore:O=>Vr(u.element,O),insertAfter:O=>Ur(u.element,O),appendTo:O=>O.appendChild(u.element),replaceElement:O=>{Vr(u.element,O),O.parentNode.removeChild(O),e=O},restoreElement:()=>{e&&(Ur(e,u.element),u.element.parentNode.removeChild(u.element),e=null)},isAttachedTo:O=>u.element===O||e===O,element:{get:()=>u.element},status:{get:()=>r.query("GET_STATUS")}};return r.dispatch("DID_INIT"),xe(x)},Ws=(t={})=>{const e={};return Y(qt(),(r,n)=>{e[r]=n[0]}),fh({...e,...t})},ph=t=>t.charAt(0).toLowerCase()+t.slice(1),gh=t=>$s(t.replace(/^data-/,"")),Ys=(t,e)=>{Y(e,(i,r)=>{Y(t,(n,s)=>{const a=new RegExp(i);if(!a.test(n)||(delete t[n],r===!1))return;if(ie(r)){t[r]=s;return}const l=r.group;J(r)&&!t[l]&&(t[l]={}),t[l][ph(n.replace(a,""))]=s}),r.mapping&&Ys(t[r.group],r.mapping)})},mh=(t,e={})=>{const i=[];Y(t.attributes,n=>{i.push(t.attributes[n])});const r=i.filter(n=>n.name).reduce((n,s)=>{const a=j(t,s.name);return n[gh(s.name)]=a===s.name?!0:a,n},{});return Ys(r,e),r},Eh=(t,e={})=>{const i={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};qe("SET_ATTRIBUTE_TO_OPTION_MAP",i);const r={...e},n=mh(t.nodeName==="FIELDSET"?t.querySelector("input[type=file]"):t,i);Object.keys(n).forEach(a=>{J(n[a])?(J(r[a])||(r[a]={}),Object.assign(r[a],n[a])):r[a]=n[a]}),r.files=(e.files||[]).concat(Array.from(t.querySelectorAll("input:not([type=file])")).map(a=>({source:a.value,options:{type:a.dataset.type}})));const s=Ws(r);return t.files&&Array.from(t.files).forEach(a=>{s.addFile(a)}),s.replaceElement(t),s},Th=(...t)=>Dl(t[0])?Eh(...t):Ws(...t),Ih=["fire","_read","_write"],Tn=t=>{const e={};return fs(t,e,Ih),e},_h=(t,e)=>t.replace(/(?:{([a-zA-Z]+)})/g,(i,r)=>e[r]),yh=t=>{const e=new Blob(["(",t.toString(),")()"],{type:"application/javascript"}),i=URL.createObjectURL(e),r=new Worker(i);return{transfer:(n,s)=>{},post:(n,s,a)=>{const o=Ji();r.onmessage=l=>{l.data.id===o&&s(l.data.message)},r.postMessage({id:o,message:n},a)},terminate:()=>{r.terminate(),URL.revokeObjectURL(i)}}},vh=t=>new Promise((e,i)=>{const r=new Image;r.onload=()=>{e(r)},r.onerror=n=>{i(n)},r.src=t}),zs=(t,e)=>{const i=t.slice(0,t.size,t.type);return i.lastModifiedDate=t.lastModifiedDate,i.name=e,i},Oh=t=>zs(t,t.name),In=[],Rh=t=>{if(In.includes(t))return;In.push(t);const e=t({addFilter:vc,utils:{Type:b,forin:Y,isString:ie,isFile:ot,toNaturalFileSize:bs,replaceInString:_h,getExtensionFromFilename:ii,getFilenameWithoutExtension:vs,guesstimateMimeType:Fs,getFileFromBlob:at,getFilenameFromURL:wt,createRoute:re,createWorker:yh,createView:K,createItemAPI:ae,loadImage:vh,copyFile:Oh,renameFile:zs,createBlob:Is,applyFilterChain:_e,text:q,getNumericAspectRatioFromString:ms},views:{fileActionButton:Rs}});Oc(e.options)},bh=()=>Object.prototype.toString.call(window.operamini)==="[object OperaMini]",wh=()=>"Promise"in window,Ah=()=>"slice"in Blob.prototype,Dh=()=>"URL"in window&&"createObjectURL"in window.URL,Sh=()=>"visibilityState"in document,Mh=()=>"performance"in window,Ch=()=>"supports"in(window.CSS||{}),Lh=()=>/MSIE|Trident/.test(window.navigator.userAgent),_n=(()=>{const t=os()&&!bh()&&Sh()&&wh()&&Ah()&&Dh()&&Mh()&&(Ch()||Lh());return()=>t})(),Le={apps:[]},Ph="filepond",Xe=()=>{};let yn={},kt=Xe,fi=Xe,vn=Xe,On=Xe,Ui=Xe,Rn=Xe,bn=Xe;if(_n()){ec(()=>{Le.apps.forEach(i=>i._read())},i=>{Le.apps.forEach(r=>r._write(i))});const t=()=>{document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:_n,create:kt,destroy:fi,parse:vn,find:On,registerPlugin:Ui,setOptions:bn}})),document.removeEventListener("DOMContentLoaded",t)};document.readyState!=="loading"?setTimeout(()=>t(),0):document.addEventListener("DOMContentLoaded",t);const e=()=>Y(qt(),(i,r)=>{yn[i]=r[1]});yn={},e(),kt=(...i)=>{const r=Th(...i);return r.on("destroy",fi),Le.apps.push(r),Tn(r)},fi=i=>{const r=Le.apps.findIndex(n=>n.isAttachedTo(i));return r>=0?(Le.apps.splice(r,1)[0].restoreElement(),!0):!1},vn=i=>Array.from(i.querySelectorAll(`.${Ph}`)).filter(s=>!Le.apps.find(a=>a.isAttachedTo(s))).map(s=>kt(s)),On=i=>{const r=Le.apps.find(n=>n.isAttachedTo(i));return r?Tn(r):null},Ui=(...i)=>{i.forEach(Rh),e()},Rn=()=>{const i={};return Y(qt(),(r,n)=>{i[r]=n[0]}),i},bn=i=>(J(i)&&(Le.apps.forEach(r=>{r.setOptions(i)}),Rc(i)),Rn())}/*!
 * FilePondPluginImagePreview 4.6.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Nh=t=>/^image/.test(t.type),wn=(t,e)=>Ot(t.x*e,t.y*e),An=(t,e)=>Ot(t.x+e.x,t.y+e.y),xh=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?{x:0,y:0}:Ot(t.x/e,t.y/e)},Bt=(t,e,i)=>{const r=Math.cos(e),n=Math.sin(e),s=Ot(t.x-i.x,t.y-i.y);return Ot(i.x+r*s.x-n*s.y,i.y+n*s.x+r*s.y)},Ot=(t=0,e=0)=>({x:t,y:e}),oe=(t,e,i=1,r)=>{if(typeof t=="string")return parseFloat(t)*i;if(typeof t=="number")return t*(r?e[r]:Math.min(e.width,e.height))},Fh=(t,e,i)=>{const r=t.borderStyle||t.lineStyle||"solid",n=t.backgroundColor||t.fontColor||"transparent",s=t.borderColor||t.lineColor||"transparent",a=oe(t.borderWidth||t.lineWidth,e,i),o=t.lineCap||"round",l=t.lineJoin||"round",d=typeof r=="string"?"":r.map(u=>oe(u,e,i)).join(","),c=t.opacity||1;return{"stroke-linecap":o,"stroke-linejoin":l,"stroke-width":a||0,"stroke-dasharray":d,stroke:s,fill:n,opacity:c}},pe=t=>t!=null,Bh=(t,e,i=1)=>{let r=oe(t.x,e,i,"width")||oe(t.left,e,i,"width"),n=oe(t.y,e,i,"height")||oe(t.top,e,i,"height"),s=oe(t.width,e,i,"width"),a=oe(t.height,e,i,"height"),o=oe(t.right,e,i,"width"),l=oe(t.bottom,e,i,"height");return pe(n)||(pe(a)&&pe(l)?n=e.height-a-l:n=l),pe(r)||(pe(s)&&pe(o)?r=e.width-s-o:r=o),pe(s)||(pe(r)&&pe(o)?s=e.width-r-o:s=0),pe(a)||(pe(n)&&pe(l)?a=e.height-n-l:a=0),{x:r||0,y:n||0,width:s||0,height:a||0}},Gh=t=>t.map((e,i)=>`${i===0?"M":"L"} ${e.x} ${e.y}`).join(" "),Re=(t,e)=>Object.keys(e).forEach(i=>t.setAttribute(i,e[i])),Vh="http://www.w3.org/2000/svg",tt=(t,e)=>{const i=document.createElementNS(Vh,t);return e&&Re(i,e),i},Uh=t=>Re(t,{...t.rect,...t.styles}),kh=t=>{const e=t.rect.x+t.rect.width*.5,i=t.rect.y+t.rect.height*.5,r=t.rect.width*.5,n=t.rect.height*.5;return Re(t,{cx:e,cy:i,rx:r,ry:n,...t.styles})},$h={contain:"xMidYMid meet",cover:"xMidYMid slice"},Hh=(t,e)=>{Re(t,{...t.rect,...t.styles,preserveAspectRatio:$h[e.fit]||"none"})},Wh={left:"start",center:"middle",right:"end"},Yh=(t,e,i,r)=>{const n=oe(e.fontSize,i,r),s=e.fontFamily||"sans-serif",a=e.fontWeight||"normal",o=Wh[e.textAlign]||"start";Re(t,{...t.rect,...t.styles,"stroke-width":0,"font-weight":a,"font-size":n,"font-family":s,"text-anchor":o}),t.text!==e.text&&(t.text=e.text,t.textContent=e.text.length?e.text:" ")},zh=(t,e,i,r)=>{Re(t,{...t.rect,...t.styles,fill:"none"});const n=t.childNodes[0],s=t.childNodes[1],a=t.childNodes[2],o=t.rect,l={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};if(Re(n,{x1:o.x,y1:o.y,x2:l.x,y2:l.y}),!e.lineDecoration)return;s.style.display="none",a.style.display="none";const d=xh({x:l.x-o.x,y:l.y-o.y}),c=oe(.05,i,r);if(e.lineDecoration.indexOf("arrow-begin")!==-1){const u=wn(d,c),h=An(o,u),g=Bt(o,2,h),f=Bt(o,-2,h);Re(s,{style:"display:block;",d:`M${g.x},${g.y} L${o.x},${o.y} L${f.x},${f.y}`})}if(e.lineDecoration.indexOf("arrow-end")!==-1){const u=wn(d,-c),h=An(l,u),g=Bt(l,2,h),f=Bt(l,-2,h);Re(a,{style:"display:block;",d:`M${g.x},${g.y} L${l.x},${l.y} L${f.x},${f.y}`})}},qh=(t,e,i,r)=>{Re(t,{...t.styles,fill:"none",d:Gh(e.points.map(n=>({x:oe(n.x,i,r,"width"),y:oe(n.y,i,r,"height")})))})},Gt=t=>e=>tt(t,{id:e.id}),Xh=t=>{const e=tt("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return e.onload=()=>{e.setAttribute("opacity",t.opacity||1)},e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src),e},jh=t=>{const e=tt("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"}),i=tt("line");e.appendChild(i);const r=tt("path");e.appendChild(r);const n=tt("path");return e.appendChild(n),e},Kh={image:Xh,rect:Gt("rect"),ellipse:Gt("ellipse"),text:Gt("text"),path:Gt("path"),line:jh},Zh={rect:Uh,ellipse:kh,image:Hh,text:Yh,path:qh,line:zh},Qh=(t,e)=>Kh[t](e),Jh=(t,e,i,r,n)=>{e!=="path"&&(t.rect=Bh(i,r,n)),t.styles=Fh(i,r,n),Zh[e](t,i,r,n)},ef=["x","y","left","top","right","bottom","width","height"],tf=t=>typeof t=="string"&&/%/.test(t)?parseFloat(t)/100:t,rf=t=>{const[e,i]=t,r=i.points?{}:ef.reduce((n,s)=>(n[s]=tf(i[s]),n),{});return[e,{zIndex:0,...i,...r}]},nf=(t,e)=>t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0,sf=t=>t.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:!0,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:({root:e,props:i})=>{if(!i.dirty)return;const{crop:r,resize:n,markup:s}=i,a=i.width,o=i.height;let l=r.width,d=r.height;if(n){const{size:g}=n;let f=g&&g.width,m=g&&g.height;const I=n.mode,_=n.upscale;f&&!m&&(m=f),m&&!f&&(f=m);const p=l<f&&d<m;if(!p||p&&_){let T=f/l,y=m/d;if(I==="force")l=f,d=m;else{let v;I==="cover"?v=Math.max(T,y):I==="contain"&&(v=Math.min(T,y)),l=l*v,d=d*v}}}const c={width:a,height:o};e.element.setAttribute("width",c.width),e.element.setAttribute("height",c.height);const u=Math.min(a/l,o/d);e.element.innerHTML="";const h=e.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");s.filter(h).map(rf).sort(nf).forEach(g=>{const[f,m]=g,I=Qh(f,m);Jh(I,f,m,c,u),e.element.appendChild(I)})}}),It=(t,e)=>({x:t,y:e}),af=(t,e)=>t.x*e.x+t.y*e.y,Dn=(t,e)=>It(t.x-e.x,t.y-e.y),of=(t,e)=>af(Dn(t,e),Dn(t,e)),Sn=(t,e)=>Math.sqrt(of(t,e)),Mn=(t,e)=>{const i=t,r=1.5707963267948966,n=e,s=1.5707963267948966-e,a=Math.sin(r),o=Math.sin(n),l=Math.sin(s),d=Math.cos(s),c=i/a,u=c*o,h=c*l;return It(d*u,d*h)},lf=(t,e)=>{const i=t.width,r=t.height,n=Mn(i,e),s=Mn(r,e),a=It(t.x+Math.abs(n.x),t.y-Math.abs(n.y)),o=It(t.x+t.width+Math.abs(s.y),t.y+Math.abs(s.x)),l=It(t.x-Math.abs(s.y),t.y+t.height-Math.abs(s.x));return{width:Sn(a,o),height:Sn(a,l)}},cf=(t,e,i=1)=>{const r=t.height/t.width;let n=1,s=e,a=1,o=r;o>s&&(o=s,a=o/r);const l=Math.max(n/a,s/o),d=t.width/(i*l*a),c=d*e;return{width:d,height:c}},qs=(t,e,i,r)=>{const n=r.x>.5?1-r.x:r.x,s=r.y>.5?1-r.y:r.y,a=n*2*t.width,o=s*2*t.height,l=lf(e,i);return Math.max(l.width/a,l.height/o)},Xs=(t,e)=>{let i=t.width,r=i*e;r>t.height&&(r=t.height,i=r/e);const n=(t.width-i)*.5,s=(t.height-r)*.5;return{x:n,y:s,width:i,height:r}},df=(t,e={})=>{let{zoom:i,rotation:r,center:n,aspectRatio:s}=e;s||(s=t.height/t.width);const a=cf(t,s,i),o={x:a.width*.5,y:a.height*.5},l={x:0,y:0,width:a.width,height:a.height,center:o},d=typeof e.scaleToFit>"u"||e.scaleToFit,c=qs(t,Xs(l,s),r,d?n:{x:.5,y:.5}),u=i*c;return{widthFloat:a.width/u,heightFloat:a.height/u,width:Math.round(a.width/u),height:Math.round(a.height/u)}},Oe={type:"spring",stiffness:.5,damping:.45,mass:10},uf=t=>t.utils.createView({name:"image-bitmap",ignoreRect:!0,mixins:{styles:["scaleX","scaleY"]},create:({root:e,props:i})=>{e.appendChild(i.image)}}),hf=t=>t.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:!0,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:Oe,originY:Oe,scaleX:Oe,scaleY:Oe,translateX:Oe,translateY:Oe,rotateZ:Oe}},create:({root:e,props:i})=>{i.width=i.image.width,i.height=i.image.height,e.ref.bitmap=e.appendChildView(e.createChildView(uf(t),{image:i.image}))},write:({root:e,props:i})=>{const{flip:r}=i.crop,{bitmap:n}=e.ref;n.scaleX=r.horizontal?-1:1,n.scaleY=r.vertical?-1:1}}),ff=t=>t.utils.createView({name:"image-clip",tag:"div",ignoreRect:!0,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function({root:e,props:i}){i.background&&(e.element.style.backgroundColor=i.background)},create:({root:e,props:i})=>{e.ref.image=e.appendChildView(e.createChildView(hf(t),Object.assign({},i))),e.ref.createMarkup=()=>{e.ref.markup||(e.ref.markup=e.appendChildView(e.createChildView(sf(t),Object.assign({},i))))},e.ref.destroyMarkup=()=>{e.ref.markup&&(e.removeChildView(e.ref.markup),e.ref.markup=null)};const r=e.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");r!==null&&(r==="grid"?e.element.dataset.transparencyIndicator=r:e.element.dataset.transparencyIndicator="color")},write:({root:e,props:i,shouldOptimize:r})=>{const{crop:n,markup:s,resize:a,dirty:o,width:l,height:d}=i;e.ref.image.crop=n;const c={x:0,y:0,width:l,height:d,center:{x:l*.5,y:d*.5}},u={width:e.ref.image.width,height:e.ref.image.height},h={x:n.center.x*u.width,y:n.center.y*u.height},g={x:c.center.x-u.width*n.center.x,y:c.center.y-u.height*n.center.y},f=Math.PI*2+n.rotation%(Math.PI*2),m=n.aspectRatio||u.height/u.width,I=typeof n.scaleToFit>"u"||n.scaleToFit,_=qs(u,Xs(c,m),f,I?n.center:{x:.5,y:.5}),p=n.zoom*_;s&&s.length?(e.ref.createMarkup(),e.ref.markup.width=l,e.ref.markup.height=d,e.ref.markup.resize=a,e.ref.markup.dirty=o,e.ref.markup.markup=s,e.ref.markup.crop=df(u,n)):e.ref.markup&&e.ref.destroyMarkup();const T=e.ref.image;if(r){T.originX=null,T.originY=null,T.translateX=null,T.translateY=null,T.rotateZ=null,T.scaleX=null,T.scaleY=null;return}T.originX=h.x,T.originY=h.y,T.translateX=g.x,T.translateY=g.y,T.rotateZ=f,T.scaleX=p,T.scaleY=p}}),pf=t=>t.utils.createView({name:"image-preview",tag:"div",ignoreRect:!0,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:Oe,scaleY:Oe,translateY:Oe,opacity:{type:"tween",duration:400}}},create:({root:e,props:i})=>{e.ref.clip=e.appendChildView(e.createChildView(ff(t),{id:i.id,image:i.image,crop:i.crop,markup:i.markup,resize:i.resize,dirty:i.dirty,background:i.background}))},write:({root:e,props:i,shouldOptimize:r})=>{const{clip:n}=e.ref,{image:s,crop:a,markup:o,resize:l,dirty:d}=i;if(n.crop=a,n.markup=o,n.resize=l,n.dirty=d,n.opacity=r?0:1,r||e.rect.element.hidden)return;const c=s.height/s.width;let u=a.aspectRatio||c;const h=e.rect.inner.width,g=e.rect.inner.height;let f=e.query("GET_IMAGE_PREVIEW_HEIGHT");const m=e.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),I=e.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),_=e.query("GET_PANEL_ASPECT_RATIO"),p=e.query("GET_ALLOW_MULTIPLE");_&&!p&&(f=h*_,u=_);let T=f!==null?f:Math.max(m,Math.min(h*u,I)),y=T/u;y>h&&(y=h,T=y*u),T>g&&(T=g,y=g/u),n.width=y,n.height=T}});let gf=`<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">
    <defs>
        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">
            <stop offset='50%' stop-color='#000000'/>
            <stop offset='56%' stop-color='#0a0a0a'/>
            <stop offset='63%' stop-color='#262626'/>
            <stop offset='69%' stop-color='#4f4f4f'/>
            <stop offset='75%' stop-color='#808080'/>
            <stop offset='81%' stop-color='#b1b1b1'/>
            <stop offset='88%' stop-color='#dadada'/>
            <stop offset='94%' stop-color='#f6f6f6'/>
            <stop offset='100%' stop-color='#ffffff'/>
        </radialGradient>
        <mask id="mask-__UID__">
            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>
        </mask>
    </defs>
    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>
</svg>`,Cn=0;const mf=t=>t.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:!0,create:({root:e,props:i})=>{let r=gf;if(document.querySelector("base")){const n=new URL(window.location.href.replace(window.location.hash,"")).href;r=r.replace(/url\(\#/g,"url("+n+"#")}Cn++,e.element.classList.add(`filepond--image-preview-overlay-${i.status}`),e.element.innerHTML=r.replace(/__UID__/g,Cn)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),Ef=function(){self.onmessage=t=>{createImageBitmap(t.data.message.file).then(e=>{self.postMessage({id:t.data.id,message:e},[e])})}},Tf=function(){self.onmessage=t=>{const e=t.data.message.imageData,i=t.data.message.colorMatrix,r=e.data,n=r.length,s=i[0],a=i[1],o=i[2],l=i[3],d=i[4],c=i[5],u=i[6],h=i[7],g=i[8],f=i[9],m=i[10],I=i[11],_=i[12],p=i[13],T=i[14],y=i[15],v=i[16],E=i[17],D=i[18],R=i[19];let S=0,N=0,M=0,C=0,B=0;for(;S<n;S+=4)N=r[S]/255,M=r[S+1]/255,C=r[S+2]/255,B=r[S+3]/255,r[S]=Math.max(0,Math.min((N*s+M*a+C*o+B*l+d)*255,255)),r[S+1]=Math.max(0,Math.min((N*c+M*u+C*h+B*g+f)*255,255)),r[S+2]=Math.max(0,Math.min((N*m+M*I+C*_+B*p+T)*255,255)),r[S+3]=Math.max(0,Math.min((N*y+M*v+C*E+B*D+R)*255,255));self.postMessage({id:t.data.id,message:e},[e.data.buffer])}},If=(t,e)=>{let i=new Image;i.onload=()=>{const r=i.naturalWidth,n=i.naturalHeight;i=null,e(r,n)},i.src=t},_f={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]},yf=(t,e,i,r)=>{r!==-1&&t.transform.apply(t,_f[r](e,i))},vf=(t,e,i,r)=>{e=Math.round(e),i=Math.round(i);const n=document.createElement("canvas");n.width=e,n.height=i;const s=n.getContext("2d");return r>=5&&r<=8&&([e,i]=[i,e]),yf(s,e,i,r),s.drawImage(t,0,0,e,i),n},js=t=>/^image/.test(t.type)&&!/svg/.test(t.type),Of=10,Rf=10,bf=t=>{const e=Math.min(Of/t.width,Rf/t.height),i=document.createElement("canvas"),r=i.getContext("2d"),n=i.width=Math.ceil(t.width*e),s=i.height=Math.ceil(t.height*e);r.drawImage(t,0,0,n,s);let a=null;try{a=r.getImageData(0,0,n,s).data}catch{return null}const o=a.length;let l=0,d=0,c=0,u=0;for(;u<o;u+=4)l+=a[u]*a[u],d+=a[u+1]*a[u+1],c+=a[u+2]*a[u+2];return l=pi(l,o),d=pi(d,o),c=pi(c,o),{r:l,g:d,b:c}},pi=(t,e)=>Math.floor(Math.sqrt(t/(e/4))),wf=(t,e)=>(e=e||document.createElement("canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e),Af=t=>{let e;try{e=new ImageData(t.width,t.height)}catch{e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(new Uint8ClampedArray(t.data)),e},Df=t=>new Promise((e,i)=>{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{e(r)},r.onerror=n=>{i(n)},r.src=t}),Sf=t=>{const e=mf(t),i=pf(t),{createWorker:r}=t.utils,n=(p,T,y)=>new Promise(v=>{p.ref.imageData||(p.ref.imageData=y.getContext("2d").getImageData(0,0,y.width,y.height));const E=Af(p.ref.imageData);if(!T||T.length!==20)return y.getContext("2d").putImageData(E,0,0),v();const D=r(Tf);D.post({imageData:E,colorMatrix:T},R=>{y.getContext("2d").putImageData(R,0,0),D.terminate(),v()},[E.data.buffer])}),s=(p,T)=>{p.removeChildView(T),T.image.width=1,T.image.height=1,T._destroy()},a=({root:p})=>{const T=p.ref.images.shift();return T.opacity=0,T.translateY=-15,p.ref.imageViewBin.push(T),T},o=({root:p,props:T,image:y})=>{const v=T.id,E=p.query("GET_ITEM",{id:v});if(!E)return;const D=E.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},R=p.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");let S,N,M=!1;p.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(S=E.getMetadata("markup")||[],N=E.getMetadata("resize"),M=!0);const C=p.appendChildView(p.createChildView(i,{id:v,image:y,crop:D,resize:N,markup:S,dirty:M,background:R,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),p.childViews.length);p.ref.images.push(C),C.opacity=1,C.scaleX=1,C.scaleY=1,C.translateY=0,setTimeout(()=>{p.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:v})},250)},l=({root:p,props:T})=>{const y=p.query("GET_ITEM",{id:T.id});if(!y)return;const v=p.ref.images[p.ref.images.length-1];v.crop=y.getMetadata("crop"),v.background=p.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),p.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(v.dirty=!0,v.resize=y.getMetadata("resize"),v.markup=y.getMetadata("markup"))},d=({root:p,props:T,action:y})=>{if(!/crop|filter|markup|resize/.test(y.change.key)||!p.ref.images.length)return;const v=p.query("GET_ITEM",{id:T.id});if(v){if(/filter/.test(y.change.key)){const E=p.ref.images[p.ref.images.length-1];n(p,y.change.value,E.image);return}if(/crop|markup|resize/.test(y.change.key)){const E=v.getMetadata("crop"),D=p.ref.images[p.ref.images.length-1];if(E&&E.aspectRatio&&D.crop&&D.crop.aspectRatio&&Math.abs(E.aspectRatio-D.crop.aspectRatio)>1e-5){const R=a({root:p});o({root:p,props:T,image:wf(R.image)})}else l({root:p,props:T})}}},c=p=>{const y=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./);return(y?parseInt(y[1]):null)<=58?!1:"createImageBitmap"in window&&js(p)},u=({root:p,props:T})=>{const{id:y}=T,v=p.query("GET_ITEM",y);if(!v)return;const E=URL.createObjectURL(v.file);If(E,(D,R)=>{p.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:y,width:D,height:R})})},h=({root:p,props:T})=>{const{id:y}=T,v=p.query("GET_ITEM",y);if(!v)return;const E=URL.createObjectURL(v.file),D=()=>{Df(E).then(R)},R=S=>{URL.revokeObjectURL(E);const M=(v.getMetadata("exif")||{}).orientation||-1;let{width:C,height:B}=S;if(!C||!B)return;M>=5&&M<=8&&([C,B]=[B,C]);const w=Math.max(1,window.devicePixelRatio*.75),O=p.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR")*w,A=B/C,L=p.rect.element.width,P=p.rect.element.height;let G=L,k=G*A;A>1?(G=Math.min(C,L*O),k=G*A):(k=Math.min(B,P*O),G=k/A);const Ae=vf(S,G,k,M),Fe=()=>{const ct=p.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?bf(data):null;v.setMetadata("color",ct,!0),"close"in S&&S.close(),p.ref.overlayShadow.opacity=1,o({root:p,props:T,image:Ae})},de=v.getMetadata("filter");de?n(p,de,Ae).then(Fe):Fe()};if(c(v.file)){const S=r(Ef);S.post({file:v.file},N=>{if(S.terminate(),!N){D();return}R(N)})}else D()},g=({root:p})=>{const T=p.ref.images[p.ref.images.length-1];T.translateY=0,T.scaleX=1,T.scaleY=1,T.opacity=1},f=({root:p})=>{p.ref.overlayShadow.opacity=1,p.ref.overlayError.opacity=0,p.ref.overlaySuccess.opacity=0},m=({root:p})=>{p.ref.overlayShadow.opacity=.25,p.ref.overlayError.opacity=1},I=({root:p})=>{p.ref.overlayShadow.opacity=.25,p.ref.overlaySuccess.opacity=1},_=({root:p})=>{p.ref.images=[],p.ref.imageData=null,p.ref.imageViewBin=[],p.ref.overlayShadow=p.appendChildView(p.createChildView(e,{opacity:0,status:"idle"})),p.ref.overlaySuccess=p.appendChildView(p.createChildView(e,{opacity:0,status:"success"})),p.ref.overlayError=p.appendChildView(p.createChildView(e,{opacity:0,status:"failure"}))};return t.utils.createView({name:"image-preview-wrapper",create:_,styles:["height"],apis:["height"],destroy:({root:p})=>{p.ref.images.forEach(T=>{T.image.width=1,T.image.height=1})},didWriteView:({root:p})=>{p.ref.images.forEach(T=>{T.dirty=!1})},write:t.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:g,DID_IMAGE_PREVIEW_CONTAINER_CREATE:u,DID_FINISH_CALCULATE_PREVIEWSIZE:h,DID_UPDATE_ITEM_METADATA:d,DID_THROW_ITEM_LOAD_ERROR:m,DID_THROW_ITEM_PROCESSING_ERROR:m,DID_THROW_ITEM_INVALID:m,DID_COMPLETE_ITEM_PROCESSING:I,DID_START_ITEM_PROCESSING:f,DID_REVERT_ITEM_PROCESSING:f},({root:p})=>{const T=p.ref.imageViewBin.filter(y=>y.opacity===0);p.ref.imageViewBin=p.ref.imageViewBin.filter(y=>y.opacity>0),T.forEach(y=>s(p,y)),T.length=0})})},Ks=t=>{const{addFilter:e,utils:i}=t,{Type:r,createRoute:n,isFile:s}=i,a=Sf(t);return e("CREATE_VIEW",o=>{const{is:l,view:d,query:c}=o;if(!l("file")||!c("GET_ALLOW_IMAGE_PREVIEW"))return;const u=({root:I,props:_})=>{const{id:p}=_,T=c("GET_ITEM",p);if(!T||!s(T.file)||T.archived)return;const y=T.file;if(!Nh(y)||!c("GET_IMAGE_PREVIEW_FILTER_ITEM")(T))return;const v="createImageBitmap"in(window||{}),E=c("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!v&&E&&y.size>E)return;I.ref.imagePreview=d.appendChildView(d.createChildView(a,{id:p}));const D=I.query("GET_IMAGE_PREVIEW_HEIGHT");D&&I.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:T.id,height:D});const R=!v&&y.size>c("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");I.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:p},R)},h=(I,_)=>{if(!I.ref.imagePreview)return;let{id:p}=_;const T=I.query("GET_ITEM",{id:p});if(!T)return;const y=I.query("GET_PANEL_ASPECT_RATIO"),v=I.query("GET_ITEM_PANEL_ASPECT_RATIO"),E=I.query("GET_IMAGE_PREVIEW_HEIGHT");if(y||v||E)return;let{imageWidth:D,imageHeight:R}=I.ref;if(!D||!R)return;const S=I.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),N=I.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),C=(T.getMetadata("exif")||{}).orientation||-1;if(C>=5&&C<=8&&([D,R]=[R,D]),!js(T.file)||I.query("GET_IMAGE_PREVIEW_UPSCALE")){const L=2048/D;D*=L,R*=L}const B=R/D,w=(T.getMetadata("crop")||{}).aspectRatio||B;let x=Math.max(S,Math.min(R,N));const O=I.rect.element.width,A=Math.min(O*w,x);I.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:T.id,height:A})},g=({root:I})=>{I.ref.shouldRescale=!0},f=({root:I,action:_})=>{_.change.key==="crop"&&(I.ref.shouldRescale=!0)},m=({root:I,action:_})=>{I.ref.imageWidth=_.width,I.ref.imageHeight=_.height,I.ref.shouldRescale=!0,I.ref.shouldDrawPreview=!0,I.dispatch("KICK")};d.registerWriter(n({DID_RESIZE_ROOT:g,DID_STOP_RESIZE:g,DID_LOAD_ITEM:u,DID_IMAGE_PREVIEW_CALCULATE_SIZE:m,DID_UPDATE_ITEM_METADATA:f},({root:I,props:_})=>{I.ref.imagePreview&&(I.rect.element.hidden||(I.ref.shouldRescale&&(h(I,_),I.ref.shouldRescale=!1),I.ref.shouldDrawPreview&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{I.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:_.id})})}),I.ref.shouldDrawPreview=!1)))}))}),{options:{allowImagePreview:[!0,r.BOOLEAN],imagePreviewFilterItem:[()=>!0,r.FUNCTION],imagePreviewHeight:[null,r.INT],imagePreviewMinHeight:[44,r.INT],imagePreviewMaxHeight:[256,r.INT],imagePreviewMaxFileSize:[null,r.INT],imagePreviewZoomFactor:[2,r.INT],imagePreviewUpscale:[!1,r.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,r.INT],imagePreviewTransparencyIndicator:[null,r.STRING],imagePreviewCalculateAverageImageColor:[!1,r.BOOLEAN],imagePreviewMarkupShow:[!0,r.BOOLEAN],imagePreviewMarkupFilter:[()=>!0,r.FUNCTION]}}},Mf=typeof window<"u"&&typeof window.document<"u";Mf&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Ks}));/*!
 * FilePondPluginFileValidateType 1.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Zs=({addFilter:t,utils:e})=>{const{Type:i,isString:r,replaceInString:n,guesstimateMimeType:s,getExtensionFromFilename:a,getFilenameFromURL:o}=e,l=(g,f)=>{const m=(/^[^/]+/.exec(g)||[]).pop(),I=f.slice(0,-2);return m===I},d=(g,f)=>g.some(m=>/\*$/.test(m)?l(f,m):m===f),c=g=>{let f="";if(r(g)){const m=o(g),I=a(m);I&&(f=s(I))}else f=g.type;return f},u=(g,f,m)=>{if(f.length===0)return!0;const I=c(g);return m?new Promise((_,p)=>{m(g,I).then(T=>{d(f,T)?_():p()}).catch(p)}):d(f,I)},h=g=>f=>g[f]===null?!1:g[f]||f;return t("SET_ATTRIBUTE_TO_OPTION_MAP",g=>Object.assign(g,{accept:"acceptedFileTypes"})),t("ALLOW_HOPPER_ITEM",(g,{query:f})=>f("GET_ALLOW_FILE_TYPE_VALIDATION")?u(g,f("GET_ACCEPTED_FILE_TYPES")):!0),t("LOAD_FILE",(g,{query:f})=>new Promise((m,I)=>{if(!f("GET_ALLOW_FILE_TYPE_VALIDATION")){m(g);return}const _=f("GET_ACCEPTED_FILE_TYPES"),p=f("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),T=u(g,_,p),y=()=>{const v=_.map(h(f("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(D=>D!==!1),E=v.filter(function(D,R){return v.indexOf(D)===R});I({status:{main:f("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:n(f("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:E.join(", "),allButLastType:E.slice(0,-1).join(", "),lastType:E[v.length-1]})}})};if(typeof T=="boolean")return T?m(g):y();T.then(()=>{m(g)}).catch(y)})),{options:{allowFileTypeValidation:[!0,i.BOOLEAN],acceptedFileTypes:[[],i.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",i.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",i.STRING],fileValidateTypeLabelExpectedTypesMap:[{},i.OBJECT],fileValidateTypeDetectType:[null,i.FUNCTION]}}},Cf=typeof window<"u"&&typeof window.document<"u";Cf&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Zs}));/*!
 * FilePondPluginFileValidateSize 2.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Qs=({addFilter:t,utils:e})=>{const{Type:i,replaceInString:r,toNaturalFileSize:n}=e;return t("ALLOW_HOPPER_ITEM",(s,{query:a})=>{if(!a("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;const o=a("GET_MAX_FILE_SIZE");if(o!==null&&s.size>o)return!1;const l=a("GET_MIN_FILE_SIZE");return!(l!==null&&s.size<l)}),t("LOAD_FILE",(s,{query:a})=>new Promise((o,l)=>{if(!a("GET_ALLOW_FILE_SIZE_VALIDATION"))return o(s);const d=a("GET_FILE_VALIDATE_SIZE_FILTER");if(d&&!d(s))return o(s);const c=a("GET_MAX_FILE_SIZE");if(c!==null&&s.size>c){l({status:{main:a("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:r(a("GET_LABEL_MAX_FILE_SIZE"),{filesize:n(c,".",a("GET_FILE_SIZE_BASE"),a("GET_FILE_SIZE_LABELS",a))})}});return}const u=a("GET_MIN_FILE_SIZE");if(u!==null&&s.size<u){l({status:{main:a("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:r(a("GET_LABEL_MIN_FILE_SIZE"),{filesize:n(u,".",a("GET_FILE_SIZE_BASE"),a("GET_FILE_SIZE_LABELS",a))})}});return}const h=a("GET_MAX_TOTAL_FILE_SIZE");if(h!==null&&a("GET_ACTIVE_ITEMS").reduce((f,m)=>f+m.fileSize,0)>h){l({status:{main:a("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:r(a("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:n(h,".",a("GET_FILE_SIZE_BASE"),a("GET_FILE_SIZE_LABELS",a))})}});return}o(s)})),{options:{allowFileSizeValidation:[!0,i.BOOLEAN],maxFileSize:[null,i.INT],minFileSize:[null,i.INT],maxTotalFileSize:[null,i.INT],fileValidateSizeFilter:[null,i.FUNCTION],labelMinFileSizeExceeded:["File is too small",i.STRING],labelMinFileSize:["Minimum file size is {filesize}",i.STRING],labelMaxFileSizeExceeded:["File is too large",i.STRING],labelMaxFileSize:["Maximum file size is {filesize}",i.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",i.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",i.STRING]}}},Lf=typeof window<"u"&&typeof window.document<"u";Lf&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Qs}));Ui(Ks,Zs,Qs);class ki extends ce{connect(){console.log("pond"),this.createFilePondInstances()}createFilePondInstances(){const e=this.fileTargets,i=this.valueTargets;e.map((r,n)=>{const s=i[n],a=kt(r,{storeAsFile:!0,acceptedFileTypes:["image/*"],maxFileSize:"5MB",maxFiles:1,credits:!1});s.value&&a.setOptions({files:[{source:s.value,options:{type:"local"}}],server:{revert:{url:"revert",headers:{"X-CSRF-TOKEN":"csrf"},onload:function(o){console.log(o)}},load:async(o,l)=>{let c=await(await fetch(o,{cache:"no-store"})).blob();l(c)},remove:(o,l)=>{console.log(o,l)}}}),s.value||a.setOptions({server:{timeout:1e4,process:{url:this.urlValue,method:"POST",headers:{"X-CSRF-TOKEN":this.tokenValue},onerror:(o,l)=>{alert(o.message)},onload:(o,l)=>{alert(o.message)},ondata:(o,l)=>{alert(o.message)}}},onprocessfile:(o,l)=>{o?console.error("Error processing file",o):console.log("File processed successfully")}})})}}$(ki,"targets",["file","value"]),$(ki,"values",{url:String,token:String});class $t extends ce{next({detail:{validation:e}}){return e.passes?this.indexValue++:null}previous(e){e.preventDefault(),this.indexValue--}indexValueChanged(){this.showCurrentSlide()}showCurrentSlide(){this.stepTargets.forEach((e,i)=>{let r=i===this.indexValue;e.hidden=!r,setTimeout(()=>{e.classList.remove(...this.activeClasses,!r)},200)}),setTimeout(()=>{this.stepTargets[this.indexValue].classList.add(...this.activeClasses)},200)}}$($t,"targets",["step"]),$($t,"values",{index:Number}),$($t,"classes",["active"]);function Js(t,e){return Un({state:{...t},get amountToInvest(){return new Intl.NumberFormat("en-US").format(this.amount)},get amountApproximatedProfit(){return new Intl.NumberFormat("en-US").format(Wt.round(this.state.meta_data.interestRate*this.amount,2))},get amountTotalReturn(){return new Intl.NumberFormat("en-US").format(Wt.round(parseFloat((this.state.meta_data.interestRate*this.amount).toString())+parseFloat(this.amount),2))},get amountToDebit(){return new Intl.NumberFormat("en-US").format(this.amount)}},e)}function Kt(t){let e=[Hn(),$n(t.state.meta_data.minimum.majorUnit)];return Number(t.state.meta_data.maximum.majorUnit)&&e.push(Fo(t.state.meta_data.maximum.majorUnit)),{amount:{input:Number(t.amount),rules:e}}}function ea(t,e){const i=e.meta_data.type.charAt(0).toUpperCase()+e.meta_data.type.slice(1);t.state.meta_data.data_type=e.meta_data.type,t.state.meta_data.type=r(e.meta_data.data_type)?i:"",t.state.meta_data.typeStyle=r(e.meta_data.data_type)?"display: block":"display: none",t.state.meta_data.minimum_price=e.meta_data.minimum.withoutSymbol,t.state.meta_data.maximum_price=Number(e.meta_data.maximum.minorUnit)===0?"Unlimited":e.meta_data.maximum.withoutSymbol,t.state.meta_data.percentage_rate=e.meta_data.interestRate+"%",r(e.meta_data.data_type)?(t.amount=e.meta_data.fixedPrice.majorUnit,t.readOnlyAmount=!0,t.state.fixedText="display: block",t.state.notFixedText="display: none"):(t.amount="",t.readOnlyAmount=n=>n.removeAttribute("readonly"),t.state.fixedText="display: none",t.state.notFixedText="display: block");function r(n){return n==="fixed"}return t}class ta extends ce{connect(){const e=this.initialSelectedPlanValue;this.plan=Js(e,this.identifier),this.updateState({selectedPlan:e})}updateState({selectedPlan:e}){ea(this.plan,e)}validateField({target:{value:e}}){this.plan.amount=e,st(Kt(this.plan),["amount"],{"amount.isMin":`:attribute must be at least :min ${this.plan.state.meta_data.minimum.currency}.`})}validateForm(e){e.preventDefault(),this.dispatch("validated",{detail:{validation:st(Kt(this.plan),[],{"amount.isMin":`:attribute must be at least :min ${this.plan.state.meta_data.minimum.currency}.`})}})}}$(ta,"values",{initialSelectedPlan:Object});class Ht extends ce{connect(){this.selectOptionTarget.classList.add(this.selectedClass);const e=this.initialSelectedPlanValue;this.plan=Js(e,this.identifier),this.updateState({selectedPlan:e})}update({currentTarget:e,params:i}){this.selectOptionTargets.forEach(n=>{n.classList.remove(this.selectedClass)}),e.classList.add(this.selectedClass);const r=i.plan;this.plan.state=r,this.updateState({selectedPlan:r})}updateState({selectedPlan:e}){ea(this.plan,e)}validateField({target:{value:e}}){this.plan.amount=e,st(Kt(this.plan),["amount"],{"amount.isMin":`:attribute must be at least :min ${this.plan.state.meta_data.minimum.currency}.`})}validateForm(e){e.preventDefault(),this.dispatch("validated",{detail:{validation:st(Kt(this.plan),[],{"amount.isMin":`:attribute must be at least :min ${this.plan.state.meta_data.minimum.currency}.`})}})}}$(Ht,"targets",["selectOption"]),$(Ht,"values",{initialSelectedPlan:Object}),$(Ht,"classes",["selected"]);Te.register("deposit--create",Ti);Te.register("helpers--clipboard",Vt);Te.register("helpers--countdown-timer",Ii);Te.register("helpers--cropper",as);Te.register("helpers--dropdown",Mi);Te.register("helpers--file-upload",Ci);Te.register("helpers--file-pond",ki);Te.register("helpers--step-form",$t);Te.register("subscription--create",ta);Te.register("subscription--index",Ht);
